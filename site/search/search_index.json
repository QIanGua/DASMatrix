{"config":{"lang":["zh"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"DASMatrix","text":"<p>\u5206\u5e03\u5f0f\u58f0\u5b66\u4f20\u611f\u6570\u636e\u5904\u7406\u4e0e\u5206\u6790\u6846\u67b6</p>"},{"location":"#_1","title":"\u7b80\u4ecb","text":"<p>DASMatrix \u662f\u4e00\u4e2a\u4e13\u4e3a\u5206\u5e03\u5f0f\u58f0\u5b66\u4f20\u611f\uff08DAS\uff09\u6570\u636e\u5904\u7406\u548c\u5206\u6790\u8bbe\u8ba1\u7684\u9ad8\u6027\u80fd Python \u5e93\u3002 \u8be5\u6846\u67b6\u63d0\u4f9b\u4e86\u4e00\u6574\u5957\u5de5\u5177\uff0c\u7528\u4e8e\u8bfb\u53d6\u3001\u5904\u7406\u3001\u5206\u6790\u548c\u53ef\u89c6\u5316 DAS \u6570\u636e\uff0c \u9002\u7528\u4e8e\u5730\u7403\u7269\u7406\u5b66\u3001\u7ed3\u6784\u5065\u5eb7\u76d1\u6d4b\u3001\u5b89\u9632\u76d1\u63a7\u7b49\u9886\u57df\u7684\u7814\u7a76\u548c\u5e94\u7528\u3002</p>"},{"location":"#_2","title":"\u6838\u5fc3\u7279\u6027","text":"<ul> <li>\ud83d\ude80 \u9ad8\u6548\u6570\u636e\u8bfb\u53d6\uff1a\u652f\u6301 DAT\u3001HDF5\u3001SEGY \u7b49\u591a\u79cd\u6570\u636e\u683c\u5f0f</li> <li>\ud83d\udcca \u4e13\u4e1a\u4fe1\u53f7\u5904\u7406\uff1a\u63d0\u4f9b\u6ee4\u6ce2\u3001\u9891\u7387\u5206\u6790\u3001FK \u6ee4\u6ce2\u3001\u81ea\u52a8\u589e\u76ca\u63a7\u5236\u7b49</li> <li>\ud83c\udfa8 \u79d1\u5b66\u7ea7\u53ef\u89c6\u5316\uff1a\u7b26\u5408 Nature/Science \u53d1\u8868\u6807\u51c6\u7684\u6ce2\u5f62\u56fe\u3001\u7011\u5e03\u56fe\u3001FK \u8c31\u56fe</li> <li>\u26a1 \u9ad8\u6027\u80fd\u8bbe\u8ba1\uff1a\u57fa\u4e8e Xarray \u548c Dask \u6784\u5efa\uff0c\u652f\u6301 TB \u7ea7\u8d85\u5927\u6570\u636e\u7684\u5ef6\u8fdf\u8ba1\u7b97</li> <li>\ud83d\udd17 \u94fe\u5f0f API\uff1a\u63d0\u4f9b\u76f4\u89c2\u3001\u6d41\u7545\u7684 API\uff0c\u5927\u5927\u7b80\u5316\u4e86\u5904\u7406\u6d41\u7a0b</li> </ul>"},{"location":"#_3","title":"\u5feb\u901f\u5b89\u88c5","text":"<pre><code># \u514b\u9686\u4ed3\u5e93\ngit clone https://github.com/yourusername/DASMatrix.git\ncd DASMatrix\n\n# \u4f7f\u7528 uv \u5b89\u88c5 (\u63a8\u8350)\nuv sync\n\n# \u6216\u4f7f\u7528 pip\npip install -e .\n</code></pre>"},{"location":"#_4","title":"\u5feb\u901f\u793a\u4f8b","text":"<pre><code>from DASMatrix import df\n\n# \u521b\u5efa DASFrame \u5e76\u94fe\u5f0f\u5904\u7406\nresult = (\n    df(data, fs=1000)\n    .detrend()\n    .bandpass(1, 100)\n    .normalize()\n)\n\n# \u53ef\u89c6\u5316\nresult.plot_heatmap(title=\"Processed DAS Data\")\n</code></pre>"},{"location":"#_5","title":"\u4e0b\u4e00\u6b65","text":"<ul> <li>\u5feb\u901f\u5f00\u59cb - \u8be6\u7ec6\u7684\u5165\u95e8\u6559\u7a0b</li> <li>API \u6587\u6863 - \u5b8c\u6574\u7684 API \u53c2\u8003</li> <li>\u8d21\u732e\u6307\u5357 - \u5982\u4f55\u53c2\u4e0e\u9879\u76ee\u5f00\u53d1</li> </ul>"},{"location":"SUMMARY/","title":"SUMMARY","text":"<ul> <li>\u9996\u9875</li> <li>\u5feb\u901f\u5f00\u59cb</li> <li>\u8d21\u732e\u6307\u5357</li> <li>API \u6587\u6863<ul> <li>\u6982\u8ff0</li> <li>API \u53c2\u8003<ul> <li>DASMatrix<ul> <li>acquisition<ul> <li>das_reader</li> </ul> </li> <li>api<ul> <li>dasframe</li> <li>df</li> </ul> </li> <li>config<ul> <li>sampling_config</li> <li>visualization_config</li> </ul> </li> <li>core<ul> <li>computation_graph</li> </ul> </li> <li>processing<ul> <li>backends<ul> <li>numba_backend</li> <li>polars_backend</li> </ul> </li> <li>das_processor</li> <li>engine</li> <li>kernels<ul> <li>cpu</li> <li>gpu</li> </ul> </li> <li>planner<ul> <li>optimizer</li> </ul> </li> </ul> </li> <li>visualization<ul> <li>das_visualizer</li> <li>styles</li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> </ul>"},{"location":"contributing/","title":"\u8d21\u732e\u6307\u5357","text":"<p>\u6b22\u8fce\u4e3a DASMatrix \u505a\u51fa\u8d21\u732e\uff01\u672c\u6587\u6863\u4ecb\u7ecd\u4ee3\u7801\u89c4\u8303\u548c\u8d21\u732e\u6d41\u7a0b\u3002</p>"},{"location":"contributing/#_2","title":"\u5f00\u53d1\u73af\u5883\u8bbe\u7f6e","text":"<pre><code># \u514b\u9686\u4ed3\u5e93\ngit clone https://github.com/yourusername/DASMatrix.git\ncd DASMatrix\n\n# \u5b89\u88c5\u5f00\u53d1\u4f9d\u8d56\nuv sync\n\n# \u8fd0\u884c\u6d4b\u8bd5\njust test\n\n# \u8fd0\u884c\u7c7b\u578b\u68c0\u67e5\njust typecheck\n\n# \u683c\u5f0f\u5316\u4ee3\u7801\njust format\n</code></pre>"},{"location":"contributing/#docstring","title":"Docstring \u89c4\u8303","text":"<p>DASMatrix \u4f7f\u7528 Google Style docstring\uff0c\u7edf\u4e00\u4f7f\u7528\u4e2d\u6587\u63cf\u8ff0\u3002</p>"},{"location":"contributing/#_3","title":"\u57fa\u672c\u683c\u5f0f","text":"<pre><code>def function_name(arg1: Type1, arg2: Type2 = default) -&gt; ReturnType:\n    \"\"\"\u7b80\u77ed\u7684\u4e00\u884c\u63cf\u8ff0\u3002\n\n    \u53ef\u9009\u7684\u8be6\u7ec6\u63cf\u8ff0\uff0c\u89e3\u91ca\u51fd\u6570\u7684\u5177\u4f53\u884c\u4e3a\u3001\u7b97\u6cd5\u539f\u7406\u6216\u6ce8\u610f\u4e8b\u9879\u3002\n    \u53ef\u4ee5\u662f\u591a\u884c\u3002\n\n    Args:\n        arg1: \u53c2\u65701\u7684\u63cf\u8ff0\n        arg2: \u53c2\u65702\u7684\u63cf\u8ff0\uff0c\u9ed8\u8ba4\u4e3a default\n\n    Returns:\n        \u8fd4\u56de\u503c\u7684\u63cf\u8ff0\n\n    Raises:\n        ValueError: \u4f55\u65f6\u629b\u51fa\u6b64\u5f02\u5e38\n        TypeError: \u4f55\u65f6\u629b\u51fa\u6b64\u5f02\u5e38\n\n    Example:\n        &gt;&gt;&gt; result = function_name(\"test\", 42)\n        &gt;&gt;&gt; print(result)\n        expected_output\n    \"\"\"\n</code></pre>"},{"location":"contributing/#docstring_1","title":"\u7c7b\u7684 Docstring","text":"<pre><code>class ClassName:\n    \"\"\"\u7c7b\u7684\u7b80\u77ed\u63cf\u8ff0\u3002\n\n    \u7c7b\u7684\u8be6\u7ec6\u63cf\u8ff0\uff08\u53ef\u9009\uff09\uff0c\u8bf4\u660e\u7528\u9014\u3001\u8bbe\u8ba1\u7406\u5ff5\u7b49\u3002\n\n    Attributes:\n        attr1: \u5c5e\u60271\u7684\u63cf\u8ff0\n        attr2: \u5c5e\u60272\u7684\u63cf\u8ff0\n\n    Example:\n        &gt;&gt;&gt; obj = ClassName(param1, param2)\n        &gt;&gt;&gt; obj.method()\n    \"\"\"\n\n    def __init__(self, param1: Type1, param2: Type2):\n        \"\"\"\u521d\u59cb\u5316\u7c7b\u5b9e\u4f8b\u3002\n\n        Args:\n            param1: \u53c2\u65701\u7684\u63cf\u8ff0\n            param2: \u53c2\u65702\u7684\u63cf\u8ff0\n        \"\"\"\n</code></pre>"},{"location":"contributing/#_4","title":"\u89c4\u8303\u8981\u70b9","text":"\u9879\u76ee \u8981\u6c42 \u8bed\u8a00 \u7edf\u4e00\u4f7f\u7528\u4e2d\u6587 \u98ce\u683c Google Style \u7c7b\u578b\u6ce8\u89e3 \u5fc5\u987b\u63d0\u4f9b Args \u6240\u6709\u53c2\u6570\u5fc5\u987b\u8bf4\u660e Returns \u5fc5\u987b\u8bf4\u660e\u8fd4\u56de\u503c Raises \u5982\u6709\u5f02\u5e38\uff0c\u5fc5\u987b\u8bf4\u660e Example \u63a8\u8350\u4f46\u975e\u5fc5\u987b"},{"location":"contributing/#_5","title":"\u4ee3\u7801\u89c4\u8303","text":""},{"location":"contributing/#_6","title":"\u683c\u5f0f\u5316","text":"<p>\u4f7f\u7528 <code>ruff</code> \u8fdb\u884c\u4ee3\u7801\u683c\u5f0f\u5316\u548c lint\uff1a</p> <pre><code>just format  # \u683c\u5f0f\u5316\njust lint    # \u68c0\u67e5\u95ee\u9898\n</code></pre>"},{"location":"contributing/#_7","title":"\u7c7b\u578b\u68c0\u67e5","text":"<p>\u4f7f\u7528 <code>mypy</code> \u8fdb\u884c\u7c7b\u578b\u68c0\u67e5\uff1a</p> <pre><code>just typecheck\n</code></pre>"},{"location":"contributing/#_8","title":"\u6d4b\u8bd5","text":"<p>\u4f7f\u7528 <code>pytest</code> \u8fd0\u884c\u6d4b\u8bd5\uff1a</p> <pre><code>just test\n</code></pre>"},{"location":"contributing/#_9","title":"\u63d0\u4ea4\u6d41\u7a0b","text":"<ol> <li>Fork \u4ed3\u5e93</li> <li>\u521b\u5efa\u529f\u80fd\u5206\u652f\uff1a<code>git checkout -b feature/your-feature</code></li> <li>\u7f16\u5199\u4ee3\u7801\u548c\u6d4b\u8bd5</li> <li>\u786e\u4fdd\u6240\u6709\u68c0\u67e5\u901a\u8fc7\uff1a</li> </ol> <pre><code>just lint\njust typecheck\njust test\n</code></pre> <ol> <li>\u63d0\u4ea4 Pull Request</li> </ol>"},{"location":"quickstart/","title":"\u5feb\u901f\u5f00\u59cb","text":"<p>\u672c\u6307\u5357\u5c06\u5e2e\u52a9\u60a8\u5feb\u901f\u4e0a\u624b DASMatrix\u3002</p>"},{"location":"quickstart/#_2","title":"\u5b89\u88c5","text":""},{"location":"quickstart/#_3","title":"\u73af\u5883\u8981\u6c42","text":"<ul> <li>Python 3.9+</li> <li>NumPy 1.20+</li> <li>SciPy 1.10+</li> <li>Matplotlib 3.7+</li> </ul>"},{"location":"quickstart/#uv","title":"\u4f7f\u7528 uv \u5b89\u88c5\uff08\u63a8\u8350\uff09","text":"<pre><code>git clone https://github.com/yourusername/DASMatrix.git\ncd DASMatrix\nuv sync\n</code></pre>"},{"location":"quickstart/#pip","title":"\u4f7f\u7528 pip \u5b89\u88c5","text":"<pre><code>pip install -e .\n</code></pre>"},{"location":"quickstart/#_4","title":"\u57fa\u672c\u4f7f\u7528","text":""},{"location":"quickstart/#1","title":"1. \u6570\u636e\u8bfb\u53d6","text":"<pre><code>from DASMatrix.acquisition import DASReader, DataType\nfrom DASMatrix.config import SamplingConfig\n\n# \u914d\u7f6e\u91c7\u6837\u53c2\u6570\nconfig = SamplingConfig(\n    fs=10000,      # \u91c7\u6837\u9891\u7387 10kHz\n    channels=512,  # 512 \u4e2a\u901a\u9053\n    byte_order=\"big\"\n)\n\n# \u521b\u5efa\u8bfb\u53d6\u5668\u5e76\u8bfb\u53d6\u6570\u636e (\u652f\u6301\u5ef6\u8fdf\u52a0\u8f7d)\n# \u8fd4\u56de dask.array (lazy) \u6216 numpy.ndarray\nreader = DASReader(config, data_type=DataType.DAT)\ndata = reader.ReadRawData(\"path/to/data.dat\")\n\n# \u8bfb\u53d6 SEGY \u6587\u4ef6\nsegy_reader = DASReader(config, data_type=DataType.SEGY)\nsegy_data = segy_reader.ReadRawData(\"path/to/data.sgy\")\n</code></pre>"},{"location":"quickstart/#2-dasframe","title":"2. \u4f7f\u7528 DASFrame \u8fdb\u884c\u94fe\u5f0f\u5904\u7406","text":"<pre><code>from DASMatrix import df\n\n# \u521b\u5efa DASFrame\nframe = df(data, fs=10000)\n\n# \u94fe\u5f0f\u4fe1\u53f7\u5904\u7406\nprocessed = (\n    frame\n    .detrend()              # \u53bb\u8d8b\u52bf\n    .demean()               # \u53bb\u5747\u503c\n    .bandpass(1, 500)       # 1-500Hz \u5e26\u901a\u6ee4\u6ce2\n    .fk_filter(v_min=1500)  # FK \u901f\u5ea6\u6ee4\u6ce2 (&gt;1500m/s)\n    .normalize()            # \u5f52\u4e00\u5316\n)\n\n# \u83b7\u53d6\u5904\u7406\u7ed3\u679c\nresult = processed.collect()\n</code></pre>"},{"location":"quickstart/#3","title":"3. \u53ef\u89c6\u5316","text":"<pre><code># \u65f6\u95f4\u5e8f\u5217\u56fe\nprocessed.plot_ts(ch=0, title=\"Channel 0\")\n\n# \u70ed\u56fe/\u7011\u5e03\u56fe\nprocessed.plot_heatmap(title=\"DAS Waterfall\")\n\n# \u9891\u8c31\u56fe\nprocessed.plot_spec(ch=0, title=\"Spectrogram\")\n\n# FK \u8c31\u56fe\nprocessed.plot_fk(dx=1.0, v_lines=[1500, 3000], title=\"FK Spectrum\")\n</code></pre>"},{"location":"quickstart/#_5","title":"\u5e38\u7528\u64cd\u4f5c","text":""},{"location":"quickstart/#_6","title":"\u6ee4\u6ce2\u5668","text":"\u65b9\u6cd5 \u8bf4\u660e <code>bandpass(low, high)</code> \u5e26\u901a\u6ee4\u6ce2 <code>lowpass(cutoff)</code> \u4f4e\u901a\u6ee4\u6ce2 <code>highpass(cutoff)</code> \u9ad8\u901a\u6ee4\u6ce2 <code>notch(freq)</code> \u9677\u6ce2\u6ee4\u6ce2 <code>median_filter(k)</code> \u4e2d\u503c\u6ee4\u6ce2"},{"location":"quickstart/#_7","title":"\u53d8\u6362","text":"\u65b9\u6cd5 \u8bf4\u660e <code>fft()</code> \u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362 <code>stft()</code> \u77ed\u65f6\u5085\u91cc\u53f6\u53d8\u6362 <code>hilbert()</code> \u5e0c\u5c14\u4f2f\u7279\u53d8\u6362 <code>envelope()</code> \u5305\u7edc\u63d0\u53d6"},{"location":"quickstart/#_8","title":"\u7edf\u8ba1","text":"\u65b9\u6cd5 \u8bf4\u660e <code>mean(axis)</code> \u5747\u503c <code>std(axis)</code> \u6807\u51c6\u5dee <code>max(axis)</code> \u6700\u5927\u503c <code>min(axis)</code> \u6700\u5c0f\u503c <code>rms()</code> \u5747\u65b9\u6839"},{"location":"quickstart/#_9","title":"\u4e0b\u4e00\u6b65","text":"<ul> <li>\u67e5\u770b API \u6587\u6863 \u4e86\u89e3\u5b8c\u6574\u529f\u80fd</li> <li>\u9605\u8bfb \u8d21\u732e\u6307\u5357 \u53c2\u4e0e\u9879\u76ee\u5f00\u53d1</li> </ul>"},{"location":"api/","title":"API \u6587\u6863","text":"<p>DASMatrix \u7684 API \u6309\u529f\u80fd\u6a21\u5757\u7ec4\u7ec7\u3002 \u672c\u9875\u9762\u63d0\u4f9b\u4e86\u81ea\u52a8\u751f\u6210\u7684 API \u53c2\u8003\u6587\u6863\uff0c\u59cb\u7ec8\u4e0e\u4ee3\u7801\u4fdd\u6301\u540c\u6b65\u3002</p>"},{"location":"api/#_1","title":"\u6838\u5fc3\u6a21\u5757","text":"<ul> <li>DASFrame - \u6838\u5fc3\u6570\u636e\u5904\u7406\u7c7b\uff0c\u57fa\u4e8e Xarray/Dask</li> <li>\u6570\u636e\u8bfb\u53d6 - \u652f\u6301\u591a\u79cd\u683c\u5f0f\u7684\u6570\u636e\u8bfb\u53d6</li> <li>\u4fe1\u53f7\u5904\u7406 - \u4e30\u5bcc\u7684\u4fe1\u53f7\u5904\u7406\u7b97\u6cd5\u5e93</li> <li>\u53ef\u89c6\u5316 - \u79d1\u5b66\u7ea7\u6570\u636e\u53ef\u89c6\u5316\u5de5\u5177</li> </ul>"},{"location":"api/#api_1","title":"\u6d4f\u89c8\u5b8c\u6574 API","text":"<p>\u60a8\u53ef\u4ee5\u4ece\u5de6\u4fa7\u5bfc\u822a\u680f\u6216\u4ee5\u4e0b\u94fe\u63a5\u6d4f\u89c8\u5b8c\u6574\u7684\u6a21\u5757\u53c2\u8003\uff1a</p> <ul> <li>DASMatrix \u6838\u5fc3</li> <li>API \u63a5\u53e3</li> <li>\u914d\u7f6e\u7ba1\u7406</li> </ul>"},{"location":"api/#_2","title":"\u5feb\u901f\u5bfc\u5165","text":"<pre><code># \u63a8\u8350\u65b9\u5f0f\uff1a\u4f7f\u7528\u4fbf\u6377\u51fd\u6570\nfrom DASMatrix import df\n\n# \u5b8c\u6574\u5bfc\u5165\nfrom DASMatrix.api import DASFrame\nfrom DASMatrix.acquisition import DASReader, DataType\nfrom DASMatrix.config import SamplingConfig, VisualizationConfig\nfrom DASMatrix.visualization import DASVisualizer\n</code></pre>"},{"location":"reference/DASMatrix/","title":"DASMatrix","text":""},{"location":"reference/DASMatrix/#DASMatrix","title":"DASMatrix","text":""},{"location":"reference/DASMatrix/#DASMatrix.DASReader","title":"DASReader","text":"<pre><code>DASReader(\n    sampling_config: SamplingConfig,\n    data_type: DataType = DataType.DAT,\n)\n</code></pre> <p>\u6570\u636e\u8bfb\u53d6\u5668\u7c7b, \u7528\u4e8e\u8bfb\u53d6\u4e0d\u540c\u683c\u5f0f\u7684\u6570\u636e\u6587\u4ef6</p> <p>\u521d\u59cb\u5316\u6570\u636e\u8bfb\u53d6\u5668</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>sampling_config</code> <code>SamplingConfig</code> <p>\u91c7\u6837\u914d\u7f6e\u5bf9\u8c61</p> \u5fc5\u9700 <code>data_type</code> <code>DataType</code> <p>\u6570\u636e\u7c7b\u578b\uff0c\u9ed8\u8ba4\u4e3aDAT\u683c\u5f0f</p> <code>DAT</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/acquisition/das_reader.py</code> <pre><code>def __init__(\n    self, sampling_config: SamplingConfig, data_type: DataType = DataType.DAT\n):\n    \"\"\"\u521d\u59cb\u5316\u6570\u636e\u8bfb\u53d6\u5668\n\n    Args:\n        sampling_config: \u91c7\u6837\u914d\u7f6e\u5bf9\u8c61\n        data_type: \u6570\u636e\u7c7b\u578b\uff0c\u9ed8\u8ba4\u4e3aDAT\u683c\u5f0f\n    \"\"\"\n    self.sampling_config = sampling_config\n    self.reader: DataReader\n    self.data_type = data_type\n    self.logger = logging.getLogger(__name__)\n\n    # \u6839\u636e\u6570\u636e\u7c7b\u578b\u9009\u62e9\u5408\u9002\u7684\u8bfb\u53d6\u5668\n    if data_type == DataType.DAT:\n        self.reader = DATReader(sampling_config)\n    elif data_type == DataType.H5:\n        self.reader = H5Reader(sampling_config)\n    elif data_type == DataType.SEGY:\n        self.reader = SEGYReader(sampling_config)\n    elif data_type == DataType.MINISEED:\n        self.reader = MiniSEEDReader(sampling_config)\n    else:\n        raise ValueError(f\"\u4e0d\u652f\u6301\u7684\u6570\u636e\u7c7b\u578b: {data_type}\")\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASReader.ReadRawData","title":"ReadRawData","text":"<pre><code>ReadRawData(\n    file_path: Path, target_col: Optional[List[int]] = None\n) -&gt; Union[np.ndarray, da.Array]\n</code></pre> <p>\u8bfb\u53d6\u6307\u5b9a\u8def\u5f84\u7684\u6570\u636e\u6587\u4ef6</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>file_path</code> <code>Path</code> <p>\u6570\u636e\u6587\u4ef6\u8def\u5f84</p> \u5fc5\u9700 <code>target_col</code> <code>Optional[List[int]]</code> <p>\u76ee\u6807\u5217\u7d22\u5f15\u5217\u8868</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Union[ndarray, Array]</code> <p>np.ndarray: \u5305\u542b\u539f\u59cb\u6570\u636e\u7684 NumPy \u6570\u7ec4</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/acquisition/das_reader.py</code> <pre><code>def ReadRawData(\n    self, file_path: Path, target_col: Optional[List[int]] = None\n) -&gt; Union[np.ndarray, \"da.Array\"]:\n    \"\"\"\u8bfb\u53d6\u6307\u5b9a\u8def\u5f84\u7684\u6570\u636e\u6587\u4ef6\n\n    Args:\n        file_path: \u6570\u636e\u6587\u4ef6\u8def\u5f84\n        target_col: \u76ee\u6807\u5217\u7d22\u5f15\u5217\u8868\n\n    Returns:\n        np.ndarray: \u5305\u542b\u539f\u59cb\u6570\u636e\u7684 NumPy \u6570\u7ec4\n    \"\"\"\n    try:\n        # \u8bfb\u53d6\u539f\u59cb\u6570\u636e\n        raw_data = self.reader.ReadRawData(file_path, target_col)\n        return raw_data\n    except Exception as e:\n        self.logger.error(f\"\u8bfb\u53d6\u6570\u636e\u65f6\u53d1\u751f\u9519\u8bef: {e}\uff0c\u6587\u4ef6\u8def\u5f84: {file_path}\")\n        raise\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame","title":"DASFrame","text":"<pre><code>DASFrame(\n    data: Union[DataArray, ndarray, Array, DASFrame],\n    fs: float,\n    dx: float = 1.0,\n    **metadata: Any,\n)\n</code></pre> <p>DAS \u6570\u636e\u5904\u7406\u6838\u5fc3\u7c7b (Xarray/Dask Backend)\u3002</p> <p>\u6240\u6709\u4fe1\u53f7\u5904\u7406\u64cd\u4f5c\u57fa\u4e8e xarray \u548c dask \u8fdb\u884c\u5ef6\u8fdf\u8ba1\u7b97\u3002</p> <p>Initialize DASFrame.</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>Union[DataArray, ndarray, Array, DASFrame]</code> <p>Input data.</p> \u5fc5\u9700 <code>fs</code> <code>float</code> <p>Sampling frequency (Hz).</p> \u5fc5\u9700 <code>dx</code> <code>float</code> <p>Channel spacing (m).</p> <code>1.0</code> <code>**metadata</code> <code>Any</code> <p>Additional metadata.</p> <code>{}</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def __init__(\n    self,\n    data: Union[xr.DataArray, np.ndarray, da.Array, \"DASFrame\"],\n    fs: float,\n    dx: float = 1.0,\n    **metadata: Any,\n) -&gt; None:\n    \"\"\"Initialize DASFrame.\n\n    Args:\n        data: Input data.\n        fs: Sampling frequency (Hz).\n        dx: Channel spacing (m).\n        **metadata: Additional metadata.\n    \"\"\"\n    if isinstance(data, DASFrame):\n        # Copy constructor roughly\n        self._data = data._data\n        self._fs = data.fs\n        self._dx = getattr(data, \"_dx\", dx)\n        self._metadata = {**data._metadata, **metadata}\n        return\n\n    self._fs = fs\n    self._dx = dx\n    self._metadata = metadata\n\n    if isinstance(data, xr.DataArray):\n        # Ensure order is (time, distance)\n        if \"time\" in data.dims and data.dims[0] != \"time\":\n            data = data.transpose(\"time\", ...)\n        self._data = data\n    else:\n        # Wrap numpy/dask array into xarray\n        # Assume dims are (time, channel)\n        if not isinstance(data, (np.ndarray, da.Array)):\n            data = np.asarray(data)\n\n        # Create coordinates\n        nt, nx = data.shape\n        coords = {\n            \"time\": np.arange(nt) / fs,\n            \"distance\": np.arange(nx) * dx,\n        }\n\n        self._data = xr.DataArray(\n            data,\n            dims=(\"time\", \"distance\"),\n            coords=coords,\n            name=\"das_strain\",\n            attrs={\"fs\": fs, \"dx\": dx, **metadata},\n        )\n\n        # Ensure it is chunked (dask backed) if it isn't already\n        if not self._data.chunks:\n            self._data = self._data.chunk({\"time\": \"auto\", \"distance\": -1})\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.data","title":"data  <code>property</code>","text":"<pre><code>data: DataArray\n</code></pre> <p>Access underlying xarray DataArray.</p>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.shape","title":"shape  <code>property</code>","text":"<pre><code>shape: Tuple[int, ...]\n</code></pre> <p>Get shape of data.</p>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.collect","title":"collect","text":"<pre><code>collect() -&gt; np.ndarray\n</code></pre> <p>Compute and return numpy array.</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def collect(self) -&gt; np.ndarray:\n    \"\"\"Compute and return numpy array.\"\"\"\n    return self._data.compute().values\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.slice","title":"slice","text":"<pre><code>slice(\n    t: slice = slice(None), x: slice = slice(None)\n) -&gt; DASFrame\n</code></pre> <p>Slice data.</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def slice(self, t: slice = slice(None), x: slice = slice(None)) -&gt; \"DASFrame\":\n    \"\"\"Slice data.\"\"\"\n    # xarray is slicing by index here (isel)\n    sliced = self._data.isel(time=t, distance=x)\n    return DASFrame(sliced, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.bandpass","title":"bandpass","text":"<pre><code>bandpass(\n    low: float, high: float, order: int = 4\n) -&gt; DASFrame\n</code></pre> <p>Apply bandpass filter using dask map_overlap or map_blocks.</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def bandpass(self, low: float, high: float, order: int = 4) -&gt; \"DASFrame\":\n    \"\"\"Apply bandpass filter using dask map_overlap or map_blocks.\"\"\"\n\n    def _filter_func(block, fs, low, high, order):\n        nyq = 0.5 * fs\n        sos = signal.butter(\n            order, [low / nyq, high / nyq], btype=\"band\", output=\"sos\"\n        )\n        # Apply along the last axis (core dimension moved to end by apply_ufunc)\n        return signal.sosfiltfilt(sos, block, axis=-1)\n\n    data_contiguous_time = self._data.chunk({\"time\": -1})\n\n    filtered = xr.apply_ufunc(\n        _filter_func,\n        data_contiguous_time,\n        kwargs={\"fs\": self._fs, \"low\": low, \"high\": high, \"order\": order},\n        input_core_dims=[[\"time\"]],\n        output_core_dims=[[\"time\"]],\n        dask=\"parallelized\",\n        output_dtypes=[data_contiguous_time.dtype],\n    )\n\n    return DASFrame(filtered, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.lowpass","title":"lowpass","text":"<pre><code>lowpass(cutoff: float, order: int = 4) -&gt; DASFrame\n</code></pre> <p>Apply lowpass filter.</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def lowpass(self, cutoff: float, order: int = 4) -&gt; \"DASFrame\":\n    \"\"\"Apply lowpass filter.\"\"\"\n\n    def _filter_func(block, fs, cutoff, order):\n        nyq = 0.5 * fs\n        sos = signal.butter(order, cutoff / nyq, btype=\"low\", output=\"sos\")\n        return signal.sosfiltfilt(sos, block, axis=-1)\n\n    data_contiguous_time = self._data.chunk({\"time\": -1})\n    filtered = xr.apply_ufunc(\n        _filter_func,\n        data_contiguous_time,\n        kwargs={\"fs\": self._fs, \"cutoff\": cutoff, \"order\": order},\n        input_core_dims=[[\"time\"]],\n        output_core_dims=[[\"time\"]],\n        dask=\"parallelized\",\n        output_dtypes=[data_contiguous_time.dtype],\n    )\n    return DASFrame(filtered, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.highpass","title":"highpass","text":"<pre><code>highpass(cutoff: float, order: int = 4) -&gt; DASFrame\n</code></pre> <p>\u9ad8\u901a\u6ee4\u6ce2\u5668\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def highpass(self, cutoff: float, order: int = 4) -&gt; \"DASFrame\":\n    \"\"\"\u9ad8\u901a\u6ee4\u6ce2\u5668\u3002\"\"\"\n\n    def _filter_func(block, fs, cutoff, order):\n        nyq = 0.5 * fs\n        sos = signal.butter(order, cutoff / nyq, btype=\"high\", output=\"sos\")\n        return signal.sosfiltfilt(sos, block, axis=-1)\n\n    data_contiguous_time = self._data.chunk({\"time\": -1})\n    filtered = xr.apply_ufunc(\n        _filter_func,\n        data_contiguous_time,\n        kwargs={\"fs\": self._fs, \"cutoff\": cutoff, \"order\": order},\n        input_core_dims=[[\"time\"]],\n        output_core_dims=[[\"time\"]],\n        dask=\"parallelized\",\n        output_dtypes=[data_contiguous_time.dtype],\n    )\n    return DASFrame(filtered, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.notch","title":"notch","text":"<pre><code>notch(freq: float, Q: float = 30) -&gt; DASFrame\n</code></pre> <p>\u9677\u6ce2\u6ee4\u6ce2\u5668\uff0c\u79fb\u9664\u7279\u5b9a\u9891\u7387\u6210\u5206\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def notch(self, freq: float, Q: float = 30) -&gt; \"DASFrame\":\n    \"\"\"\u9677\u6ce2\u6ee4\u6ce2\u5668\uff0c\u79fb\u9664\u7279\u5b9a\u9891\u7387\u6210\u5206\u3002\"\"\"\n\n    def _filter_func(block, fs, freq, Q):\n        b, a = signal.iirnotch(freq, Q, fs)\n        return signal.filtfilt(b, a, block, axis=-1)\n\n    data_contiguous_time = self._data.chunk({\"time\": -1})\n    filtered = xr.apply_ufunc(\n        _filter_func,\n        data_contiguous_time,\n        kwargs={\"fs\": self._fs, \"freq\": freq, \"Q\": Q},\n        input_core_dims=[[\"time\"]],\n        output_core_dims=[[\"time\"]],\n        dask=\"parallelized\",\n        output_dtypes=[data_contiguous_time.dtype],\n    )\n    return DASFrame(filtered, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.detrend","title":"detrend","text":"<pre><code>detrend(axis: str = 'time') -&gt; DASFrame\n</code></pre> <p>Detrend data.</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def detrend(self, axis: str = \"time\") -&gt; \"DASFrame\":\n    \"\"\"Detrend data.\"\"\"\n\n    def _detrend_func(data):\n        return signal.detrend(data, axis=-1)\n\n    if axis == \"time\":\n        data = self._data.chunk({\"time\": -1})\n    else:\n        data = self._data.chunk({\"distance\": -1})\n\n    detrended = xr.apply_ufunc(\n        _detrend_func,\n        data,\n        input_core_dims=[[axis]],\n        output_core_dims=[[axis]],\n        dask=\"parallelized\",\n        output_dtypes=[data.dtype],\n    )\n\n    return DASFrame(detrended, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.demean","title":"demean","text":"<pre><code>demean(axis: str = 'time') -&gt; DASFrame\n</code></pre> <p>Remove mean value along specified axis.</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def demean(self, axis: str = \"time\") -&gt; \"DASFrame\":\n    \"\"\"Remove mean value along specified axis.\"\"\"\n    dim = \"time\" if axis == \"time\" else \"distance\"\n    demeaned = self._data - self._data.mean(dim=dim)\n    return DASFrame(demeaned, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.normalize","title":"normalize","text":"<pre><code>normalize(method: str = 'minmax') -&gt; DASFrame\n</code></pre> <p>\u5f52\u4e00\u5316\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def normalize(self, method: str = \"minmax\") -&gt; \"DASFrame\":\n    \"\"\"\u5f52\u4e00\u5316\u3002\"\"\"\n    if method == \"zscore\":\n        mean = self._data.mean(dim=\"time\")\n        std = self._data.std(dim=\"time\")\n        std = xr.where(std == 0, 1.0, std)\n        normalized = (self._data - mean) / std\n    else:  # minmax\n        min_val = self._data.min(dim=\"time\")\n        max_val = self._data.max(dim=\"time\")\n        range_val = max_val - min_val\n        range_val = xr.where(range_val == 0, 1.0, range_val)\n        normalized = 2 * (self._data - min_val) / range_val - 1\n\n    return DASFrame(normalized, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.mean","title":"mean","text":"<pre><code>mean(axis: Optional[int] = 0) -&gt; np.ndarray\n</code></pre> <p>\u8ba1\u7b97\u5747\u503c\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>axis</code> <code>Optional[int]</code> <p>\u8ba1\u7b97\u8f74\uff0c0 \u8868\u793a\u6cbf\u65f6\u95f4\u8f74\u8fd4\u56de\u6bcf\u901a\u9053\u7684\u5747\u503c\uff0cNone \u8fd4\u56de\u5168\u5c40\u6807\u91cf</p> <code>0</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def mean(self, axis: Optional[int] = 0) -&gt; np.ndarray:\n    \"\"\"\u8ba1\u7b97\u5747\u503c\u3002\n\n    Args:\n        axis: \u8ba1\u7b97\u8f74\uff0c0 \u8868\u793a\u6cbf\u65f6\u95f4\u8f74\u8fd4\u56de\u6bcf\u901a\u9053\u7684\u5747\u503c\uff0cNone \u8fd4\u56de\u5168\u5c40\u6807\u91cf\n    \"\"\"\n    if axis is None:\n        return self._data.mean().compute().values\n    dim = \"time\" if axis == 0 else \"distance\"\n    return self._data.mean(dim=dim).compute().values\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.std","title":"std","text":"<pre><code>std(axis: Optional[int] = 0) -&gt; np.ndarray\n</code></pre> <p>\u8ba1\u7b97\u6807\u51c6\u5dee\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def std(self, axis: Optional[int] = 0) -&gt; np.ndarray:\n    \"\"\"\u8ba1\u7b97\u6807\u51c6\u5dee\u3002\"\"\"\n    if axis is None:\n        return self._data.std().compute().values\n    dim = \"time\" if axis == 0 else \"distance\"\n    return self._data.std(dim=dim).compute().values\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.max","title":"max","text":"<pre><code>max(axis: Optional[int] = 0) -&gt; np.ndarray\n</code></pre> <p>\u8ba1\u7b97\u6700\u5927\u503c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def max(self, axis: Optional[int] = 0) -&gt; np.ndarray:\n    \"\"\"\u8ba1\u7b97\u6700\u5927\u503c\u3002\"\"\"\n    if axis is None:\n        return self._data.max().compute().values\n    dim = \"time\" if axis == 0 else \"distance\"\n    return self._data.max(dim=dim).compute().values\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.min","title":"min","text":"<pre><code>min(axis: Optional[int] = 0) -&gt; np.ndarray\n</code></pre> <p>\u8ba1\u7b97\u6700\u5c0f\u503c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def min(self, axis: Optional[int] = 0) -&gt; np.ndarray:\n    \"\"\"\u8ba1\u7b97\u6700\u5c0f\u503c\u3002\"\"\"\n    if axis is None:\n        return self._data.min().compute().values\n    dim = \"time\" if axis == 0 else \"distance\"\n    return self._data.min(dim=dim).compute().values\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.rms","title":"rms","text":"<pre><code>rms(window: Optional[int] = None) -&gt; np.ndarray\n</code></pre> <p>\u8ba1\u7b97 RMS\uff08\u5747\u65b9\u6839\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def rms(self, window: Optional[int] = None) -&gt; np.ndarray:\n    \"\"\"\u8ba1\u7b97 RMS\uff08\u5747\u65b9\u6839\uff09\u3002\"\"\"\n    data_sq = self._data**2\n    if window is None:\n        return np.sqrt(data_sq.mean(dim=\"time\").compute().values)\n    else:\n        # \u6ed1\u52a8 RMS\uff0c\u4f7f\u7528 xarray \u6eda\u52a8\u7a97\u53e3\n        rolling_mean = data_sq.rolling(time=window, center=True).mean()\n        return np.sqrt(rolling_mean.compute().values)\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.fft","title":"fft","text":"<pre><code>fft() -&gt; DASFrame\n</code></pre> <p>\u5feb\u901f\u5085\u7acb\u53f6\u53d8\u6362\uff0c\u8ba1\u7b97\u9891\u8c31\u5e45\u5ea6\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def fft(self) -&gt; \"DASFrame\":\n    \"\"\"\u5feb\u901f\u5085\u7acb\u53f6\u53d8\u6362\uff0c\u8ba1\u7b97\u9891\u8c31\u5e45\u5ea6\u3002\"\"\"\n\n    def _fft_func(data):\n        return np.abs(np.fft.fft(data, axis=-1))\n\n    data = self._data.chunk({\"time\": -1})\n    n_samples = data.sizes[\"time\"]\n    freqs = np.fft.fftfreq(n_samples, 1 / self._fs)\n\n    spectrum = xr.apply_ufunc(\n        _fft_func,\n        data,\n        input_core_dims=[[\"time\"]],\n        output_core_dims=[[\"frequency\"]],\n        dask=\"parallelized\",\n        output_dtypes=[float],\n        dask_gufunc_kwargs={\"output_sizes\": {\"frequency\": n_samples}},\n    )\n\n    spectrum = spectrum.assign_coords(frequency=freqs)\n    # \u6ce8\u610f\uff1aFFT \u53d8\u6362\u540e\uff0c'time' \u8f74\u53d8\u6210\u4e86 'frequency' \u8f74\uff0cfs \u542b\u4e49\u4e5f\u53d8\u5316\u4e86\n    # \u8fd9\u91cc\u4e3a\u4e86\u94fe\u5f0f\u8c03\u7528\u8fd4\u56de DASFrame\uff0c\u4f46\u5176\u5185\u90e8\u7ed3\u6784\u5df2\u7ecf\u53d1\u751f\u4e86\u53d8\u5316\uff08domain \u4f4d\u79fb\uff09\n    return DASFrame(spectrum, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.hilbert","title":"hilbert","text":"<pre><code>hilbert() -&gt; DASFrame\n</code></pre> <p>\u5e0c\u5c14\u4f2f\u7279\u53d8\u6362\uff0c\u8fd4\u56de\u89e3\u6790\u4fe1\u53f7\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def hilbert(self) -&gt; \"DASFrame\":\n    \"\"\"\u5e0c\u5c14\u4f2f\u7279\u53d8\u6362\uff0c\u8fd4\u56de\u89e3\u6790\u4fe1\u53f7\u3002\"\"\"\n\n    def _hilbert_func(data):\n        return signal.hilbert(data, axis=-1)\n\n    data = self._data.chunk({\"time\": -1})\n    analytical = xr.apply_ufunc(\n        _hilbert_func,\n        data,\n        input_core_dims=[[\"time\"]],\n        output_core_dims=[[\"time\"]],\n        dask=\"parallelized\",\n        output_dtypes=[complex],\n    )\n    return DASFrame(analytical, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.envelope","title":"envelope","text":"<pre><code>envelope() -&gt; DASFrame\n</code></pre> <p>\u63d0\u53d6\u4fe1\u53f7\u5305\u7edc\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def envelope(self) -&gt; \"DASFrame\":\n    \"\"\"\u63d0\u53d6\u4fe1\u53f7\u5305\u7edc\u3002\"\"\"\n    analytical = self.hilbert()\n    return analytical.abs()\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.scale","title":"scale","text":"<pre><code>scale(factor: float = 1.0) -&gt; DASFrame\n</code></pre> <p>Scale amplitude.</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def scale(self, factor: float = 1.0) -&gt; \"DASFrame\":\n    \"\"\"Scale amplitude.\"\"\"\n    scaled = self._data * factor\n    return DASFrame(scaled, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.abs","title":"abs","text":"<pre><code>abs() -&gt; DASFrame\n</code></pre> <p>Absolute value.</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def abs(self) -&gt; \"DASFrame\":\n    \"\"\"Absolute value.\"\"\"\n    return DASFrame(np.abs(self._data), self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.stft","title":"stft","text":"<pre><code>stft(\n    nperseg: int = 256, noverlap: Optional[int] = None\n) -&gt; DASFrame\n</code></pre> <p>\u77ed\u65f6\u5085\u7acb\u53f6\u53d8\u6362\uff0c\u8fdb\u884c\u65f6\u9891\u5206\u6790\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def stft(self, nperseg: int = 256, noverlap: Optional[int] = None) -&gt; \"DASFrame\":\n    \"\"\"\u77ed\u65f6\u5085\u7acb\u53f6\u53d8\u6362\uff0c\u8fdb\u884c\u65f6\u9891\u5206\u6790\u3002\"\"\"\n    if noverlap is None:\n        noverlap = nperseg // 2\n\n    data = self.collect()\n    # signal.stft for 2D data with axis=0:\n    # returns f, t, Zxx where Zxx shape is (freq, distance, time)\n    f, t, Zxx = signal.stft(\n        data, fs=self._fs, nperseg=nperseg, noverlap=noverlap, axis=0\n    )\n\n    # \u5c06 Zxx \u4ece (freq, distance, time) \u8f6c\u6362\u4e3a (freq, time, distance)\n    Zxx_abs = np.abs(Zxx).transpose(0, 2, 1)\n\n    # \u5c06\u7ed3\u679c\u5305\u88c5\u56de xr.DataArray\n    stft_data = xr.DataArray(\n        Zxx_abs,\n        dims=(\"frequency\", \"time\", \"distance\"),\n        coords={\n            \"frequency\": f,\n            \"time\": t,\n            \"distance\": self._data.distance,\n        },\n        name=\"stft\",\n        attrs=self._data.attrs,\n    )\n    return DASFrame(stft_data, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.fk_filter","title":"fk_filter","text":"<pre><code>fk_filter(\n    v_min: Optional[float] = None,\n    v_max: Optional[float] = None,\n    dx: float = 1.0,\n) -&gt; DASFrame\n</code></pre> <p>F-K \u6ee4\u6ce2 (\u901f\u5ea6\u6ee4\u6ce2)\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def fk_filter(\n    self,\n    v_min: Optional[float] = None,\n    v_max: Optional[float] = None,\n    dx: float = 1.0,\n) -&gt; \"DASFrame\":\n    \"\"\"F-K \u6ee4\u6ce2 (\u901f\u5ea6\u6ee4\u6ce2)\u3002\"\"\"\n    data = self.collect()\n    from ..config.sampling_config import SamplingConfig\n    from ..processing.das_processor import DASProcessor\n\n    config = SamplingConfig(fs=self._fs, channels=data.shape[1])\n    processor = DASProcessor(config)\n    filtered = processor.FKFilter(data, v_min=v_min, v_max=v_max, dx=dx)\n    return DASFrame(filtered, self._fs, dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.threshold_detect","title":"threshold_detect","text":"<pre><code>threshold_detect(\n    threshold: Optional[float] = None, sigma: float = 3.0\n) -&gt; np.ndarray\n</code></pre> <p>\u9608\u503c\u68c0\u6d4b\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def threshold_detect(\n    self, threshold: Optional[float] = None, sigma: float = 3.0\n) -&gt; np.ndarray:\n    \"\"\"\u9608\u503c\u68c0\u6d4b\u3002\"\"\"\n    data = self.collect()\n    if threshold is None:\n        threshold = np.mean(data) + sigma * np.std(data)\n    return np.abs(data) &gt; threshold\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.plot_ts","title":"plot_ts","text":"<pre><code>plot_ts(\n    ch: Optional[int] = None,\n    title: str = \"Time Series\",\n    ax: Optional[Axes] = None,\n    **kwargs,\n) -&gt; plt.Figure\n</code></pre> <p>\u7ed8\u5236\u65f6\u95f4\u5e8f\u5217\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def plot_ts(\n    self,\n    ch: Optional[int] = None,\n    title: str = \"Time Series\",\n    ax: Optional[plt.Axes] = None,\n    **kwargs,\n) -&gt; plt.Figure:\n    \"\"\"\u7ed8\u5236\u65f6\u95f4\u5e8f\u5217\u3002\"\"\"\n    data = self.collect()\n\n    if ax is None:\n        fig, ax = plt.subplots(figsize=(10, 4))\n    else:\n        if ax.figure is None:\n            raise ValueError(\"Provided ax must belong to a figure\")\n        fig = cast(plt.Figure, ax.figure)\n\n    t = np.arange(data.shape[0]) / self._fs\n    if ch is None:\n        ax.plot(t, data[:, : min(5, data.shape[1])], alpha=0.7)\n    else:\n        ax.plot(t, data[:, ch])\n\n    ax.set_xlabel(\"Time (s)\")\n    ax.set_ylabel(\"Amplitude\")\n    ax.set_title(title)\n    ax.grid(True, alpha=0.3)\n    return fig\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.plot_spectrum","title":"plot_spectrum","text":"<pre><code>plot_spectrum(\n    ch: int = 0,\n    title: str = \"Spectrum\",\n    ax: Optional[Axes] = None,\n    **kwargs: Any,\n) -&gt; plt.Figure\n</code></pre> <p>\u7ed8\u5236\u9891\u8c31\u56fe (FFT)\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def plot_spectrum(\n    self,\n    ch: int = 0,\n    title: str = \"Spectrum\",\n    ax: Optional[plt.Axes] = None,\n    **kwargs: Any,\n) -&gt; plt.Figure:\n    \"\"\"\u7ed8\u5236\u9891\u8c31\u56fe (FFT)\u3002\"\"\"\n    data = self.collect()\n    ch_data = data[:, ch]\n\n    from ..visualization.das_visualizer import SpectrumPlot\n\n    plotter = SpectrumPlot()\n    # \u8ba1\u7b97\u9891\u8c31 (Welch \u65b9\u6cd5)\n    from scipy import signal\n\n    n = len(ch_data)\n    nperseg = min(2048, n // 4)\n    freqs, psd = signal.welch(\n        ch_data, fs=self._fs, nperseg=nperseg, scaling=\"spectrum\"\n    )\n    mags = np.sqrt(psd)\n\n    fig = plotter.plot(freqs, mags, title=title, ax=ax, **kwargs)\n    return fig\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.plot_spectrogram","title":"plot_spectrogram","text":"<pre><code>plot_spectrogram(\n    ch: int = 0,\n    title: str = \"Spectrogram\",\n    window_size: int = 1024,\n    overlap: float = 0.75,\n    ax: Optional[Axes] = None,\n    **kwargs: Any,\n) -&gt; plt.Figure\n</code></pre> <p>\u7ed8\u5236\u65f6\u9891\u56fe (STFT)\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def plot_spectrogram(\n    self,\n    ch: int = 0,\n    title: str = \"Spectrogram\",\n    window_size: int = 1024,\n    overlap: float = 0.75,\n    ax: Optional[plt.Axes] = None,\n    **kwargs: Any,\n) -&gt; plt.Figure:\n    \"\"\"\u7ed8\u5236\u65f6\u9891\u56fe (STFT)\u3002\"\"\"\n    data = self.collect()\n    ch_data = data[:, ch]\n\n    from ..visualization.das_visualizer import SpectrogramPlot\n\n    plotter = SpectrogramPlot()\n    fig = plotter.plot(\n        ch_data,\n        self._fs,\n        window_size=window_size,\n        overlap=overlap,\n        title=title,\n        ax=ax,\n        **kwargs,\n    )\n    return fig\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASFrame.plot_heatmap","title":"plot_heatmap","text":"<pre><code>plot_heatmap(\n    channels: Optional[slice] = None,\n    t_range: Optional[slice] = None,\n    title: str = \"DAS Waterfall\",\n    cmap: str = \"RdBu_r\",\n    ax: Optional[Axes] = None,\n    **kwargs: Any,\n) -&gt; plt.Figure\n</code></pre> <p>\u7ed8\u5236\u70ed\u56fe\uff08\u7011\u5e03\u56fe\uff09\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>channels</code> <code>Optional[slice]</code> <p>\u901a\u9053\u5207\u7247\uff0c\u4f8b\u5982 slice(10, 60, 5)\u3002</p> <code>None</code> <code>t_range</code> <code>Optional[slice]</code> <p>\u65f6\u95f4\u6837\u672c\u5207\u7247\uff08\u4ee5\u6837\u672c\u4e3a\u5355\u4f4d\uff09\uff0c\u4f8b\u5982 slice(0, 1000)\u3002</p> <code>None</code> <code>title</code> <code>str</code> <p>\u56fe\u6807\u9898\u3002</p> <code>'DAS Waterfall'</code> <code>cmap</code> <code>str</code> <p>\u989c\u8272\u6620\u5c04\u3002</p> <code>'RdBu_r'</code> <code>ax</code> <code>Optional[Axes]</code> <p>\u53ef\u9009\u7684 matplotlib Axes \u5bf9\u8c61\u3002</p> <code>None</code> <code>**kwargs</code> <code>Any</code> <p>\u4f20\u9012\u7ed9 imshow \u7684\u989d\u5916\u53c2\u6570\u3002</p> <code>{}</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Figure</code> <p>matplotlib Figure \u5bf9\u8c61\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def plot_heatmap(\n    self,\n    channels: Optional[builtins.slice] = None,\n    t_range: Optional[builtins.slice] = None,\n    title: str = \"DAS Waterfall\",\n    cmap: str = \"RdBu_r\",\n    ax: Optional[plt.Axes] = None,\n    **kwargs: Any,\n) -&gt; plt.Figure:\n    \"\"\"\u7ed8\u5236\u70ed\u56fe\uff08\u7011\u5e03\u56fe\uff09\u3002\n\n    Args:\n        channels: \u901a\u9053\u5207\u7247\uff0c\u4f8b\u5982 slice(10, 60, 5)\u3002\n        t_range: \u65f6\u95f4\u6837\u672c\u5207\u7247\uff08\u4ee5\u6837\u672c\u4e3a\u5355\u4f4d\uff09\uff0c\u4f8b\u5982 slice(0, 1000)\u3002\n        title: \u56fe\u6807\u9898\u3002\n        cmap: \u989c\u8272\u6620\u5c04\u3002\n        ax: \u53ef\u9009\u7684 matplotlib Axes \u5bf9\u8c61\u3002\n        **kwargs: \u4f20\u9012\u7ed9 imshow \u7684\u989d\u5916\u53c2\u6570\u3002\n\n    Returns:\n        matplotlib Figure \u5bf9\u8c61\u3002\n    \"\"\"\n    data = self.collect()\n\n    # \u5e94\u7528\u65f6\u95f4\u5207\u7247\n    if t_range is not None:\n        data = data[t_range, :]\n        t_start = (t_range.start or 0) / self._fs\n    else:\n        t_start = 0.0\n\n    # \u5e94\u7528\u901a\u9053\u5207\u7247\n    if channels is not None:\n        data = data[:, channels]\n        ch_start = channels.start or 0\n    else:\n        ch_start = 0\n\n    if ax is None:\n        fig, ax = plt.subplots(figsize=(10, 6))\n    else:\n        if ax.figure is None:\n            raise ValueError(\"Provided ax must belong to a figure\")\n        fig = cast(plt.Figure, ax.figure)\n\n    extent = (\n        ch_start,\n        ch_start + float(data.shape[1]),\n        t_start + float(data.shape[0] / self._fs),\n        t_start,\n    )\n    vmax = np.percentile(np.abs(data), 98)\n    im = ax.imshow(\n        data,\n        aspect=\"auto\",\n        cmap=cmap,\n        extent=extent,\n        vmin=-vmax,\n        vmax=vmax,\n        **kwargs,\n    )\n\n    ax.set_xlabel(\"Channel\")\n    ax.set_ylabel(\"Time (s)\")\n    ax.set_title(title)\n    if ax is not None:\n        plt.colorbar(im, ax=ax, label=\"Amplitude\")\n    return fig\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.SamplingConfig","title":"SamplingConfig  <code>dataclass</code>","text":"<pre><code>SamplingConfig(\n    fs: float = 30000.0,\n    channels: int = 100,\n    byte_order: str = \"little\",\n    wn: float = 1.0,\n)\n</code></pre> <p>\u91c7\u6837\u914d\u7f6e</p>"},{"location":"reference/DASMatrix/#DASMatrix.DASProcessor","title":"DASProcessor","text":"<pre><code>DASProcessor(sampling_config: SamplingConfig)\n</code></pre> <p>DAS\u6570\u636e\u5904\u7406\u5668\uff0c\u7528\u4e8e\u5904\u7406\u548c\u5206\u6790DAS\u6570\u636e</p> <p>\u521d\u59cb\u5316DAS\u6570\u636e\u5904\u7406\u5668</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>sampling_config</code> <code>SamplingConfig</code> <p>\u91c7\u6837\u914d\u7f6e\u5bf9\u8c61\uff0c\u5305\u542b\u91c7\u6837\u9891\u7387\u7b49\u4fe1\u606f</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/das_processor.py</code> <pre><code>def __init__(self, sampling_config: SamplingConfig):\n    \"\"\"\u521d\u59cb\u5316DAS\u6570\u636e\u5904\u7406\u5668\n\n    Args:\n        sampling_config: \u91c7\u6837\u914d\u7f6e\u5bf9\u8c61\uff0c\u5305\u542b\u91c7\u6837\u9891\u7387\u7b49\u4fe1\u606f\n    \"\"\"\n    self.sampling_config = sampling_config\n    self.fs = sampling_config.fs\n    self.logger = logging.getLogger(__name__)\n\n    # \u9884\u8ba1\u7b97\u9ad8\u901a\u6ee4\u6ce2\u5668\u7cfb\u6570\n    self.sos_highpass = self._create_filter(\n        cutoff=self.sampling_config.wn, btype=\"high\"\n    )\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASProcessor.ApplyFilter","title":"ApplyFilter","text":"<pre><code>ApplyFilter(data: ndarray, sos: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u5e94\u7528\u6ee4\u6ce2\u5668 (\u96f6\u76f8\u4f4d)</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u8f93\u5165\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)</p> \u5fc5\u9700 <code>sos</code> <code>ndarray</code> <p>\u6ee4\u6ce2\u5668\u7cfb\u6570 (SOS format)</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u6ee4\u6ce2\u540e\u7684\u6570\u636e</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/das_processor.py</code> <pre><code>def ApplyFilter(self, data: np.ndarray, sos: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u5e94\u7528\u6ee4\u6ce2\u5668 (\u96f6\u76f8\u4f4d)\n\n    Args:\n        data: \u8f93\u5165\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)\n        sos: \u6ee4\u6ce2\u5668\u7cfb\u6570 (SOS format)\n\n    Returns:\n        np.ndarray: \u6ee4\u6ce2\u540e\u7684\u6570\u636e\n    \"\"\"\n    # \u786e\u4fdd\u6570\u636e\u662f\u6d6e\u70b9\u6570\u7c7b\u578b\u4ee5\u83b7\u5f97\u6700\u4f73\u7cbe\u5ea6\n    if not np.issubdtype(data.dtype, np.floating):\n        data = data.astype(np.float64)\n    filtered_data = signal.sosfiltfilt(sos, data, axis=0)\n    return filtered_data\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASProcessor.NormalizeDC","title":"NormalizeDC","text":"<pre><code>NormalizeDC(data: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u79fb\u9664\u76f4\u6d41\u504f\u7f6e (\u6309\u5217)</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u8f93\u5165\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u53bb\u9664\u76f4\u6d41\u504f\u7f6e\u540e\u7684\u6570\u636e</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/das_processor.py</code> <pre><code>def NormalizeDC(self, data: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u79fb\u9664\u76f4\u6d41\u504f\u7f6e (\u6309\u5217)\n\n    Args:\n        data: \u8f93\u5165\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)\n\n    Returns:\n        np.ndarray: \u53bb\u9664\u76f4\u6d41\u504f\u7f6e\u540e\u7684\u6570\u636e\n    \"\"\"\n    return data - np.mean(data, axis=0, keepdims=True)\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASProcessor.ProcessDifferential","title":"ProcessDifferential","text":"<pre><code>ProcessDifferential(raw_data: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u5904\u7406\u539f\u59cb\u6570\u636e\uff0c\u5f97\u5230\u5dee\u5206\u6570\u636e (\u9ad8\u901a\u6ee4\u6ce2\u548c\u53bb\u76f4\u6d41)</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>raw_data</code> <code>ndarray</code> <p>\u539f\u59cb\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u5904\u7406\u540e\u7684\u5dee\u5206\u6570\u636e</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/das_processor.py</code> <pre><code>def ProcessDifferential(self, raw_data: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u5904\u7406\u539f\u59cb\u6570\u636e\uff0c\u5f97\u5230\u5dee\u5206\u6570\u636e (\u9ad8\u901a\u6ee4\u6ce2\u548c\u53bb\u76f4\u6d41)\n\n    Args:\n        raw_data: \u539f\u59cb\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)\n\n    Returns:\n        np.ndarray: \u5904\u7406\u540e\u7684\u5dee\u5206\u6570\u636e\n    \"\"\"\n    # \u9ad8\u901a\u6ee4\u6ce2\n    filtered_data = self.ApplyFilter(raw_data, self.sos_highpass)\n    # DC\u504f\u7f6e\u6821\u6b63\n    processed_data = self.NormalizeDC(filtered_data)\n    return processed_data\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASProcessor.IntegrateData","title":"IntegrateData","text":"<pre><code>IntegrateData(raw_data: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u8ba1\u7b97\u79ef\u5206\u6570\u636e (\u7d2f\u52a0\u3001\u9ad8\u901a\u6ee4\u6ce2\u3001\u53bb\u76f4\u6d41)</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>raw_data</code> <code>ndarray</code> <p>\u539f\u59cb\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u8ba1\u7b97\u5f97\u5230\u7684\u79ef\u5206\u6570\u636e</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/das_processor.py</code> <pre><code>def IntegrateData(self, raw_data: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u8ba1\u7b97\u79ef\u5206\u6570\u636e (\u7d2f\u52a0\u3001\u9ad8\u901a\u6ee4\u6ce2\u3001\u53bb\u76f4\u6d41)\n\n    Args:\n        raw_data: \u539f\u59cb\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)\n\n    Returns:\n        np.ndarray: \u8ba1\u7b97\u5f97\u5230\u7684\u79ef\u5206\u6570\u636e\n    \"\"\"\n    # \u8ba1\u7b97\u7d2f\u79ef\u548c (\u79ef\u5206)\n    int_data = np.cumsum(raw_data, axis=0)\n    # \u9ad8\u901a\u6ee4\u6ce2\n    filtered_int_data = self.ApplyFilter(int_data, self.sos_highpass)\n    # DC\u504f\u7f6e\u6821\u6b63\n    processed_int_data = self.NormalizeDC(filtered_int_data)\n    return processed_int_data\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASProcessor.ComputeSpectrum","title":"ComputeSpectrum","text":"<pre><code>ComputeSpectrum(\n    data: ndarray,\n    channel_index: int,\n    window_size: int = 1024,\n    overlap: float = 0.5,\n) -&gt; Dict[str, np.ndarray]\n</code></pre> <p>\u8ba1\u7b97\u6307\u5b9a\u901a\u9053\u4fe1\u53f7\u7684\u9891\u8c31</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u8f93\u5165\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)</p> \u5fc5\u9700 <code>channel_index</code> <code>int</code> <p>\u8981\u8ba1\u7b97\u9891\u8c31\u7684\u901a\u9053\u7d22\u5f15</p> \u5fc5\u9700 <code>window_size</code> <code>int</code> <p>STFT\u7a97\u53e3\u5927\u5c0f</p> <code>1024</code> <code>overlap</code> <code>float</code> <p>STFT\u7a97\u53e3\u91cd\u53e0\u6bd4\u4f8b</p> <code>0.5</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Dict[str, ndarray]</code> <p>Dict[str, np.ndarray]: \u5305\u542b\u9891\u7387('frequencies')\u548c\u5e73\u5747\u5e45\u503c('magnitudes')\u7684\u5b57\u5178</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/das_processor.py</code> <pre><code>def ComputeSpectrum(\n    self,\n    data: np.ndarray,\n    channel_index: int,\n    window_size: int = 1024,\n    overlap: float = 0.5,\n) -&gt; Dict[str, np.ndarray]:\n    \"\"\"\u8ba1\u7b97\u6307\u5b9a\u901a\u9053\u4fe1\u53f7\u7684\u9891\u8c31\n\n    Args:\n        data: \u8f93\u5165\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)\n        channel_index: \u8981\u8ba1\u7b97\u9891\u8c31\u7684\u901a\u9053\u7d22\u5f15\n        window_size: STFT\u7a97\u53e3\u5927\u5c0f\n        overlap: STFT\u7a97\u53e3\u91cd\u53e0\u6bd4\u4f8b\n\n    Returns:\n        Dict[str, np.ndarray]: \u5305\u542b\u9891\u7387('frequencies')\u548c\u5e73\u5747\u5e45\u503c('magnitudes')\u7684\u5b57\u5178\n    \"\"\"\n    if channel_index &lt; 0 or channel_index &gt;= data.shape[1]:\n        raise IndexError(\n            f\"\u901a\u9053\u7d22\u5f15 {channel_index} \u8d85\u51fa\u8303\u56f4 [0, {data.shape[1] - 1}]\"\n        )\n\n    # \u63d0\u53d6\u6307\u5b9a\u901a\u9053\u7684\u6570\u636e\n    channel_data = data[:, channel_index]\n\n    # \u8ba1\u7b97\u77ed\u65f6\u5085\u91cc\u53f6\u53d8\u6362 (STFT)\n    frequencies, times, spectrogram = signal.spectrogram(\n        channel_data,\n        fs=self.fs,\n        window=\"hann\",\n        nperseg=window_size,\n        noverlap=int(window_size * overlap),\n        detrend=\"constant\",\n        scaling=\"spectrum\",  # \u8fd4\u56de\u529f\u7387\u8c31\u5bc6\u5ea6\n    )\n\n    # \u8ba1\u7b97\u6bcf\u4e2a\u9891\u7387\u5206\u91cf\u7684\u5e73\u5747\u5e45\u503c (\u8de8\u65f6\u95f4)\n    # \u6ce8\u610f\uff1aspectrogram \u8fd4\u56de\u7684\u662f\u529f\u7387\u8c31\u5bc6\u5ea6\uff0c\u9700\u8981\u53d6\u5e73\u65b9\u6839\u5f97\u5230\u5e45\u503c\u8c31\n    # \u6216\u8005\u76f4\u63a5\u4f7f\u7528\u5e45\u503c\u8c31 (scaling='spectrum') \u8fd4\u56de\u7684\u7ed3\u679c\n    magnitudes = np.mean(np.abs(spectrogram), axis=1)\n\n    return {\"frequencies\": frequencies, \"magnitudes\": magnitudes}\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASProcessor.FindPeakFrequencies","title":"FindPeakFrequencies","text":"<pre><code>FindPeakFrequencies(\n    spectrum: Dict[str, ndarray],\n    min_freq: float = 0,\n    max_freq: Optional[float] = None,\n    n_peaks: int = 3,\n    min_prominence: Optional[float] = None,\n) -&gt; List[Dict[str, float]]\n</code></pre> <p>\u5728\u9891\u8c31\u4e2d\u67e5\u627e\u5cf0\u503c\u9891\u7387</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>spectrum</code> <code>Dict[str, ndarray]</code> <p>\u9891\u8c31\u6570\u636e\u5b57\u5178\uff0c\u5305\u542b 'frequencies' \u548c 'magnitudes'</p> \u5fc5\u9700 <code>min_freq</code> <code>float</code> <p>\u6700\u5c0f\u9891\u7387\u9650\u5236 (Hz)</p> <code>0</code> <code>max_freq</code> <code>Optional[float]</code> <p>\u6700\u5927\u9891\u7387\u9650\u5236 (Hz)\uff0c\u9ed8\u8ba4\u4e3aNone (\u4f7f\u7528\u6700\u5927\u9891\u7387)</p> <code>None</code> <code>n_peaks</code> <code>int</code> <p>\u8fd4\u56de\u7684\u6700\u5927\u5cf0\u503c\u6570\u91cf</p> <code>3</code> <code>min_prominence</code> <code>Optional[float]</code> <p>\u5cf0\u503c\u7684\u6700\u5c0f\u51f8\u8d77\u5ea6\uff0c\u7528\u4e8e\u8fc7\u6ee4\u4e0d\u663e\u8457\u7684\u5cf0\u503c</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[Dict[str, float]]</code> <p>List[Dict[str, float]]: \u5cf0\u503c\u5217\u8868\uff0c\u6bcf\u4e2a\u5cf0\u503c\u5305\u542b 'frequency' \u548c 'magnitude'</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/das_processor.py</code> <pre><code>def FindPeakFrequencies(\n    self,\n    spectrum: Dict[str, np.ndarray],\n    min_freq: float = 0,\n    max_freq: Optional[float] = None,\n    n_peaks: int = 3,\n    min_prominence: Optional[float] = None,  # \u65b0\u589e\uff1a\u5cf0\u503c\u6700\u5c0f\u51f8\u8d77\u5ea6\n) -&gt; List[Dict[str, float]]:\n    \"\"\"\u5728\u9891\u8c31\u4e2d\u67e5\u627e\u5cf0\u503c\u9891\u7387\n\n    Args:\n        spectrum: \u9891\u8c31\u6570\u636e\u5b57\u5178\uff0c\u5305\u542b 'frequencies' \u548c 'magnitudes'\n        min_freq: \u6700\u5c0f\u9891\u7387\u9650\u5236 (Hz)\n        max_freq: \u6700\u5927\u9891\u7387\u9650\u5236 (Hz)\uff0c\u9ed8\u8ba4\u4e3aNone (\u4f7f\u7528\u6700\u5927\u9891\u7387)\n        n_peaks: \u8fd4\u56de\u7684\u6700\u5927\u5cf0\u503c\u6570\u91cf\n        min_prominence: \u5cf0\u503c\u7684\u6700\u5c0f\u51f8\u8d77\u5ea6\uff0c\u7528\u4e8e\u8fc7\u6ee4\u4e0d\u663e\u8457\u7684\u5cf0\u503c\n\n    Returns:\n        List[Dict[str, float]]: \u5cf0\u503c\u5217\u8868\uff0c\u6bcf\u4e2a\u5cf0\u503c\u5305\u542b 'frequency' \u548c 'magnitude'\n    \"\"\"\n    frequencies = spectrum[\"frequencies\"]\n    magnitudes = spectrum[\"magnitudes\"]\n\n    if frequencies.size == 0 or magnitudes.size == 0:\n        self.logger.warning(\"\u9891\u8c31\u6570\u636e\u4e3a\u7a7a\uff0c\u65e0\u6cd5\u67e5\u627e\u5cf0\u503c\")\n        return []\n\n    # \u9650\u5236\u9891\u7387\u8303\u56f4\n    if max_freq is None:\n        max_freq = frequencies[-1]\n\n    mask = (frequencies &gt;= min_freq) &amp; (frequencies &lt;= max_freq)\n    valid_freqs = frequencies[mask]\n    valid_mags = magnitudes[mask]\n\n    if valid_freqs.size == 0:\n        self.logger.warning(\"\u5728\u6307\u5b9a\u9891\u7387\u8303\u56f4\u5185\u6ca1\u6709\u6570\u636e\u70b9\uff0c\u65e0\u6cd5\u67e5\u627e\u5cf0\u503c\")\n        return []\n\n    # \u67e5\u627e\u5cf0\u503c\n    peaks, properties = signal.find_peaks(valid_mags, prominence=min_prominence)\n\n    if len(peaks) == 0:\n        self.logger.info(\"\u5728\u6307\u5b9a\u8303\u56f4\u5185\u672a\u627e\u5230\u663e\u8457\u5cf0\u503c\")\n        return []\n\n    # \u6309\u5e45\u503c\u6392\u5e8f\u5cf0\u503c (\u4f7f\u7528\u5cf0\u503c\u5904\u7684\u5e45\u503c\uff0c\u800c\u4e0d\u662f\u51f8\u8d77\u5ea6)\n    peak_magnitudes = valid_mags[peaks]\n    sorted_indices = np.argsort(peak_magnitudes)[::-1]  # \u964d\u5e8f\u6392\u5e8f\n\n    # \u53d6\u524d n_peaks \u4e2a\u5cf0\u503c\n    top_peak_indices = peaks[sorted_indices[:n_peaks]]\n\n    # \u6784\u5efa\u7ed3\u679c\n    result = []\n    for idx in top_peak_indices:\n        result.append(\n            {\n                \"frequency\": valid_freqs[idx],\n                \"magnitude\": valid_mags[idx],\n            }\n        )\n\n    self.logger.debug(f\"\u627e\u5230 {len(result)} \u4e2a\u5cf0\u503c: {result}\")\n    return result\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASProcessor.ApplyBandpassFilter","title":"ApplyBandpassFilter","text":"<pre><code>ApplyBandpassFilter(\n    data: ndarray, low_freq: float, high_freq: float\n) -&gt; np.ndarray\n</code></pre> <p>\u5e94\u7528\u5e26\u901a\u6ee4\u6ce2\u5668</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u8f93\u5165\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)</p> \u5fc5\u9700 <code>low_freq</code> <code>float</code> <p>\u4f4e\u622a\u6b62\u9891\u7387 (Hz)</p> \u5fc5\u9700 <code>high_freq</code> <code>float</code> <p>\u9ad8\u622a\u6b62\u9891\u7387 (Hz)</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u6ee4\u6ce2\u540e\u7684\u6570\u636e</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/das_processor.py</code> <pre><code>def ApplyBandpassFilter(\n    self, data: np.ndarray, low_freq: float, high_freq: float\n) -&gt; np.ndarray:\n    \"\"\"\u5e94\u7528\u5e26\u901a\u6ee4\u6ce2\u5668\n\n    Args:\n        data: \u8f93\u5165\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)\n        low_freq: \u4f4e\u622a\u6b62\u9891\u7387 (Hz)\n        high_freq: \u9ad8\u622a\u6b62\u9891\u7387 (Hz)\n\n    Returns:\n        np.ndarray: \u6ee4\u6ce2\u540e\u7684\u6570\u636e\n    \"\"\"\n    # \u8bbe\u8ba1\u5e26\u901a\u6ee4\u6ce2\u5668\n    sos_bandpass = self._create_filter(\n        cutoff=[low_freq, high_freq], btype=\"bandpass\"\n    )\n\n    # \u5e94\u7528\u6ee4\u6ce2\u5668\n    filtered_data = self.ApplyFilter(data, sos_bandpass)\n    return filtered_data\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASProcessor.EvaluateFrequencyResponse","title":"EvaluateFrequencyResponse","text":"<pre><code>EvaluateFrequencyResponse(\n    data: ndarray,\n    target_frequencies: List[float],\n    window_size: int = 1024,\n) -&gt; List[Dict[str, Any]]\n</code></pre> <p>\u5206\u6790\u7279\u5b9a\u9891\u7387\u4e0b\u7684\u54cd\u5e94</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u8f93\u5165\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)</p> \u5fc5\u9700 <code>target_frequencies</code> <code>List[float]</code> <p>\u76ee\u6807\u9891\u7387\u5217\u8868 (Hz)</p> \u5fc5\u9700 <code>window_size</code> <code>int</code> <p>\u7528\u4e8e\u9891\u8c31\u8ba1\u7b97\u7684\u7a97\u53e3\u5927\u5c0f</p> <code>1024</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[Dict[str, Any]]</code> <p>List[Dict[str, Any]]: \u5305\u542b\u6bcf\u4e2a\u76ee\u6807\u9891\u7387\u54cd\u5e94\u4fe1\u606f\u7684\u5217\u8868                    \u6bcf\u4e2a\u5b57\u5178\u5305\u542b: 'freq', 'max_response_channel',                    'peak_response_value', 'all_channel_responses' (RMS)</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/das_processor.py</code> <pre><code>def EvaluateFrequencyResponse(\n    self, data: np.ndarray, target_frequencies: List[float], window_size: int = 1024\n) -&gt; List[Dict[str, Any]]:\n    \"\"\"\u5206\u6790\u7279\u5b9a\u9891\u7387\u4e0b\u7684\u54cd\u5e94\n\n    Args:\n        data: \u8f93\u5165\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)\n        target_frequencies: \u76ee\u6807\u9891\u7387\u5217\u8868 (Hz)\n        window_size: \u7528\u4e8e\u9891\u8c31\u8ba1\u7b97\u7684\u7a97\u53e3\u5927\u5c0f\n\n    Returns:\n        List[Dict[str, Any]]: \u5305\u542b\u6bcf\u4e2a\u76ee\u6807\u9891\u7387\u54cd\u5e94\u4fe1\u606f\u7684\u5217\u8868\n                               \u6bcf\u4e2a\u5b57\u5178\u5305\u542b: 'freq', 'max_response_channel',\n                               'peak_response_value', 'all_channel_responses' (RMS)\n    \"\"\"\n    analysis_results = []\n\n    for freq in target_frequencies:\n        self.logger.debug(f\"\u5206\u6790\u9891\u7387 {freq}Hz\")\n        # \u5bf9\u6bcf\u4e2a\u9891\u7387\u5e94\u7528\u7a84\u5e26\u5e26\u901a\u6ee4\u6ce2\n        # \u53ef\u4ee5\u6839\u636e\u9700\u8981\u8c03\u6574\u5e26\u5bbd\uff0c\u4f8b\u5982 +/- 5% \u6216\u56fa\u5b9a\u5e26\u5bbd\n        bandwidth_ratio = 0.10  # \u4f8b\u5982 +/- 10%\n        low_freq = freq * (1 - bandwidth_ratio / 2)\n        high_freq = freq * (1 + bandwidth_ratio / 2)\n\n        # \u786e\u4fdd\u9891\u7387\u8303\u56f4\u6709\u6548\n        if low_freq &lt; 0:\n            low_freq = 1e-3  # \u907f\u514d0Hz\n        if high_freq &gt; self.fs / 2:\n            high_freq = self.fs / 2 - 1e-3  # \u907f\u514d\u5948\u594e\u65af\u7279\u9891\u7387\n\n        if low_freq &gt;= high_freq:\n            self.logger.warning(\n                f\"\u9891\u7387 {freq}Hz \u8ba1\u7b97\u51fa\u7684\u5e26\u5bbd\u65e0\u6548 [{low_freq:.2f}, {high_freq:.2f}]\"\n                f\"\u8df3\u8fc7\u6b64\u9891\u7387\"\n            )\n            continue\n\n        filtered_data = self.ApplyBandpassFilter(data, low_freq, high_freq)\n\n        # \u8ba1\u7b97\u6bcf\u4e2a\u901a\u9053\u6ee4\u6ce2\u540e\u7684\u5747\u65b9\u6839 (RMS) \u503c\u4f5c\u4e3a\u54cd\u5e94\u5f3a\u5ea6\n        rms_values = np.sqrt(np.mean(filtered_data**2, axis=0))\n\n        if rms_values.size == 0:\n            self.logger.warning(f\"\u9891\u7387 {freq}Hz \u6ee4\u6ce2\u540e\u65e0\u6709\u6548\u54cd\u5e94\u6570\u636e\")\n            continue\n\n        # \u627e\u51fa\u54cd\u5e94\u6700\u5f3a\u7684\u901a\u9053\u53ca\u5176RMS\u503c\n        max_response_channel = np.argmax(rms_values)\n        peak_response_value = rms_values[max_response_channel]\n\n        self.logger.debug(\n            f\"\u9891\u7387 {freq}Hz: \u6700\u5927\u54cd\u5e94\u901a\u9053 {max_response_channel}, \"\n            f\"\u5cf0\u503cRMS {peak_response_value:.4f}\"\n        )\n\n        analysis_results.append(\n            {\n                \"freq\": freq,\n                \"max_response_channel\": int(max_response_channel),  # \u786e\u4fdd\u662f\u6574\u6570\n                \"peak_response_value\": peak_response_value,\n                \"all_channel_responses\": rms_values,  # \u8fd4\u56de\u6240\u6709\u901a\u9053\u7684RMS\u503c\n            }\n        )\n\n    return analysis_results\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASProcessor.f_k_transform","title":"f_k_transform","text":"<pre><code>f_k_transform(\n    data: ndarray,\n) -&gt; Tuple[np.ndarray, np.ndarray, np.ndarray]\n</code></pre> <p>\u6267\u884c\u4e8c\u7ef4\u5085\u91cc\u53f6\u53d8\u6362 (F-K \u53d8\u6362)</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u8f93\u5165\u65f6\u7a7a\u6570\u636e (n_time, n_channels)</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Tuple[ndarray, ndarray, ndarray]</code> <p>Tuple[np.ndarray, np.ndarray, np.ndarray]: (spectrum, freqs, wavenumbers) - spectrum: FK \u8c31 (complex) - freqs: \u9891\u7387\u8f74 (Hz) - wavenumbers: \u6ce2\u6570\u8f74 (1/m) \u6ce8\u610f\uff1a\u9700\u8981\u77e5\u9053\u7a7a\u95f4\u91c7\u6837\u7387\uff0c\u6b64\u5904\u6682\u5047\u8bbe dx=1</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/das_processor.py</code> <pre><code>def f_k_transform(\n    self, data: np.ndarray\n) -&gt; Tuple[np.ndarray, np.ndarray, np.ndarray]:\n    \"\"\"\u6267\u884c\u4e8c\u7ef4\u5085\u91cc\u53f6\u53d8\u6362 (F-K \u53d8\u6362)\n\n    Args:\n        data: \u8f93\u5165\u65f6\u7a7a\u6570\u636e (n_time, n_channels)\n\n    Returns:\n        Tuple[np.ndarray, np.ndarray, np.ndarray]: (spectrum, freqs, wavenumbers)\n            - spectrum: FK \u8c31 (complex)\n            - freqs: \u9891\u7387\u8f74 (Hz)\n            - wavenumbers: \u6ce2\u6570\u8f74 (1/m) \u6ce8\u610f\uff1a\u9700\u8981\u77e5\u9053\u7a7a\u95f4\u91c7\u6837\u7387\uff0c\u6b64\u5904\u6682\u5047\u8bbe dx=1\n    \"\"\"\n    nt, nx = data.shape\n\n    # \u5bf9\u65f6\u95f4\u548c\u7a7a\u95f4\u7ef4\u5ea6\u8fdb\u884c FFT\n    # \u79fb\u4f4d\u5c06\u96f6\u9891\u79fb\u5230\u4e2d\u5fc3\n    fk = np.fft.fftshift(np.fft.fft2(data))\n\n    # \u8ba1\u7b97\u5750\u6807\u8f74\n    freqs = np.fft.fftshift(np.fft.fftfreq(nt, 1.0 / self.fs))\n    wavenumbers = np.fft.fftshift(\n        np.fft.fftfreq(nx)\n    )  # \u6807\u51c6\u5316\u6ce2\u6570\uff0c\u5b9e\u9645\u6ce2\u6570\u9700\u9664\u4ee5 d_x\n\n    return fk, freqs, wavenumbers\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASProcessor.iwf_k_transform","title":"iwf_k_transform","text":"<pre><code>iwf_k_transform(fk_spectrum: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u6267\u884c\u9006\u4e8c\u7ef4\u5085\u91cc\u53f6\u53d8\u6362 (Inverse F-K \u53d8\u6362)</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>fk_spectrum</code> <code>ndarray</code> <p>FK \u8c31 (complex)</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u6062\u590d\u7684\u65f6\u57df\u6570\u636e (real)</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/das_processor.py</code> <pre><code>def iwf_k_transform(self, fk_spectrum: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u6267\u884c\u9006\u4e8c\u7ef4\u5085\u91cc\u53f6\u53d8\u6362 (Inverse F-K \u53d8\u6362)\n\n    Args:\n        fk_spectrum: FK \u8c31 (complex)\n\n    Returns:\n        np.ndarray: \u6062\u590d\u7684\u65f6\u57df\u6570\u636e (real)\n    \"\"\"\n    # \u9006\u79fb\u4f4d\u540e\u9006\u53d8\u6362\n    # \u4f7f\u7528 ifft2 \u6062\u590d\uff0c\u5e76\u53ea\u53d6\u5b9e\u90e8\uff08\u5047\u8bbe\u8f93\u5165\u6570\u636e\u4e3a\u5b9e\u6570\uff09\n    data = np.fft.ifft2(np.fft.ifftshift(fk_spectrum)).real\n    return data\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASProcessor.FKFilter","title":"FKFilter","text":"<pre><code>FKFilter(\n    data: ndarray,\n    v_min: Optional[float] = None,\n    v_max: Optional[float] = None,\n    dx: float = 1.0,\n) -&gt; np.ndarray\n</code></pre> <p>\u5e94\u7528 F-K \u6ee4\u6ce2\u5668\uff08\u901f\u5ea6\u6ee4\u6ce2\uff09</p> <p>\u901a\u8fc7\u5728 F-K \u57df\u4e2d\u5b9a\u4e49\u6247\u5f62\u533a\u57df\u6765\u4fdd\u7559\u6216\u5207\u9664\u7279\u5b9a\u89c6\u901f\u5ea6\u7684\u6ce2\u573a\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u8f93\u5165\u6570\u636e (n_time, n_channels)</p> \u5fc5\u9700 <code>v_min</code> <code>Optional[float]</code> <p>\u6700\u5c0f\u4fdd\u7559\u89c6\u901f\u5ea6 (m/s)</p> <code>None</code> <code>v_max</code> <code>Optional[float]</code> <p>\u6700\u5927\u4fdd\u7559\u89c6\u901f\u5ea6 (m/s)</p> <code>None</code> <code>dx</code> <code>float</code> <p>\u901a\u9053\u95f4\u8ddd (m)</p> <code>1.0</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u6ee4\u6ce2\u540e\u7684\u6570\u636e</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/das_processor.py</code> <pre><code>def FKFilter(\n    self,\n    data: np.ndarray,\n    v_min: Optional[float] = None,\n    v_max: Optional[float] = None,\n    dx: float = 1.0,\n) -&gt; np.ndarray:\n    \"\"\"\u5e94\u7528 F-K \u6ee4\u6ce2\u5668\uff08\u901f\u5ea6\u6ee4\u6ce2\uff09\n\n    \u901a\u8fc7\u5728 F-K \u57df\u4e2d\u5b9a\u4e49\u6247\u5f62\u533a\u57df\u6765\u4fdd\u7559\u6216\u5207\u9664\u7279\u5b9a\u89c6\u901f\u5ea6\u7684\u6ce2\u573a\u3002\n\n    Args:\n        data: \u8f93\u5165\u6570\u636e (n_time, n_channels)\n        v_min: \u6700\u5c0f\u4fdd\u7559\u89c6\u901f\u5ea6 (m/s)\n        v_max: \u6700\u5927\u4fdd\u7559\u89c6\u901f\u5ea6 (m/s)\n        dx: \u901a\u9053\u95f4\u8ddd (m)\n\n    Returns:\n        np.ndarray: \u6ee4\u6ce2\u540e\u7684\u6570\u636e\n    \"\"\"\n    nt, nx = data.shape\n    fk, freqs, k = self.f_k_transform(data)\n\n    # \u8c03\u6574\u6ce2\u6570\u8f74\u4e3a\u7269\u7406\u5355\u4f4d (1/m)\n    k = k / dx\n\n    # \u521b\u5efa\u7f51\u683c\n    K, F = np.meshgrid(k, freqs)\n\n    # \u8ba1\u7b97\u89c6\u901f\u5ea6 V = f / k\n    # \u6ce8\u610f\u5904\u7406 k=0 \u7684\u60c5\u51b5\n    with np.errstate(divide=\"ignore\", invalid=\"ignore\"):\n        V = F / K\n\n    # \u521b\u5efa\u63a9\u7801\n    mask = np.ones_like(fk, dtype=bool)\n\n    if v_min is not None:\n        # \u4ec5\u4fdd\u7559\u901f\u5ea6\u5927\u4e8e v_min \u7684\u6ce2 (\u6216\u5c0f\u4e8e -v_min\uff0c\u5bf9\u79f0)\n        # \u5b9e\u9645\u4e0a FK \u6ee4\u6ce2\u901a\u5e38\u5b9a\u4e49\u4e3a\u4e00\u4e2a\u6247\u533a\n        # \u8fd9\u91cc\u7b80\u5355\u5b9e\u73b0\uff1a\u4fdd\u7559 abs(V) &gt;= v_min\n        mask &amp;= (np.abs(V) &gt;= abs(v_min)) | np.isnan(V)\n\n    if v_max is not None:\n        # \u4fdd\u7559 abs(V) &lt;= v_max\n        mask &amp;= (np.abs(V) &lt;= abs(v_max)) | np.isnan(V)\n\n    # \u5e94\u7528\u63a9\u7801\n    fk_filtered = fk * mask\n\n    # \u9006\u53d8\u6362\n    return self.iwf_k_transform(fk_filtered)\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASVisualizer","title":"DASVisualizer","text":"<pre><code>DASVisualizer(\n    output_path: Union[str, Path],\n    sampling_frequency: float,\n    config: Optional[VisualizationConfig] = None,\n)\n</code></pre> <p>DAS \u6570\u636e\u53ef\u89c6\u5316\u5668 (DAS Data Visualizer)</p> <p>\u521d\u59cb\u5316 DAS \u6570\u636e\u53ef\u89c6\u5316\u5668</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>output_path</code> <code>Union[str, Path]</code> <p>\u56fe\u50cf\u8f93\u51fa\u76ee\u5f55</p> \u5fc5\u9700 <code>sampling_frequency</code> <code>float</code> <p>\u91c7\u6837\u9891\u7387 (Hz)</p> \u5fc5\u9700 <code>config</code> <code>Optional[VisualizationConfig]</code> <p>\u53ef\u89c6\u5316\u914d\u7f6e\uff0c\u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def __init__(\n    self,\n    output_path: Union[str, Path],\n    sampling_frequency: float,\n    config: Optional[VisualizationConfig] = None,\n):\n    \"\"\"\u521d\u59cb\u5316 DAS \u6570\u636e\u53ef\u89c6\u5316\u5668\n\n    Args:\n        output_path: \u56fe\u50cf\u8f93\u51fa\u76ee\u5f55\n        sampling_frequency: \u91c7\u6837\u9891\u7387 (Hz)\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\uff0c\u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\n    \"\"\"\n    self.output_path = (\n        Path(output_path) if isinstance(output_path, str) else output_path\n    )\n    self.output_path.mkdir(parents=True, exist_ok=True)\n    self.fs = sampling_frequency\n    self.config = config or VisualizationConfig()\n    self.logger = logging.getLogger(__name__)\n\n    # \u521d\u59cb\u5316\u7ed8\u56fe\u5668\u5b9e\u4f8b\n    self.waveform_plotter = WaveformPlot(self.config)\n    self.spectrum_plotter = SpectrumPlot(self.config)\n    self.spectrogram_plotter = SpectrogramPlot(self.config)\n    self.waterfall_plotter = WaterfallPlot(self.config)\n\n    # \u68c0\u6d4b\u662f\u5426\u5728 Jupyter \u73af\u5883\u4e2d\n    self._in_jupyter = self._check_jupyter()\n\n    # \u6027\u80fd\u4f18\u5316\uff1a\u9884\u5148\u5bfc\u5165\u5e38\u7528\u5e93\uff0c\u907f\u514d\u6bcf\u6b21\u7ed8\u56fe\u90fd\u91cd\u65b0\u5bfc\u5165\n    try:\n        import matplotlib.pyplot as plt\n\n        self._plt = plt\n        from scipy import signal\n\n        self._signal = signal\n    except ImportError:\n        self.logger.warning(\"Could not preload matplotlib or scipy.signal\")\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASVisualizer.WaveformPlot","title":"WaveformPlot","text":"<pre><code>WaveformPlot(\n    amplitude_data: ndarray,\n    time_range: Optional[Tuple[float, float]] = None,\n    amplitude_range: Optional[Tuple[float, float]] = None,\n    file_name: Optional[str] = None,\n    title: Optional[str] = None,\n    highlight_regions: Optional[\n        List[Tuple[float, float]]\n    ] = None,\n    ax: Optional[Axes] = None,\n) -&gt; Any\n</code></pre> <p>\u7ed8\u5236\u65f6\u57df\u6ce2\u5f62\u56fe</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>amplitude_data</code> <code>ndarray</code> <p>\u4e00\u7ef4\u6570\u7ec4\uff0c\u5305\u542b\u5355\u4e2a\u901a\u9053\u7684\u65f6\u57df\u6570\u636e</p> \u5fc5\u9700 <code>time_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0c\u65f6\u95f4\u663e\u793a\u8303\u56f4 (start_time, end_time)</p> <code>None</code> <code>amplitude_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0c\u5e45\u503c\u663e\u793a\u8303\u56f4 (min_amplitude, max_amplitude)</p> <code>None</code> <code>file_name</code> <code>Optional[str]</code> <p>\u4fdd\u5b58\u7684\u6587\u4ef6\u540d (\u4e0d\u542b\u6269\u5c55\u540d)\uff0c\u82e5\u63d0\u4f9b\u5219\u4fdd\u5b58\u56fe\u7247</p> <code>None</code> <code>title</code> <code>Optional[str]</code> <p>\u56fe\u8868\u6807\u9898 (\u82f1\u6587)</p> <code>None</code> <code>highlight_regions</code> <code>Optional[List[Tuple[float, float]]]</code> <p>\u53ef\u9009\u7684\u9ad8\u4eae\u533a\u57df\u5217\u8868\uff0c\u6bcf\u4e2a\u5143\u7d20\u4e3a(\u5f00\u59cb\u65f6\u95f4, \u7ed3\u675f\u65f6\u95f4)\u5143\u7ec4</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Figure</code> <code>Any</code> <p>matplotlib \u56fe\u5f62\u5bf9\u8c61\uff0c\u53ef\u5728 Jupyter notebook \u4e2d\u663e\u793a</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def WaveformPlot(\n    self,\n    amplitude_data: np.ndarray,\n    time_range: Optional[Tuple[float, float]] = None,\n    amplitude_range: Optional[Tuple[float, float]] = None,\n    file_name: Optional[str] = None,\n    title: Optional[str] = None,\n    highlight_regions: Optional[List[Tuple[float, float]]] = None,\n    ax: Optional[plt.Axes] = None,\n) -&gt; Any:\n    \"\"\"\u7ed8\u5236\u65f6\u57df\u6ce2\u5f62\u56fe\n\n    Args:\n        amplitude_data: \u4e00\u7ef4\u6570\u7ec4\uff0c\u5305\u542b\u5355\u4e2a\u901a\u9053\u7684\u65f6\u57df\u6570\u636e\n        time_range: \u53ef\u9009\uff0c\u65f6\u95f4\u663e\u793a\u8303\u56f4 (start_time, end_time)\n        amplitude_range: \u53ef\u9009\uff0c\u5e45\u503c\u663e\u793a\u8303\u56f4 (min_amplitude, max_amplitude)\n        file_name: \u4fdd\u5b58\u7684\u6587\u4ef6\u540d (\u4e0d\u542b\u6269\u5c55\u540d)\uff0c\u82e5\u63d0\u4f9b\u5219\u4fdd\u5b58\u56fe\u7247\n        title: \u56fe\u8868\u6807\u9898 (\u82f1\u6587)\n        highlight_regions: \u53ef\u9009\u7684\u9ad8\u4eae\u533a\u57df\u5217\u8868\uff0c\u6bcf\u4e2a\u5143\u7d20\u4e3a(\u5f00\u59cb\u65f6\u95f4, \u7ed3\u675f\u65f6\u95f4)\u5143\u7ec4\n\n    Returns:\n        Figure: matplotlib \u56fe\u5f62\u5bf9\u8c61\uff0c\u53ef\u5728 Jupyter notebook \u4e2d\u663e\u793a\n    \"\"\"\n    # \u6027\u80fd\u4f18\u5316\uff1a\u52a0\u5165\u6570\u636e\u9a8c\u8bc1\u524d\u7684\u5feb\u901f\u8def\u5f84\u68c0\u67e5\n    if amplitude_data is None or len(amplitude_data) == 0:\n        self.logger.error(\"\u8f93\u5165\u6570\u636e\u4e3a\u7a7a\")\n        return None\n\n    if not isinstance(amplitude_data, np.ndarray) or amplitude_data.ndim != 1:\n        self.logger.error(\n            f\"\u6570\u636e\u5fc5\u987b\u662f\u4e00\u7ef4numpy\u6570\u7ec4\uff0c\u5f53\u524d\u7ef4\u5ea6: {amplitude_data.ndim}\"\n        )\n        return None\n\n    # \u7ed8\u56fe\u524d\u542f\u7528agg\u540e\u7aef\u53ef\u4ee5\u63d0\u9ad8\u975e\u4ea4\u4e92\u5f0f\u7ed8\u56fe\u6027\u80fd\n    import matplotlib\n\n    prev_backend = matplotlib.get_backend()\n    if not self._in_jupyter:\n        matplotlib.use(\"agg\")  # \u975e\u4ea4\u4e92\u5f0f\u540e\u7aef\uff0c\u66f4\u5feb\n\n    # \u7ed8\u5236\u6ce2\u5f62\u56fe\n    fig = self.waveform_plotter.plot(\n        amplitude_data=amplitude_data,\n        fs=self.fs,  # \u4f20\u9012\u91c7\u6837\u9891\u7387\n        time_range=time_range,\n        amplitude_range=amplitude_range,\n        title=title,\n        highlight_regions=highlight_regions,\n        ax=ax,\n    )\n\n    # \u5982\u679c\u63d0\u4f9b\u4e86\u6587\u4ef6\u540d\uff0c\u5219\u4fdd\u5b58\u56fe\u7247\n    if file_name is not None:\n        save_path = self.output_path / f\"{file_name}.png\"\n        self.waveform_plotter.save_figure(save_path, close_after_save=False)\n\n    # \u8fd8\u539f\u540e\u7aef\n    if not self._in_jupyter:\n        matplotlib.use(prev_backend)\n\n    # \u5904\u7406\u56fe\u5f62\u663e\u793a\uff0c\u907f\u514d\u53cc\u91cd\u663e\u793a\n    return self._handle_figure_display(fig)\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASVisualizer.SpectrumPlot","title":"SpectrumPlot","text":"<pre><code>SpectrumPlot(\n    data: ndarray,\n    excitation_freq: Optional[float] = None,\n    file_name: Optional[str] = None,\n    title: Optional[str] = None,\n    peaks: Optional[List[Dict[str, float]]] = None,\n    freq_range: Optional[Tuple[float, float]] = None,\n    db_range: Optional[Tuple[float, float]] = None,\n    ax: Optional[Axes] = None,\n) -&gt; Any\n</code></pre> <p>\u7ed8\u5236\u5e76\u4fdd\u5b58\u9891\u8c31\u56fe</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u4e00\u7ef4\u6570\u7ec4\uff0c\u5305\u542b\u5355\u4e2a\u901a\u9053\u7684\u65f6\u57df\u4fe1\u53f7\u6570\u636e</p> \u5fc5\u9700 <code>excitation_freq</code> <code>Optional[float]</code> <p>(\u53ef\u9009) \u6fc0\u52b1\u9891\u7387 (Hz)</p> <code>None</code> <code>file_name</code> <code>Optional[str]</code> <p>\u4fdd\u5b58\u7684\u6587\u4ef6\u540d (\u4e0d\u542b\u6269\u5c55\u540d)\uff0c\u82e5\u63d0\u4f9b\u5219\u4fdd\u5b58\u56fe\u7247</p> <code>None</code> <code>title</code> <code>Optional[str]</code> <p>\u56fe\u8868\u6807\u9898 (\u82f1\u6587)</p> <code>None</code> <code>peaks</code> <code>Optional[List[Dict[str, float]]]</code> <p>(\u53ef\u9009) \u5cf0\u503c\u5217\u8868\uff0c\u6bcf\u4e2a\u5cf0\u503c\u5305\u542b 'frequency' \u548c 'magnitude'</p> <code>None</code> <code>freq_range</code> <code>Optional[Tuple[float, float]]</code> <p>(\u53ef\u9009) \u9891\u7387\u8303\u56f4 (min_freq, max_freq)\uff0c\u7528\u4e8e\u9650\u5236\u663e\u793a\u7684\u9891\u7387\u8303\u56f4</p> <code>None</code> <code>db_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0cdB\u503c\u663e\u793a\u8303\u56f4 (min_db, max_db)</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Figure</code> <code>Any</code> <p>matplotlib \u56fe\u5f62\u5bf9\u8c61\uff0c\u53ef\u5728 Jupyter notebook \u4e2d\u663e\u793a</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def SpectrumPlot(\n    self,\n    data: np.ndarray,\n    excitation_freq: Optional[float] = None,\n    file_name: Optional[str] = None,\n    title: Optional[str] = None,\n    peaks: Optional[List[Dict[str, float]]] = None,\n    freq_range: Optional[Tuple[float, float]] = None,\n    db_range: Optional[Tuple[float, float]] = None,\n    ax: Optional[plt.Axes] = None,\n) -&gt; Any:\n    \"\"\"\u7ed8\u5236\u5e76\u4fdd\u5b58\u9891\u8c31\u56fe\n\n    Args:\n        data: \u4e00\u7ef4\u6570\u7ec4\uff0c\u5305\u542b\u5355\u4e2a\u901a\u9053\u7684\u65f6\u57df\u4fe1\u53f7\u6570\u636e\n        excitation_freq: (\u53ef\u9009) \u6fc0\u52b1\u9891\u7387 (Hz)\n        file_name: \u4fdd\u5b58\u7684\u6587\u4ef6\u540d (\u4e0d\u542b\u6269\u5c55\u540d)\uff0c\u82e5\u63d0\u4f9b\u5219\u4fdd\u5b58\u56fe\u7247\n        title: \u56fe\u8868\u6807\u9898 (\u82f1\u6587)\n        peaks: (\u53ef\u9009) \u5cf0\u503c\u5217\u8868\uff0c\u6bcf\u4e2a\u5cf0\u503c\u5305\u542b 'frequency' \u548c 'magnitude'\n        freq_range: (\u53ef\u9009) \u9891\u7387\u8303\u56f4 (min_freq, max_freq)\uff0c\u7528\u4e8e\u9650\u5236\u663e\u793a\u7684\u9891\u7387\u8303\u56f4\n        db_range: \u53ef\u9009\uff0cdB\u503c\u663e\u793a\u8303\u56f4 (min_db, max_db)\n\n    Returns:\n        Figure: matplotlib \u56fe\u5f62\u5bf9\u8c61\uff0c\u53ef\u5728 Jupyter notebook \u4e2d\u663e\u793a\n    \"\"\"\n    # \u6027\u80fd\u4f18\u5316\uff1a\u52a0\u5165\u6570\u636e\u9a8c\u8bc1\u524d\u7684\u5feb\u901f\u8def\u5f84\u68c0\u67e5\n    if data is None or len(data) == 0:\n        self.logger.error(\"\u8f93\u5165\u6570\u636e\u4e3a\u7a7a\")\n        return None\n\n    if not isinstance(data, np.ndarray) or data.ndim != 1:\n        self.logger.error(f\"\u6570\u636e\u5fc5\u987b\u662f\u4e00\u7ef4numpy\u6570\u7ec4\uff0c\u5f53\u524d\u7ef4\u5ea6: {data.ndim}\")\n        return None\n\n    # \u6027\u80fd\u4f18\u5316\uff1a\u4f7f\u7528 Welch \u65b9\u6cd5\u8ba1\u7b97\u9891\u8c31\uff0c\u6bd4\u76f4\u63a5 FFT \u66f4\u7a33\u5b9a\u4e14\u53ef\u80fd\u66f4\u5feb\n    from scipy import signal\n\n    # \u6839\u636e\u6570\u636e\u957f\u5ea6\u81ea\u52a8\u786e\u5b9a\u5408\u9002\u7684\u7a97\u53e3\u5927\u5c0f\u548c\u91cd\u53e0\u53c2\u6570\n    n = len(data)\n    if n &gt; 500000:  # \u5927\u4e8e50\u4e07\u70b9\u7684\u6570\u636e\n        nperseg = 8192  # \u4f7f\u7528\u8f83\u5927\u7684\u7a97\u53e3\u589e\u52a0\u9891\u7387\u5206\u8fa8\u7387\n        noverlap = nperseg // 2  # 50% \u91cd\u53e0\n    elif n &gt; 100000:  # 10\u4e07-50\u4e07\u70b9\u7684\u6570\u636e\n        nperseg = 4096\n        noverlap = nperseg // 2\n    else:  # \u8f83\u5c0f\u89c4\u6a21\u7684\u6570\u636e\n        nperseg = min(2048, n // 4)  # \u786e\u4fdd\u7a97\u53e3\u4e0d\u8d85\u8fc7\u6570\u636e\u957f\u5ea6\u76841/4\n        noverlap = nperseg // 2\n\n    # \u4f7f\u7528 Welch \u65b9\u6cd5\u8ba1\u7b97\u529f\u7387\u8c31\u5bc6\u5ea6 (PSD)\n    frequencies, psd = signal.welch(\n        data,\n        fs=self.fs,\n        window=\"hann\",\n        nperseg=nperseg,\n        noverlap=noverlap,\n        detrend=\"constant\",\n        scaling=\"spectrum\",  # \u4f7f\u7528 'spectrum' \u800c\u4e0d\u662f 'density' \u4ee5\u83b7\u5f97\u5e45\u5ea6\u8c31\n        average=\"mean\",  # \u5e73\u5747\u591a\u4e2a\u5206\u6bb5\u7684\u7ed3\u679c\n    )\n\n    # Welch \u8fd4\u56de\u529f\u7387\u8c31\u5bc6\u5ea6\uff0c\u6211\u4eec\u8ba1\u7b97\u5e45\u5ea6\u8c31\n    magnitudes = np.sqrt(psd)\n\n    # \u5982\u679c\u6307\u5b9a\u4e86\u9891\u7387\u8303\u56f4\uff0c\u5219\u8fc7\u6ee4\u6570\u636e\n    if freq_range is not None:\n        min_freq, max_freq = freq_range\n        mask = (frequencies &gt;= min_freq) &amp; (frequencies &lt;= max_freq)\n        frequencies = frequencies[mask]\n        magnitudes = magnitudes[mask]\n\n    # \u7ed8\u56fe\u524d\u542f\u7528agg\u540e\u7aef\u53ef\u4ee5\u63d0\u9ad8\u975e\u4ea4\u4e92\u5f0f\u7ed8\u56fe\u6027\u80fd\n    import matplotlib\n\n    prev_backend = matplotlib.get_backend()\n    if not self._in_jupyter:\n        matplotlib.use(\"agg\")  # \u975e\u4ea4\u4e92\u5f0f\u540e\u7aef\uff0c\u66f4\u5feb\n\n    # \u7ed8\u5236\u9891\u8c31\u56fe\n    fig = self.spectrum_plotter.plot(\n        frequencies,\n        magnitudes,\n        excitation_freq=excitation_freq,\n        title=title,\n        peaks=peaks,\n        db_range=db_range,\n        ax=ax,\n    )\n\n    # \u5982\u679c\u63d0\u4f9b\u4e86\u6587\u4ef6\u540d\uff0c\u5219\u4fdd\u5b58\u56fe\u7247\n    if file_name is not None:\n        freq_suffix = f\"_{excitation_freq:.0f}Hz\" if excitation_freq else \"\"\n        save_path = self.output_path / f\"{file_name}{freq_suffix}.png\"\n        self.spectrum_plotter.save_figure(save_path, close_after_save=False)\n\n    # \u8fd8\u539f\u540e\u7aef\n    if not self._in_jupyter:\n        matplotlib.use(prev_backend)\n\n    # \u5904\u7406\u56fe\u5f62\u663e\u793a\uff0c\u907f\u514d\u53cc\u91cd\u663e\u793a\n    return self._handle_figure_display(fig)\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASVisualizer.SpectrogramPlot","title":"SpectrogramPlot","text":"<pre><code>SpectrogramPlot(\n    data: ndarray,\n    window_size: int = 1024,\n    overlap: float = 0.75,\n    file_name: Optional[str] = None,\n    title: Optional[str] = None,\n    freq_range: Optional[Tuple[float, float]] = None,\n    time_range: Optional[Tuple[float, float]] = None,\n    cmap: str = \"viridis\",\n    ax: Optional[Axes] = None,\n) -&gt; Any\n</code></pre> <p>\u7ed8\u5236\u65f6\u9891\u56fe\uff08\u77ed\u65f6\u5085\u91cc\u53f6\u53d8\u6362\uff09</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u4e00\u7ef4\u6570\u7ec4\uff0c\u5305\u542b\u5355\u4e2a\u901a\u9053\u7684\u65f6\u57df\u6570\u636e</p> \u5fc5\u9700 <code>window_size</code> <code>int</code> <p>STFT\u7a97\u53e3\u5927\u5c0f</p> <code>1024</code> <code>overlap</code> <code>float</code> <p>\u7a97\u53e3\u91cd\u53e0\u6bd4\u4f8b</p> <code>0.75</code> <code>file_name</code> <code>Optional[str]</code> <p>\u4fdd\u5b58\u7684\u6587\u4ef6\u540d (\u4e0d\u542b\u6269\u5c55\u540d)\uff0c\u82e5\u63d0\u4f9b\u5219\u4fdd\u5b58\u56fe\u7247</p> <code>None</code> <code>title</code> <code>Optional[str]</code> <p>\u56fe\u8868\u6807\u9898 (\u82f1\u6587)</p> <code>None</code> <code>freq_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0c\u9891\u7387\u8303\u56f4 (min_freq, max_freq)</p> <code>None</code> <code>time_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0c\u65f6\u95f4\u8303\u56f4 (start_time, end_time)</p> <code>None</code> <code>cmap</code> <code>str</code> <p>\u8272\u5f69\u6620\u5c04\u540d\u79f0</p> <code>'viridis'</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Figure</code> <code>Any</code> <p>matplotlib \u56fe\u5f62\u5bf9\u8c61\uff0c\u53ef\u5728 Jupyter notebook \u4e2d\u663e\u793a</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def SpectrogramPlot(\n    self,\n    data: np.ndarray,\n    window_size: int = 1024,\n    overlap: float = 0.75,\n    file_name: Optional[str] = None,\n    title: Optional[str] = None,\n    freq_range: Optional[Tuple[float, float]] = None,\n    time_range: Optional[Tuple[float, float]] = None,\n    cmap: str = \"viridis\",\n    ax: Optional[plt.Axes] = None,\n) -&gt; Any:\n    \"\"\"\u7ed8\u5236\u65f6\u9891\u56fe\uff08\u77ed\u65f6\u5085\u91cc\u53f6\u53d8\u6362\uff09\n\n    Args:\n        data: \u4e00\u7ef4\u6570\u7ec4\uff0c\u5305\u542b\u5355\u4e2a\u901a\u9053\u7684\u65f6\u57df\u6570\u636e\n        window_size: STFT\u7a97\u53e3\u5927\u5c0f\n        overlap: \u7a97\u53e3\u91cd\u53e0\u6bd4\u4f8b\n        file_name: \u4fdd\u5b58\u7684\u6587\u4ef6\u540d (\u4e0d\u542b\u6269\u5c55\u540d)\uff0c\u82e5\u63d0\u4f9b\u5219\u4fdd\u5b58\u56fe\u7247\n        title: \u56fe\u8868\u6807\u9898 (\u82f1\u6587)\n        freq_range: \u53ef\u9009\uff0c\u9891\u7387\u8303\u56f4 (min_freq, max_freq)\n        time_range: \u53ef\u9009\uff0c\u65f6\u95f4\u8303\u56f4 (start_time, end_time)\n        cmap: \u8272\u5f69\u6620\u5c04\u540d\u79f0\n\n    Returns:\n        Figure: matplotlib \u56fe\u5f62\u5bf9\u8c61\uff0c\u53ef\u5728 Jupyter notebook \u4e2d\u663e\u793a\n    \"\"\"\n    # \u6027\u80fd\u4f18\u5316\uff1a\u52a0\u5165\u6570\u636e\u9a8c\u8bc1\u524d\u7684\u5feb\u901f\u8def\u5f84\u68c0\u67e5\n    if data is None or len(data) == 0:\n        self.logger.error(\"\u8f93\u5165\u6570\u636e\u4e3a\u7a7a\")\n        return None\n\n    if not isinstance(data, np.ndarray) or data.ndim != 1:\n        self.logger.error(f\"\u6570\u636e\u5fc5\u987b\u662f\u4e00\u7ef4numpy\u6570\u7ec4\uff0c\u5f53\u524d\u7ef4\u5ea6: {data.ndim}\")\n        return None\n\n    # \u6027\u80fd\u4f18\u5316\uff1a\u81ea\u52a8\u8c03\u6574\u5927\u6570\u636e\u7684\u7a97\u53e3\u5927\u5c0f\u548c\u91cd\u53e0\u6bd4\u4f8b\n    data_length = len(data)\n    # \u5bf9\u4e8e\u8d85\u957f\u6570\u636e\uff0c\u81ea\u52a8\u8c03\u6574\u4e3a\u66f4\u5408\u7406\u7684\u53c2\u6570\n    if data_length &gt; 500000:  # 50\u4e07\u4ee5\u4e0a\u6570\u636e\u70b9\n        if window_size &lt; 2048:\n            window_size = 2048  # \u589e\u52a0\u7a97\u53e3\u5927\u5c0f\n        if overlap &gt; 0.5:\n            overlap = 0.5  # \u51cf\u5c11\u91cd\u53e0\n\n    # \u7ed8\u56fe\u524d\u542f\u7528agg\u540e\u7aef\u53ef\u4ee5\u63d0\u9ad8\u975e\u4ea4\u4e92\u5f0f\u7ed8\u56fe\u6027\u80fd\n    import matplotlib\n\n    prev_backend = matplotlib.get_backend()\n    if not self._in_jupyter:\n        matplotlib.use(\"agg\")  # \u975e\u4ea4\u4e92\u5f0f\u540e\u7aef\uff0c\u66f4\u5feb\n\n    # \u7ed8\u5236\u65f6\u9891\u56fe\n    fig = self.spectrogram_plotter.plot(\n        data,\n        self.fs,\n        window_size=window_size,\n        overlap=overlap,\n        title=title,\n        freq_range=freq_range,\n        time_range=time_range,\n        cmap=cmap,\n        ax=ax,\n    )\n\n    # \u5982\u679c\u63d0\u4f9b\u4e86\u6587\u4ef6\u540d\uff0c\u5219\u4fdd\u5b58\u56fe\u7247\n    if file_name is not None:\n        save_path = self.output_path / f\"{file_name}.png\"\n        self.spectrogram_plotter.save_figure(save_path, close_after_save=False)\n\n    # \u8fd8\u539f\u540e\u7aef\n    if not self._in_jupyter:\n        matplotlib.use(prev_backend)\n\n    # \u5904\u7406\u56fe\u5f62\u663e\u793a\uff0c\u907f\u514d\u53cc\u91cd\u663e\u793a\n    return self._handle_figure_display(fig)\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.DASVisualizer.WaterfallPlot","title":"WaterfallPlot","text":"<pre><code>WaterfallPlot(\n    data: ndarray,\n    x_label: str = \"Channels\",\n    y_label: str = \"Time (s)\",\n    file_name: Optional[str] = None,\n    title: Optional[str] = None,\n    cmap: str = \"viridis\",\n    colorbar_label: str = \"Amplitude\",\n    aspect: str = \"auto\",\n    origin: str = \"upper\",\n    x_ticks: Optional[ndarray] = None,\n    y_ticks: Optional[ndarray] = None,\n    value_range: Optional[Tuple[float, float]] = None,\n    ax: Optional[Axes] = None,\n) -&gt; Any\n</code></pre> <p>\u7ed8\u5236\u7011\u5e03\u56fe\uff08\u4e8c\u7ef4\u6570\u636e\u53ef\u89c6\u5316\uff09</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u4e8c\u7ef4\u6570\u7ec4\uff0c\u5f62\u72b6\u4e3a (time_samples, channels) \u6216 (channels, time_samples)</p> \u5fc5\u9700 <code>x_label</code> <code>str</code> <p>X\u8f74\u6807\u7b7e</p> <code>'Channels'</code> <code>y_label</code> <code>str</code> <p>Y\u8f74\u6807\u7b7e</p> <code>'Time (s)'</code> <code>file_name</code> <code>Optional[str]</code> <p>\u4fdd\u5b58\u7684\u6587\u4ef6\u540d (\u4e0d\u542b\u6269\u5c55\u540d)\uff0c\u82e5\u63d0\u4f9b\u5219\u4fdd\u5b58\u56fe\u7247</p> <code>None</code> <code>title</code> <code>Optional[str]</code> <p>\u81ea\u5b9a\u4e49\u6807\u9898 (\u82f1\u6587)</p> <code>None</code> <code>cmap</code> <code>str</code> <p>\u8272\u5f69\u6620\u5c04\u540d\u79f0</p> <code>'viridis'</code> <code>colorbar_label</code> <code>str</code> <p>\u989c\u8272\u6761\u6807\u7b7e</p> <code>'Amplitude'</code> <code>aspect</code> <code>str</code> <p>\u56fe\u50cf\u7eb5\u6a2a\u6bd4\uff0c'auto' \u6216 'equal'</p> <code>'auto'</code> <code>origin</code> <code>str</code> <p>\u6570\u636e\u539f\u70b9\u4f4d\u7f6e\uff0c'upper' \u6216 'lower'</p> <code>'upper'</code> <code>x_ticks</code> <code>Optional[ndarray]</code> <p>\u53ef\u9009\uff0cX\u8f74\u523b\u5ea6\u503c</p> <code>None</code> <code>y_ticks</code> <code>Optional[ndarray]</code> <p>\u53ef\u9009\uff0cY\u8f74\u523b\u5ea6\u503c</p> <code>None</code> <code>value_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0c\u6570\u636e\u503c\u663e\u793a\u8303\u56f4 (min_value, max_value)</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Figure</code> <code>Any</code> <p>matplotlib \u56fe\u5f62\u5bf9\u8c61\uff0c\u53ef\u5728 Jupyter notebook \u4e2d\u663e\u793a</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def WaterfallPlot(\n    self,\n    data: np.ndarray,\n    x_label: str = \"Channels\",\n    y_label: str = \"Time (s)\",\n    file_name: Optional[str] = None,\n    title: Optional[str] = None,\n    cmap: str = \"viridis\",\n    colorbar_label: str = \"Amplitude\",\n    aspect: str = \"auto\",\n    origin: str = \"upper\",\n    x_ticks: Optional[np.ndarray] = None,\n    y_ticks: Optional[np.ndarray] = None,\n    value_range: Optional[Tuple[float, float]] = None,\n    ax: Optional[plt.Axes] = None,\n) -&gt; Any:\n    \"\"\"\u7ed8\u5236\u7011\u5e03\u56fe\uff08\u4e8c\u7ef4\u6570\u636e\u53ef\u89c6\u5316\uff09\n\n    Args:\n        data: \u4e8c\u7ef4\u6570\u7ec4\uff0c\u5f62\u72b6\u4e3a (time_samples, channels) \u6216 (channels, time_samples)\n        x_label: X\u8f74\u6807\u7b7e\n        y_label: Y\u8f74\u6807\u7b7e\n        file_name: \u4fdd\u5b58\u7684\u6587\u4ef6\u540d (\u4e0d\u542b\u6269\u5c55\u540d)\uff0c\u82e5\u63d0\u4f9b\u5219\u4fdd\u5b58\u56fe\u7247\n        title: \u81ea\u5b9a\u4e49\u6807\u9898 (\u82f1\u6587)\n        cmap: \u8272\u5f69\u6620\u5c04\u540d\u79f0\n        colorbar_label: \u989c\u8272\u6761\u6807\u7b7e\n        aspect: \u56fe\u50cf\u7eb5\u6a2a\u6bd4\uff0c'auto' \u6216 'equal'\n        origin: \u6570\u636e\u539f\u70b9\u4f4d\u7f6e\uff0c'upper' \u6216 'lower'\n        x_ticks: \u53ef\u9009\uff0cX\u8f74\u523b\u5ea6\u503c\n        y_ticks: \u53ef\u9009\uff0cY\u8f74\u523b\u5ea6\u503c\n        value_range: \u53ef\u9009\uff0c\u6570\u636e\u503c\u663e\u793a\u8303\u56f4 (min_value, max_value)\n\n    Returns:\n        Figure: matplotlib \u56fe\u5f62\u5bf9\u8c61\uff0c\u53ef\u5728 Jupyter notebook \u4e2d\u663e\u793a\n    \"\"\"\n    # \u6570\u636e\u9a8c\u8bc1\n    if data is None or data.size == 0:\n        self.logger.error(\"\u8f93\u5165\u6570\u636e\u4e3a\u7a7a\")\n        return None\n\n    if not isinstance(data, np.ndarray) or data.ndim != 2:\n        self.logger.error(f\"\u6570\u636e\u5fc5\u987b\u662f\u4e8c\u7ef4numpy\u6570\u7ec4\uff0c\u5f53\u524d\u7ef4\u5ea6: {data.ndim}\")\n        return None\n\n    # \u7ed8\u56fe\u524d\u542f\u7528agg\u540e\u7aef\u53ef\u4ee5\u63d0\u9ad8\u975e\u4ea4\u4e92\u5f0f\u7ed8\u56fe\u6027\u80fd\n    import matplotlib\n\n    prev_backend = matplotlib.get_backend()\n    if not self._in_jupyter:\n        matplotlib.use(\"agg\")  # \u975e\u4ea4\u4e92\u5f0f\u540e\u7aef\uff0c\u66f4\u5feb\n\n    # \u7ed8\u5236\u7011\u5e03\u56fe\n    fig = self.waterfall_plotter.plot(\n        data=data,\n        fs=self.fs,\n        x_label=x_label,\n        y_label=y_label,\n        title=title,\n        cmap=cmap,\n        colorbar_label=colorbar_label,\n        aspect=aspect,\n        origin=origin,\n        x_ticks=x_ticks,\n        y_ticks=y_ticks,\n        value_range=value_range,\n        ax=ax,\n    )\n\n    # \u5982\u679c\u63d0\u4f9b\u4e86\u6587\u4ef6\u540d\uff0c\u5219\u4fdd\u5b58\u56fe\u7247\n    if file_name is not None:\n        save_path = self.output_path / f\"{file_name}.png\"\n        self.waterfall_plotter.save_figure(save_path, close_after_save=False)\n\n    # \u8fd8\u539f\u540e\u7aef\n    if not self._in_jupyter:\n        matplotlib.use(prev_backend)\n\n    # \u5904\u7406\u56fe\u5f62\u663e\u793a\uff0c\u907f\u514d\u53cc\u91cd\u663e\u793a\n    return self._handle_figure_display(fig)\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.from_array","title":"from_array","text":"<pre><code>from_array(\n    data: ndarray, fs: float, **kwargs: Any\n) -&gt; DASFrame\n</code></pre> <p>\u4eceNumPy\u6570\u7ec4\u521b\u5efaDASFrame\u5bf9\u8c61\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>DAS\u6570\u636e\u6570\u7ec4\uff0c\u5f62\u72b6\u4e3a(\u65f6\u95f4\u70b9\u6570, \u901a\u9053\u6570)</p> \u5fc5\u9700 <code>fs</code> <code>float</code> <p>\u91c7\u6837\u9891\u7387(Hz)</p> \u5fc5\u9700 <code>**kwargs</code> <code>Any</code> <p>\u5176\u4ed6\u5143\u6570\u636e</p> <code>{}</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>DASFrame</code> <code>DASFrame</code> <p>\u5305\u542b\u6570\u636e\u7684DASFrame\u5bf9\u8c61</p> <p>\u793a\u4f8b\uff1a</p> <pre><code>&gt;&gt;&gt; import numpy as np\n&gt;&gt;&gt; from DASMatrix.api import df\n&gt;&gt;&gt; data = np.random.randn(10000, 64)\n&gt;&gt;&gt; frame = df.from_array(data, fs=10000)\n</code></pre> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/df.py</code> <pre><code>def from_array(data: np.ndarray, fs: float, **kwargs: Any) -&gt; \"DASFrame\":\n    \"\"\"\u4eceNumPy\u6570\u7ec4\u521b\u5efaDASFrame\u5bf9\u8c61\u3002\n\n    Args:\n        data: DAS\u6570\u636e\u6570\u7ec4\uff0c\u5f62\u72b6\u4e3a(\u65f6\u95f4\u70b9\u6570, \u901a\u9053\u6570)\n        fs: \u91c7\u6837\u9891\u7387(Hz)\n        **kwargs: \u5176\u4ed6\u5143\u6570\u636e\n\n    Returns:\n        DASFrame: \u5305\u542b\u6570\u636e\u7684DASFrame\u5bf9\u8c61\n\n    Examples:\n        &gt;&gt;&gt; import numpy as np\n        &gt;&gt;&gt; from DASMatrix.api import df\n        &gt;&gt;&gt; data = np.random.randn(10000, 64)\n        &gt;&gt;&gt; frame = df.from_array(data, fs=10000)\n    \"\"\"\n    if data.ndim == 1:\n        data = data.reshape(-1, 1)\n\n    return _create_dasframe(data, fs=fs, **kwargs)\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.read","title":"read","text":"<pre><code>read(\n    path: str,\n    fs: Optional[float] = None,\n    channels: Optional[int] = None,\n    byte_order: str = \"little\",\n    **kwargs: Any,\n) -&gt; DASFrame\n</code></pre> <p>\u4ece\u6587\u4ef6\u8bfb\u53d6DAS\u6570\u636e\uff0c\u8fd4\u56deDASFrame\u5bf9\u8c61\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>path</code> <code>str</code> <p>\u6570\u636e\u6587\u4ef6\u8def\u5f84</p> \u5fc5\u9700 <code>fs</code> <code>Optional[float]</code> <p>\u91c7\u6837\u9891\u7387(Hz)\uff0cH5\u6587\u4ef6\u53ef\u81ea\u52a8\u68c0\u6d4b\uff0cDAT\u6587\u4ef6\u5fc5\u987b\u6307\u5b9a</p> <code>None</code> <code>channels</code> <code>Optional[int]</code> <p>\u901a\u9053\u6570\uff0cH5\u6587\u4ef6\u53ef\u81ea\u52a8\u68c0\u6d4b\uff0cDAT\u6587\u4ef6\u5fc5\u987b\u6307\u5b9a</p> <code>None</code> <code>byte_order</code> <code>str</code> <p>\u5b57\u8282\u5e8f\uff0c'big' \u6216 'little'\uff0c\u4ec5\u7528\u4e8e DAT \u6587\u4ef6</p> <code>'little'</code> <code>**kwargs</code> <code>Any</code> <p>\u4f20\u9012\u7ed9 DASFrame \u7684\u5176\u4ed6\u5143\u6570\u636e</p> <code>{}</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>DASFrame</code> <code>DASFrame</code> <p>\u5305\u542bDAS\u6570\u636e\u7684DASFrame\u5bf9\u8c61</p> <p>\u793a\u4f8b\uff1a</p> <pre><code>&gt;&gt;&gt; # \u8bfb\u53d6 H5 \u6587\u4ef6\uff08\u81ea\u52a8\u68c0\u6d4b\u53c2\u6570\uff09\n&gt;&gt;&gt; frame = df.read(\"data.h5\")\n</code></pre> <pre><code>&gt;&gt;&gt; # \u8bfb\u53d6 DAT \u6587\u4ef6\uff08\u9700\u8981\u6307\u5b9a\u53c2\u6570\uff09\n&gt;&gt;&gt; frame = df.read(\"data.dat\", fs=10000, channels=512)\n</code></pre> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/df.py</code> <pre><code>def read(\n    path: str,\n    fs: Optional[float] = None,\n    channels: Optional[int] = None,\n    byte_order: str = \"little\",\n    **kwargs: Any,\n) -&gt; \"DASFrame\":\n    \"\"\"\u4ece\u6587\u4ef6\u8bfb\u53d6DAS\u6570\u636e\uff0c\u8fd4\u56deDASFrame\u5bf9\u8c61\u3002\n\n    Args:\n        path: \u6570\u636e\u6587\u4ef6\u8def\u5f84\n        fs: \u91c7\u6837\u9891\u7387(Hz)\uff0cH5\u6587\u4ef6\u53ef\u81ea\u52a8\u68c0\u6d4b\uff0cDAT\u6587\u4ef6\u5fc5\u987b\u6307\u5b9a\n        channels: \u901a\u9053\u6570\uff0cH5\u6587\u4ef6\u53ef\u81ea\u52a8\u68c0\u6d4b\uff0cDAT\u6587\u4ef6\u5fc5\u987b\u6307\u5b9a\n        byte_order: \u5b57\u8282\u5e8f\uff0c'big' \u6216 'little'\uff0c\u4ec5\u7528\u4e8e DAT \u6587\u4ef6\n        **kwargs: \u4f20\u9012\u7ed9 DASFrame \u7684\u5176\u4ed6\u5143\u6570\u636e\n\n    Returns:\n        DASFrame: \u5305\u542bDAS\u6570\u636e\u7684DASFrame\u5bf9\u8c61\n\n    Examples:\n        &gt;&gt;&gt; # \u8bfb\u53d6 H5 \u6587\u4ef6\uff08\u81ea\u52a8\u68c0\u6d4b\u53c2\u6570\uff09\n        &gt;&gt;&gt; frame = df.read(\"data.h5\")\n\n        &gt;&gt;&gt; # \u8bfb\u53d6 DAT \u6587\u4ef6\uff08\u9700\u8981\u6307\u5b9a\u53c2\u6570\uff09\n        &gt;&gt;&gt; frame = df.read(\"data.dat\", fs=10000, channels=512)\n    \"\"\"\n    ext = os.path.splitext(path)[1].lower()\n\n    if ext in (\".h5\", \".hdf5\"):\n        return _read_h5(path, fs=fs, **kwargs)\n    elif ext == \".dat\":\n        if fs is None or channels is None:\n            raise ValueError(\n                \"\u8bfb\u53d6 DAT \u6587\u4ef6\u9700\u8981\u6307\u5b9a fs\uff08\u91c7\u6837\u9891\u7387\uff09\u548c channels\uff08\u901a\u9053\u6570\uff09\u53c2\u6570\"\n            )\n        return _read_dat(\n            path, fs=fs, channels=channels, byte_order=byte_order, **kwargs\n        )\n    else:\n        raise ValueError(f\"\u4e0d\u652f\u6301\u7684\u6587\u4ef6\u7c7b\u578b: {ext}\")\n</code></pre>"},{"location":"reference/DASMatrix/#DASMatrix.stream","title":"stream","text":"<pre><code>stream(\n    url: str,\n    chunk: int = 1024,\n    fs: float = 10000.0,\n    **kwargs: Any,\n) -&gt; DASFrame\n</code></pre> <p>\u521b\u5efa\u7528\u4e8e\u6d41\u5f0f\u5904\u7406\u7684DASFrame\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>url</code> <code>str</code> <p>\u6570\u636e\u6d41URL\uff0c\u4f8b\u5982 \"tcp://0.0.0.0:9000\"</p> \u5fc5\u9700 <code>chunk</code> <code>int</code> <p>\u6bcf\u6b21\u5904\u7406\u7684\u6570\u636e\u5757\u5927\u5c0f</p> <code>1024</code> <code>fs</code> <code>float</code> <p>\u9884\u671f\u7684\u91c7\u6837\u9891\u7387(Hz)</p> <code>10000.0</code> <code>**kwargs</code> <code>Any</code> <p>\u5176\u4ed6\u53c2\u6570</p> <code>{}</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>DASFrame</code> <code>DASFrame</code> <p>\u7528\u4e8e\u6d41\u5904\u7406\u7684DASFrame\u5bf9\u8c61</p> Note <p>\u5f53\u524d\u4e3a\u5360\u4f4d\u5b9e\u73b0\uff0c\u6d41\u5904\u7406\u529f\u80fd\u5c06\u5728\u540e\u7eed\u7248\u672c\u4e2d\u5b8c\u5584\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/df.py</code> <pre><code>def stream(\n    url: str, chunk: int = 1024, fs: float = 10000.0, **kwargs: Any\n) -&gt; \"DASFrame\":\n    \"\"\"\u521b\u5efa\u7528\u4e8e\u6d41\u5f0f\u5904\u7406\u7684DASFrame\u3002\n\n    Args:\n        url: \u6570\u636e\u6d41URL\uff0c\u4f8b\u5982 \"tcp://0.0.0.0:9000\"\n        chunk: \u6bcf\u6b21\u5904\u7406\u7684\u6570\u636e\u5757\u5927\u5c0f\n        fs: \u9884\u671f\u7684\u91c7\u6837\u9891\u7387(Hz)\n        **kwargs: \u5176\u4ed6\u53c2\u6570\n\n    Returns:\n        DASFrame: \u7528\u4e8e\u6d41\u5904\u7406\u7684DASFrame\u5bf9\u8c61\n\n    Note:\n        \u5f53\u524d\u4e3a\u5360\u4f4d\u5b9e\u73b0\uff0c\u6d41\u5904\u7406\u529f\u80fd\u5c06\u5728\u540e\u7eed\u7248\u672c\u4e2d\u5b8c\u5584\u3002\n    \"\"\"\n    # TODO: \u5b9e\u73b0\u771f\u6b63\u7684\u6d41\u5904\u7406\n    return _create_dasframe(\n        np.array([]).reshape(0, 1),\n        fs=fs,\n        is_stream=True,\n        stream_url=url,\n        chunk_size=chunk,\n        **kwargs,\n    )\n</code></pre>"},{"location":"reference/DASMatrix/acquisition/","title":"acquisition","text":""},{"location":"reference/DASMatrix/acquisition/#DASMatrix.acquisition","title":"acquisition","text":"<p>DASMatrix \u6570\u636e\u83b7\u53d6\u6a21\u5757\u3002</p> <p>\u63d0\u4f9b\u591a\u79cd DAS \u6570\u636e\u683c\u5f0f\u7684\u8bfb\u53d6\u529f\u80fd\u3002</p>"},{"location":"reference/DASMatrix/acquisition/#DASMatrix.acquisition.DASReader","title":"DASReader","text":"<pre><code>DASReader(\n    sampling_config: SamplingConfig,\n    data_type: DataType = DataType.DAT,\n)\n</code></pre> <p>\u6570\u636e\u8bfb\u53d6\u5668\u7c7b, \u7528\u4e8e\u8bfb\u53d6\u4e0d\u540c\u683c\u5f0f\u7684\u6570\u636e\u6587\u4ef6</p> <p>\u521d\u59cb\u5316\u6570\u636e\u8bfb\u53d6\u5668</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>sampling_config</code> <code>SamplingConfig</code> <p>\u91c7\u6837\u914d\u7f6e\u5bf9\u8c61</p> \u5fc5\u9700 <code>data_type</code> <code>DataType</code> <p>\u6570\u636e\u7c7b\u578b\uff0c\u9ed8\u8ba4\u4e3aDAT\u683c\u5f0f</p> <code>DAT</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/acquisition/das_reader.py</code> <pre><code>def __init__(\n    self, sampling_config: SamplingConfig, data_type: DataType = DataType.DAT\n):\n    \"\"\"\u521d\u59cb\u5316\u6570\u636e\u8bfb\u53d6\u5668\n\n    Args:\n        sampling_config: \u91c7\u6837\u914d\u7f6e\u5bf9\u8c61\n        data_type: \u6570\u636e\u7c7b\u578b\uff0c\u9ed8\u8ba4\u4e3aDAT\u683c\u5f0f\n    \"\"\"\n    self.sampling_config = sampling_config\n    self.reader: DataReader\n    self.data_type = data_type\n    self.logger = logging.getLogger(__name__)\n\n    # \u6839\u636e\u6570\u636e\u7c7b\u578b\u9009\u62e9\u5408\u9002\u7684\u8bfb\u53d6\u5668\n    if data_type == DataType.DAT:\n        self.reader = DATReader(sampling_config)\n    elif data_type == DataType.H5:\n        self.reader = H5Reader(sampling_config)\n    elif data_type == DataType.SEGY:\n        self.reader = SEGYReader(sampling_config)\n    elif data_type == DataType.MINISEED:\n        self.reader = MiniSEEDReader(sampling_config)\n    else:\n        raise ValueError(f\"\u4e0d\u652f\u6301\u7684\u6570\u636e\u7c7b\u578b: {data_type}\")\n</code></pre>"},{"location":"reference/DASMatrix/acquisition/#DASMatrix.acquisition.DASReader.ReadRawData","title":"ReadRawData","text":"<pre><code>ReadRawData(\n    file_path: Path, target_col: Optional[List[int]] = None\n) -&gt; Union[np.ndarray, da.Array]\n</code></pre> <p>\u8bfb\u53d6\u6307\u5b9a\u8def\u5f84\u7684\u6570\u636e\u6587\u4ef6</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>file_path</code> <code>Path</code> <p>\u6570\u636e\u6587\u4ef6\u8def\u5f84</p> \u5fc5\u9700 <code>target_col</code> <code>Optional[List[int]]</code> <p>\u76ee\u6807\u5217\u7d22\u5f15\u5217\u8868</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Union[ndarray, Array]</code> <p>np.ndarray: \u5305\u542b\u539f\u59cb\u6570\u636e\u7684 NumPy \u6570\u7ec4</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/acquisition/das_reader.py</code> <pre><code>def ReadRawData(\n    self, file_path: Path, target_col: Optional[List[int]] = None\n) -&gt; Union[np.ndarray, \"da.Array\"]:\n    \"\"\"\u8bfb\u53d6\u6307\u5b9a\u8def\u5f84\u7684\u6570\u636e\u6587\u4ef6\n\n    Args:\n        file_path: \u6570\u636e\u6587\u4ef6\u8def\u5f84\n        target_col: \u76ee\u6807\u5217\u7d22\u5f15\u5217\u8868\n\n    Returns:\n        np.ndarray: \u5305\u542b\u539f\u59cb\u6570\u636e\u7684 NumPy \u6570\u7ec4\n    \"\"\"\n    try:\n        # \u8bfb\u53d6\u539f\u59cb\u6570\u636e\n        raw_data = self.reader.ReadRawData(file_path, target_col)\n        return raw_data\n    except Exception as e:\n        self.logger.error(f\"\u8bfb\u53d6\u6570\u636e\u65f6\u53d1\u751f\u9519\u8bef: {e}\uff0c\u6587\u4ef6\u8def\u5f84: {file_path}\")\n        raise\n</code></pre>"},{"location":"reference/DASMatrix/acquisition/#DASMatrix.acquisition.DataReader","title":"DataReader","text":"<pre><code>DataReader(sampling_config: SamplingConfig)\n</code></pre> <p>               Bases: <code>ABC</code></p> <p>\u62bd\u8c61\u6570\u636e\u8bfb\u53d6\u5668\u57fa\u7c7b</p> <p>\u521d\u59cb\u5316\u6570\u636e\u8bfb\u53d6\u5668</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>sampling_config</code> <code>SamplingConfig</code> <p>\u91c7\u6837\u914d\u7f6e\u5bf9\u8c61\uff0c\u5305\u542b\u91c7\u6837\u9891\u7387\u3001\u901a\u9053\u6570\u7b49\u4fe1\u606f</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/acquisition/das_reader.py</code> <pre><code>def __init__(self, sampling_config: SamplingConfig):\n    \"\"\"\u521d\u59cb\u5316\u6570\u636e\u8bfb\u53d6\u5668\n\n    Args:\n        sampling_config: \u91c7\u6837\u914d\u7f6e\u5bf9\u8c61\uff0c\u5305\u542b\u91c7\u6837\u9891\u7387\u3001\u901a\u9053\u6570\u7b49\u4fe1\u606f\n    \"\"\"\n    self.sampling_config = sampling_config\n    self.logger = logging.getLogger(__name__)\n</code></pre>"},{"location":"reference/DASMatrix/acquisition/#DASMatrix.acquisition.DataReader.ReadRawData","title":"ReadRawData  <code>abstractmethod</code>","text":"<pre><code>ReadRawData(\n    file_path: Path, target_col: Optional[List[int]] = None\n) -&gt; Union[np.ndarray, da.Array]\n</code></pre> <p>\u8bfb\u53d6\u539f\u59cb\u6570\u636e</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>file_path</code> <code>Path</code> <p>\u6570\u636e\u6587\u4ef6\u8def\u5f84</p> \u5fc5\u9700 <code>target_col</code> <code>Optional[List[int]]</code> <p>\u76ee\u6807\u5217\u7d22\u5f15\u5217\u8868\uff0c\u5982 [21,22,249,251]\uff0c\u6307\u5b9a\u8981\u5904\u7406\u7684\u975e\u8fde\u7eed\u5217</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Union[ndarray, Array]</code> <p>Union[np.ndarray, da.Array]: \u8bfb\u53d6\u7684\u539f\u59cb\u6570\u636e</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/acquisition/das_reader.py</code> <pre><code>@abstractmethod\ndef ReadRawData(\n    self, file_path: Path, target_col: Optional[List[int]] = None\n) -&gt; Union[np.ndarray, \"da.Array\"]:\n    \"\"\"\u8bfb\u53d6\u539f\u59cb\u6570\u636e\n\n    Args:\n        file_path: \u6570\u636e\u6587\u4ef6\u8def\u5f84\n        target_col: \u76ee\u6807\u5217\u7d22\u5f15\u5217\u8868\uff0c\u5982 [21,22,249,251]\uff0c\u6307\u5b9a\u8981\u5904\u7406\u7684\u975e\u8fde\u7eed\u5217\n\n    Returns:\n        Union[np.ndarray, da.Array]: \u8bfb\u53d6\u7684\u539f\u59cb\u6570\u636e\n    \"\"\"\n    pass\n</code></pre>"},{"location":"reference/DASMatrix/acquisition/#DASMatrix.acquisition.DataReader.ValidateFile","title":"ValidateFile","text":"<pre><code>ValidateFile(file_path: Path) -&gt; None\n</code></pre> <p>\u9a8c\u8bc1\u6587\u4ef6\u662f\u5426\u5b58\u5728\u4e14\u53ef\u8bfb</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>file_path</code> <code>Path</code> <p>\u6570\u636e\u6587\u4ef6\u8def\u5f84</p> \u5fc5\u9700 <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>FileNotFoundError</code> <p>\u6587\u4ef6\u4e0d\u5b58\u5728</p> <code>PermissionError</code> <p>\u65e0\u6cd5\u8bfb\u53d6\u6587\u4ef6</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/acquisition/das_reader.py</code> <pre><code>def ValidateFile(self, file_path: Path) -&gt; None:\n    \"\"\"\u9a8c\u8bc1\u6587\u4ef6\u662f\u5426\u5b58\u5728\u4e14\u53ef\u8bfb\n\n    Args:\n        file_path: \u6570\u636e\u6587\u4ef6\u8def\u5f84\n\n    Raises:\n        FileNotFoundError: \u6587\u4ef6\u4e0d\u5b58\u5728\n        PermissionError: \u65e0\u6cd5\u8bfb\u53d6\u6587\u4ef6\n    \"\"\"\n    if not isinstance(file_path, Path):\n        file_path = Path(file_path)\n        self.logger.debug(f\"\u5c06\u6587\u4ef6\u8def\u5f84\u8f6c\u6362\u4e3a Path \u5bf9\u8c61: {file_path}\")\n\n    if not file_path.exists():\n        raise FileNotFoundError(f\"\u6587\u4ef6\u4e0d\u5b58\u5728: {file_path}\")\n\n    if not file_path.is_file():\n        raise ValueError(f\"\u8def\u5f84\u4e0d\u662f\u6587\u4ef6: {file_path}\")\n\n    if not os.access(file_path, os.R_OK):\n        raise PermissionError(f\"\u65e0\u6cd5\u8bfb\u53d6\u6587\u4ef6: {file_path}\")\n</code></pre>"},{"location":"reference/DASMatrix/acquisition/#DASMatrix.acquisition.DataType","title":"DataType","text":"<p>               Bases: <code>Enum</code></p> <p>\u6570\u636e\u7c7b\u578b\u679a\u4e3e\u7c7b</p>"},{"location":"reference/DASMatrix/acquisition/#DASMatrix.acquisition.DATReader","title":"DATReader","text":"<pre><code>DATReader(sampling_config: SamplingConfig)\n</code></pre> <p>               Bases: <code>DataReader</code></p> <p>DAT\u683c\u5f0f\u6570\u636e\u8bfb\u53d6\u5668</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/acquisition/das_reader.py</code> <pre><code>def __init__(self, sampling_config: SamplingConfig):\n    \"\"\"\u521d\u59cb\u5316\u6570\u636e\u8bfb\u53d6\u5668\n\n    Args:\n        sampling_config: \u91c7\u6837\u914d\u7f6e\u5bf9\u8c61\uff0c\u5305\u542b\u91c7\u6837\u9891\u7387\u3001\u901a\u9053\u6570\u7b49\u4fe1\u606f\n    \"\"\"\n    self.sampling_config = sampling_config\n    self.logger = logging.getLogger(__name__)\n</code></pre>"},{"location":"reference/DASMatrix/acquisition/#DASMatrix.acquisition.DATReader.ReadRawData","title":"ReadRawData","text":"<pre><code>ReadRawData(\n    file_path: Path, target_col: Optional[List[int]] = None\n) -&gt; Union[np.ndarray, da.Array]\n</code></pre> <p>\u8bfb\u53d6DAT\u683c\u5f0f\u7684\u539f\u59cb\u6570\u636e</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>file_path</code> <code>Path</code> <p>\u6570\u636e\u6587\u4ef6\u8def\u5f84</p> \u5fc5\u9700 <code>target_col</code> <code>Optional[List[int]]</code> <p>\u76ee\u6807\u5217\u7d22\u5f15\u5217\u8868\uff0c\u5982 [21,22,249,251]\uff0c\u6307\u5b9a\u8981\u5904\u7406\u7684\u975e\u8fde\u7eed\u5217</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Union[ndarray, Array]</code> <p>np.ndarray: \u8bfb\u53d6\u7684\u539f\u59cb\u6570\u636e</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/acquisition/das_reader.py</code> <pre><code>def ReadRawData(\n    self, file_path: Path, target_col: Optional[List[int]] = None\n) -&gt; Union[np.ndarray, \"da.Array\"]:\n    \"\"\"\u8bfb\u53d6DAT\u683c\u5f0f\u7684\u539f\u59cb\u6570\u636e\n\n    Args:\n        file_path: \u6570\u636e\u6587\u4ef6\u8def\u5f84\n        target_col: \u76ee\u6807\u5217\u7d22\u5f15\u5217\u8868\uff0c\u5982 [21,22,249,251]\uff0c\u6307\u5b9a\u8981\u5904\u7406\u7684\u975e\u8fde\u7eed\u5217\n\n    Returns:\n        np.ndarray: \u8bfb\u53d6\u7684\u539f\u59cb\u6570\u636e\n    \"\"\"\n    self.ValidateFile(file_path)\n\n    # \u8ba1\u7b97\u884c\u6570\n    file_info = file_path.stat()\n    byte_count = file_info.st_size\n    row_count = byte_count // (self.sampling_config.channels * 2)\n\n    if row_count &lt;= 0:\n        raise ValueError(f\"\u6587\u4ef6\u5927\u5c0f\u5f02\u5e38\uff0c\u65e0\u6cd5\u8bfb\u53d6\u6709\u6548\u6570\u636e: {file_path}\")\n\n    # \u6839\u636ebyte_order\u6307\u5b9a\u5b57\u8282\u5e8f\n    dtype = \"&gt;i2\" if self.sampling_config.byte_order == \"big\" else \"&lt;i2\"\n\n    # \u5982\u679c\u662f lazy \u6a21\u5f0f (chunks \u4e0d\u662f None)\n    chunks = getattr(self.sampling_config, \"chunks\", None)  # \u5047\u8bbe config \u6709 chunks\n    # \u6216\u8005\u589e\u52a0\u53c2\u6570 lazy=False\n\n    # \u7edf\u4e00\u7b56\u7565\uff1a\u9ed8\u8ba4 lazy \u5982\u679c\u6587\u4ef6\u5f88\u5927\uff1f\u6216\u8005\u603b\u662f lazy\uff0c\u7528\u6237\u53ef\u4ee5 compute()\n    # \u4e3a\u4e86\u517c\u5bb9\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba9 ReadRawData \u8fd4\u56de da.Array\uff0c\u5b83\u662f np.ndarray \u7684\u9e2d\u5b50\u7c7b\u578b\n    # \u4f46\u662f\u65e7\u4ee3\u7801\u53ef\u80fd\u671f\u5f85 pure numpy\n\n    # \u8fd9\u91cc\u6211\u4eec\u4fee\u6539\u4e3a\uff1a\u4f7f\u7528 memmap + dask\n    try:\n        # Memory map the file\n        mmap_mode = \"r\"\n        raw_data_mmap = np.memmap(\n            str(file_path),\n            dtype=dtype,\n            mode=mmap_mode,\n            shape=(int(row_count), int(self.sampling_config.channels)),\n        )  # type: ignore\n\n        # Wrap with dask array\n        # Chunking strategy:\n        # If chunks not specified, default to auto or specific size\n        # Typically DAS data is time-heavy.\n        # Let's chunk by time (e.g. 10000 samples) and full channels?\n        # Or use 'auto'\n        chunks = \"auto\"\n\n        dask_data = da.from_array(raw_data_mmap, chunks=chunks)\n\n        # Convert to physical units dealing with dask graph\n        # This is lazy\n        data = (dask_data * np.pi) / 2**13\n\n        # Slicing columns (channels) is also lazy and efficient in dask\n        if target_col is not None:\n            data = data[:, target_col]\n\n        # For backward compatibility, if caller expects numpy,\n        # they might be surprised. But the task is \"Refactor\n        # DASReader to support lazy loading\".\n        # We should probably return dask array.\n        # However, existing tests expect numpy shape immediately.\n        # Dask array has shape. Operations will be lazy.\n\n        # Wait, if we return dask array, existing code doing\n        # things like `data[0]` works.\n        # But `type(data)` is `dask.array.core.Array`.\n        # Let's return dask array.\n\n        return data\n\n    except Exception as e:\n        self.logger.error(f\"\u8bfb\u53d6DAT\u6587\u4ef6\u65f6\u53d1\u751f\u9519\u8bef: {e}\")\n        raise IOError(f\"\u65e0\u6cd5\u8bfb\u53d6DAT\u6587\u4ef6: {file_path}\") from e\n    except Exception as e:\n        self.logger.error(f\"\u8bfb\u53d6DAT\u6587\u4ef6\u65f6\u53d1\u751f\u9519\u8bef: {e}\")\n        raise IOError(f\"\u65e0\u6cd5\u8bfb\u53d6DAT\u6587\u4ef6: {file_path}\") from e\n</code></pre>"},{"location":"reference/DASMatrix/acquisition/#DASMatrix.acquisition.H5Reader","title":"H5Reader","text":"<pre><code>H5Reader(sampling_config: SamplingConfig)\n</code></pre> <p>               Bases: <code>DataReader</code></p> <p>HDF5\u683c\u5f0f\u6570\u636e\u8bfb\u53d6\u5668</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/acquisition/das_reader.py</code> <pre><code>def __init__(self, sampling_config: SamplingConfig):\n    \"\"\"\u521d\u59cb\u5316\u6570\u636e\u8bfb\u53d6\u5668\n\n    Args:\n        sampling_config: \u91c7\u6837\u914d\u7f6e\u5bf9\u8c61\uff0c\u5305\u542b\u91c7\u6837\u9891\u7387\u3001\u901a\u9053\u6570\u7b49\u4fe1\u606f\n    \"\"\"\n    self.sampling_config = sampling_config\n    self.logger = logging.getLogger(__name__)\n</code></pre>"},{"location":"reference/DASMatrix/acquisition/#DASMatrix.acquisition.H5Reader.ReadRawData","title":"ReadRawData","text":"<pre><code>ReadRawData(\n    file_path: Path, target_col: Optional[List[int]] = None\n) -&gt; Union[np.ndarray, da.Array]\n</code></pre> <p>\u8bfb\u53d6HDF5\u683c\u5f0f\u7684\u539f\u59cb\u6570\u636e</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>file_path</code> <code>Path</code> <p>\u6570\u636e\u6587\u4ef6\u8def\u5f84</p> \u5fc5\u9700 <code>target_col</code> <code>Optional[List[int]]</code> <p>\u76ee\u6807\u5217\u7d22\u5f15\u5217\u8868\uff0c\u5982 [21,22,249,251]\uff0c\u6307\u5b9a\u8981\u5904\u7406\u7684\u975e\u8fde\u7eed\u5217</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Union[ndarray, Array]</code> <p>np.ndarray: \u8bfb\u53d6\u7684\u539f\u59cb\u6570\u636e</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/acquisition/das_reader.py</code> <pre><code>def ReadRawData(\n    self, file_path: Path, target_col: Optional[List[int]] = None\n) -&gt; Union[np.ndarray, \"da.Array\"]:\n    \"\"\"\u8bfb\u53d6HDF5\u683c\u5f0f\u7684\u539f\u59cb\u6570\u636e\n\n    Args:\n        file_path: \u6570\u636e\u6587\u4ef6\u8def\u5f84\n        target_col: \u76ee\u6807\u5217\u7d22\u5f15\u5217\u8868\uff0c\u5982 [21,22,249,251]\uff0c\u6307\u5b9a\u8981\u5904\u7406\u7684\u975e\u8fde\u7eed\u5217\n\n    Returns:\n        np.ndarray: \u8bfb\u53d6\u7684\u539f\u59cb\u6570\u636e\n    \"\"\"\n    self.ValidateFile(file_path)\n\n    try:\n        # Open file in read mode. Note: We cannot use 'with' block here if\n        # we want to return lazy array because closing file invalidates\n        # the h5 dataset. Dask handles this if we don't close immediately?\n        # Actually standard practice for lazy h5 in typical scripts is tricky.\n        # But xarray/dask usually keeps file open or reopens.\n        # For dask.from_array(dataset), the file must remain open.\n\n        # Compromise: We behave like xarray.open_dataset.\n        # We attach the file object to the array or reader?\n        # Or we simply don't support context manager closing in strict\n        # sense inside this method. Let's assume user manages\n        # lifecycle or we leave it to GC (h5py does this reasonably).\n\n        f = h5py.File(file_path, \"r\")\n        if \"Acquisition/Raw[0]\" not in f:\n            f.close()\n            raise KeyError(\"HDF5\u6587\u4ef6\u4e2d\u672a\u627e\u5230 'Acquisition/Raw[0]' \u6570\u636e\u96c6\")\n\n        dataset = f[\"Acquisition/Raw[0]\"]\n\n        # Wrap with dask\n        # chunks=None means use h5 chunking if available, else auto?\n        # Safe to specify chunks=\"auto\"\n        dask_data = da.from_array(dataset, chunks=\"auto\")\n\n        # Divide by 4 (lazy)\n        raw_data = dask_data / 4\n\n        # \u8f6c\u6362\u4e3a\u7269\u7406\u91cf (lazy)\n        raw_data = (raw_data * np.pi) / 2**13\n\n        # \u5982\u679c\u63d0\u4f9b\u4e86target_col\uff0c\u53ea\u9009\u62e9\u6307\u5b9a\u5217 (lazy)\n        if target_col is not None:\n            raw_data = raw_data[:, target_col]\n\n        return raw_data\n    except Exception as e:\n        self.logger.error(f\"\u8bfb\u53d6H5\u6587\u4ef6\u65f6\u53d1\u751f\u9519\u8bef: {e}\")\n        raise IOError(f\"\u65e0\u6cd5\u8bfb\u53d6H5\u6587\u4ef6: {file_path}\") from e\n</code></pre>"},{"location":"reference/DASMatrix/acquisition/das_reader/","title":"das_reader","text":""},{"location":"reference/DASMatrix/acquisition/das_reader/#DASMatrix.acquisition.das_reader","title":"das_reader","text":""},{"location":"reference/DASMatrix/acquisition/das_reader/#DASMatrix.acquisition.das_reader.DataType","title":"DataType","text":"<p>               Bases: <code>Enum</code></p> <p>\u6570\u636e\u7c7b\u578b\u679a\u4e3e\u7c7b</p>"},{"location":"reference/DASMatrix/acquisition/das_reader/#DASMatrix.acquisition.das_reader.DataReader","title":"DataReader","text":"<pre><code>DataReader(sampling_config: SamplingConfig)\n</code></pre> <p>               Bases: <code>ABC</code></p> <p>\u62bd\u8c61\u6570\u636e\u8bfb\u53d6\u5668\u57fa\u7c7b</p> <p>\u521d\u59cb\u5316\u6570\u636e\u8bfb\u53d6\u5668</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>sampling_config</code> <code>SamplingConfig</code> <p>\u91c7\u6837\u914d\u7f6e\u5bf9\u8c61\uff0c\u5305\u542b\u91c7\u6837\u9891\u7387\u3001\u901a\u9053\u6570\u7b49\u4fe1\u606f</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/acquisition/das_reader.py</code> <pre><code>def __init__(self, sampling_config: SamplingConfig):\n    \"\"\"\u521d\u59cb\u5316\u6570\u636e\u8bfb\u53d6\u5668\n\n    Args:\n        sampling_config: \u91c7\u6837\u914d\u7f6e\u5bf9\u8c61\uff0c\u5305\u542b\u91c7\u6837\u9891\u7387\u3001\u901a\u9053\u6570\u7b49\u4fe1\u606f\n    \"\"\"\n    self.sampling_config = sampling_config\n    self.logger = logging.getLogger(__name__)\n</code></pre>"},{"location":"reference/DASMatrix/acquisition/das_reader/#DASMatrix.acquisition.das_reader.DataReader.ReadRawData","title":"ReadRawData  <code>abstractmethod</code>","text":"<pre><code>ReadRawData(\n    file_path: Path, target_col: Optional[List[int]] = None\n) -&gt; Union[np.ndarray, da.Array]\n</code></pre> <p>\u8bfb\u53d6\u539f\u59cb\u6570\u636e</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>file_path</code> <code>Path</code> <p>\u6570\u636e\u6587\u4ef6\u8def\u5f84</p> \u5fc5\u9700 <code>target_col</code> <code>Optional[List[int]]</code> <p>\u76ee\u6807\u5217\u7d22\u5f15\u5217\u8868\uff0c\u5982 [21,22,249,251]\uff0c\u6307\u5b9a\u8981\u5904\u7406\u7684\u975e\u8fde\u7eed\u5217</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Union[ndarray, Array]</code> <p>Union[np.ndarray, da.Array]: \u8bfb\u53d6\u7684\u539f\u59cb\u6570\u636e</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/acquisition/das_reader.py</code> <pre><code>@abstractmethod\ndef ReadRawData(\n    self, file_path: Path, target_col: Optional[List[int]] = None\n) -&gt; Union[np.ndarray, \"da.Array\"]:\n    \"\"\"\u8bfb\u53d6\u539f\u59cb\u6570\u636e\n\n    Args:\n        file_path: \u6570\u636e\u6587\u4ef6\u8def\u5f84\n        target_col: \u76ee\u6807\u5217\u7d22\u5f15\u5217\u8868\uff0c\u5982 [21,22,249,251]\uff0c\u6307\u5b9a\u8981\u5904\u7406\u7684\u975e\u8fde\u7eed\u5217\n\n    Returns:\n        Union[np.ndarray, da.Array]: \u8bfb\u53d6\u7684\u539f\u59cb\u6570\u636e\n    \"\"\"\n    pass\n</code></pre>"},{"location":"reference/DASMatrix/acquisition/das_reader/#DASMatrix.acquisition.das_reader.DataReader.ValidateFile","title":"ValidateFile","text":"<pre><code>ValidateFile(file_path: Path) -&gt; None\n</code></pre> <p>\u9a8c\u8bc1\u6587\u4ef6\u662f\u5426\u5b58\u5728\u4e14\u53ef\u8bfb</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>file_path</code> <code>Path</code> <p>\u6570\u636e\u6587\u4ef6\u8def\u5f84</p> \u5fc5\u9700 <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>FileNotFoundError</code> <p>\u6587\u4ef6\u4e0d\u5b58\u5728</p> <code>PermissionError</code> <p>\u65e0\u6cd5\u8bfb\u53d6\u6587\u4ef6</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/acquisition/das_reader.py</code> <pre><code>def ValidateFile(self, file_path: Path) -&gt; None:\n    \"\"\"\u9a8c\u8bc1\u6587\u4ef6\u662f\u5426\u5b58\u5728\u4e14\u53ef\u8bfb\n\n    Args:\n        file_path: \u6570\u636e\u6587\u4ef6\u8def\u5f84\n\n    Raises:\n        FileNotFoundError: \u6587\u4ef6\u4e0d\u5b58\u5728\n        PermissionError: \u65e0\u6cd5\u8bfb\u53d6\u6587\u4ef6\n    \"\"\"\n    if not isinstance(file_path, Path):\n        file_path = Path(file_path)\n        self.logger.debug(f\"\u5c06\u6587\u4ef6\u8def\u5f84\u8f6c\u6362\u4e3a Path \u5bf9\u8c61: {file_path}\")\n\n    if not file_path.exists():\n        raise FileNotFoundError(f\"\u6587\u4ef6\u4e0d\u5b58\u5728: {file_path}\")\n\n    if not file_path.is_file():\n        raise ValueError(f\"\u8def\u5f84\u4e0d\u662f\u6587\u4ef6: {file_path}\")\n\n    if not os.access(file_path, os.R_OK):\n        raise PermissionError(f\"\u65e0\u6cd5\u8bfb\u53d6\u6587\u4ef6: {file_path}\")\n</code></pre>"},{"location":"reference/DASMatrix/acquisition/das_reader/#DASMatrix.acquisition.das_reader.DATReader","title":"DATReader","text":"<pre><code>DATReader(sampling_config: SamplingConfig)\n</code></pre> <p>               Bases: <code>DataReader</code></p> <p>DAT\u683c\u5f0f\u6570\u636e\u8bfb\u53d6\u5668</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/acquisition/das_reader.py</code> <pre><code>def __init__(self, sampling_config: SamplingConfig):\n    \"\"\"\u521d\u59cb\u5316\u6570\u636e\u8bfb\u53d6\u5668\n\n    Args:\n        sampling_config: \u91c7\u6837\u914d\u7f6e\u5bf9\u8c61\uff0c\u5305\u542b\u91c7\u6837\u9891\u7387\u3001\u901a\u9053\u6570\u7b49\u4fe1\u606f\n    \"\"\"\n    self.sampling_config = sampling_config\n    self.logger = logging.getLogger(__name__)\n</code></pre>"},{"location":"reference/DASMatrix/acquisition/das_reader/#DASMatrix.acquisition.das_reader.DATReader.ReadRawData","title":"ReadRawData","text":"<pre><code>ReadRawData(\n    file_path: Path, target_col: Optional[List[int]] = None\n) -&gt; Union[np.ndarray, da.Array]\n</code></pre> <p>\u8bfb\u53d6DAT\u683c\u5f0f\u7684\u539f\u59cb\u6570\u636e</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>file_path</code> <code>Path</code> <p>\u6570\u636e\u6587\u4ef6\u8def\u5f84</p> \u5fc5\u9700 <code>target_col</code> <code>Optional[List[int]]</code> <p>\u76ee\u6807\u5217\u7d22\u5f15\u5217\u8868\uff0c\u5982 [21,22,249,251]\uff0c\u6307\u5b9a\u8981\u5904\u7406\u7684\u975e\u8fde\u7eed\u5217</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Union[ndarray, Array]</code> <p>np.ndarray: \u8bfb\u53d6\u7684\u539f\u59cb\u6570\u636e</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/acquisition/das_reader.py</code> <pre><code>def ReadRawData(\n    self, file_path: Path, target_col: Optional[List[int]] = None\n) -&gt; Union[np.ndarray, \"da.Array\"]:\n    \"\"\"\u8bfb\u53d6DAT\u683c\u5f0f\u7684\u539f\u59cb\u6570\u636e\n\n    Args:\n        file_path: \u6570\u636e\u6587\u4ef6\u8def\u5f84\n        target_col: \u76ee\u6807\u5217\u7d22\u5f15\u5217\u8868\uff0c\u5982 [21,22,249,251]\uff0c\u6307\u5b9a\u8981\u5904\u7406\u7684\u975e\u8fde\u7eed\u5217\n\n    Returns:\n        np.ndarray: \u8bfb\u53d6\u7684\u539f\u59cb\u6570\u636e\n    \"\"\"\n    self.ValidateFile(file_path)\n\n    # \u8ba1\u7b97\u884c\u6570\n    file_info = file_path.stat()\n    byte_count = file_info.st_size\n    row_count = byte_count // (self.sampling_config.channels * 2)\n\n    if row_count &lt;= 0:\n        raise ValueError(f\"\u6587\u4ef6\u5927\u5c0f\u5f02\u5e38\uff0c\u65e0\u6cd5\u8bfb\u53d6\u6709\u6548\u6570\u636e: {file_path}\")\n\n    # \u6839\u636ebyte_order\u6307\u5b9a\u5b57\u8282\u5e8f\n    dtype = \"&gt;i2\" if self.sampling_config.byte_order == \"big\" else \"&lt;i2\"\n\n    # \u5982\u679c\u662f lazy \u6a21\u5f0f (chunks \u4e0d\u662f None)\n    chunks = getattr(self.sampling_config, \"chunks\", None)  # \u5047\u8bbe config \u6709 chunks\n    # \u6216\u8005\u589e\u52a0\u53c2\u6570 lazy=False\n\n    # \u7edf\u4e00\u7b56\u7565\uff1a\u9ed8\u8ba4 lazy \u5982\u679c\u6587\u4ef6\u5f88\u5927\uff1f\u6216\u8005\u603b\u662f lazy\uff0c\u7528\u6237\u53ef\u4ee5 compute()\n    # \u4e3a\u4e86\u517c\u5bb9\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba9 ReadRawData \u8fd4\u56de da.Array\uff0c\u5b83\u662f np.ndarray \u7684\u9e2d\u5b50\u7c7b\u578b\n    # \u4f46\u662f\u65e7\u4ee3\u7801\u53ef\u80fd\u671f\u5f85 pure numpy\n\n    # \u8fd9\u91cc\u6211\u4eec\u4fee\u6539\u4e3a\uff1a\u4f7f\u7528 memmap + dask\n    try:\n        # Memory map the file\n        mmap_mode = \"r\"\n        raw_data_mmap = np.memmap(\n            str(file_path),\n            dtype=dtype,\n            mode=mmap_mode,\n            shape=(int(row_count), int(self.sampling_config.channels)),\n        )  # type: ignore\n\n        # Wrap with dask array\n        # Chunking strategy:\n        # If chunks not specified, default to auto or specific size\n        # Typically DAS data is time-heavy.\n        # Let's chunk by time (e.g. 10000 samples) and full channels?\n        # Or use 'auto'\n        chunks = \"auto\"\n\n        dask_data = da.from_array(raw_data_mmap, chunks=chunks)\n\n        # Convert to physical units dealing with dask graph\n        # This is lazy\n        data = (dask_data * np.pi) / 2**13\n\n        # Slicing columns (channels) is also lazy and efficient in dask\n        if target_col is not None:\n            data = data[:, target_col]\n\n        # For backward compatibility, if caller expects numpy,\n        # they might be surprised. But the task is \"Refactor\n        # DASReader to support lazy loading\".\n        # We should probably return dask array.\n        # However, existing tests expect numpy shape immediately.\n        # Dask array has shape. Operations will be lazy.\n\n        # Wait, if we return dask array, existing code doing\n        # things like `data[0]` works.\n        # But `type(data)` is `dask.array.core.Array`.\n        # Let's return dask array.\n\n        return data\n\n    except Exception as e:\n        self.logger.error(f\"\u8bfb\u53d6DAT\u6587\u4ef6\u65f6\u53d1\u751f\u9519\u8bef: {e}\")\n        raise IOError(f\"\u65e0\u6cd5\u8bfb\u53d6DAT\u6587\u4ef6: {file_path}\") from e\n    except Exception as e:\n        self.logger.error(f\"\u8bfb\u53d6DAT\u6587\u4ef6\u65f6\u53d1\u751f\u9519\u8bef: {e}\")\n        raise IOError(f\"\u65e0\u6cd5\u8bfb\u53d6DAT\u6587\u4ef6: {file_path}\") from e\n</code></pre>"},{"location":"reference/DASMatrix/acquisition/das_reader/#DASMatrix.acquisition.das_reader.H5Reader","title":"H5Reader","text":"<pre><code>H5Reader(sampling_config: SamplingConfig)\n</code></pre> <p>               Bases: <code>DataReader</code></p> <p>HDF5\u683c\u5f0f\u6570\u636e\u8bfb\u53d6\u5668</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/acquisition/das_reader.py</code> <pre><code>def __init__(self, sampling_config: SamplingConfig):\n    \"\"\"\u521d\u59cb\u5316\u6570\u636e\u8bfb\u53d6\u5668\n\n    Args:\n        sampling_config: \u91c7\u6837\u914d\u7f6e\u5bf9\u8c61\uff0c\u5305\u542b\u91c7\u6837\u9891\u7387\u3001\u901a\u9053\u6570\u7b49\u4fe1\u606f\n    \"\"\"\n    self.sampling_config = sampling_config\n    self.logger = logging.getLogger(__name__)\n</code></pre>"},{"location":"reference/DASMatrix/acquisition/das_reader/#DASMatrix.acquisition.das_reader.H5Reader.ReadRawData","title":"ReadRawData","text":"<pre><code>ReadRawData(\n    file_path: Path, target_col: Optional[List[int]] = None\n) -&gt; Union[np.ndarray, da.Array]\n</code></pre> <p>\u8bfb\u53d6HDF5\u683c\u5f0f\u7684\u539f\u59cb\u6570\u636e</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>file_path</code> <code>Path</code> <p>\u6570\u636e\u6587\u4ef6\u8def\u5f84</p> \u5fc5\u9700 <code>target_col</code> <code>Optional[List[int]]</code> <p>\u76ee\u6807\u5217\u7d22\u5f15\u5217\u8868\uff0c\u5982 [21,22,249,251]\uff0c\u6307\u5b9a\u8981\u5904\u7406\u7684\u975e\u8fde\u7eed\u5217</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Union[ndarray, Array]</code> <p>np.ndarray: \u8bfb\u53d6\u7684\u539f\u59cb\u6570\u636e</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/acquisition/das_reader.py</code> <pre><code>def ReadRawData(\n    self, file_path: Path, target_col: Optional[List[int]] = None\n) -&gt; Union[np.ndarray, \"da.Array\"]:\n    \"\"\"\u8bfb\u53d6HDF5\u683c\u5f0f\u7684\u539f\u59cb\u6570\u636e\n\n    Args:\n        file_path: \u6570\u636e\u6587\u4ef6\u8def\u5f84\n        target_col: \u76ee\u6807\u5217\u7d22\u5f15\u5217\u8868\uff0c\u5982 [21,22,249,251]\uff0c\u6307\u5b9a\u8981\u5904\u7406\u7684\u975e\u8fde\u7eed\u5217\n\n    Returns:\n        np.ndarray: \u8bfb\u53d6\u7684\u539f\u59cb\u6570\u636e\n    \"\"\"\n    self.ValidateFile(file_path)\n\n    try:\n        # Open file in read mode. Note: We cannot use 'with' block here if\n        # we want to return lazy array because closing file invalidates\n        # the h5 dataset. Dask handles this if we don't close immediately?\n        # Actually standard practice for lazy h5 in typical scripts is tricky.\n        # But xarray/dask usually keeps file open or reopens.\n        # For dask.from_array(dataset), the file must remain open.\n\n        # Compromise: We behave like xarray.open_dataset.\n        # We attach the file object to the array or reader?\n        # Or we simply don't support context manager closing in strict\n        # sense inside this method. Let's assume user manages\n        # lifecycle or we leave it to GC (h5py does this reasonably).\n\n        f = h5py.File(file_path, \"r\")\n        if \"Acquisition/Raw[0]\" not in f:\n            f.close()\n            raise KeyError(\"HDF5\u6587\u4ef6\u4e2d\u672a\u627e\u5230 'Acquisition/Raw[0]' \u6570\u636e\u96c6\")\n\n        dataset = f[\"Acquisition/Raw[0]\"]\n\n        # Wrap with dask\n        # chunks=None means use h5 chunking if available, else auto?\n        # Safe to specify chunks=\"auto\"\n        dask_data = da.from_array(dataset, chunks=\"auto\")\n\n        # Divide by 4 (lazy)\n        raw_data = dask_data / 4\n\n        # \u8f6c\u6362\u4e3a\u7269\u7406\u91cf (lazy)\n        raw_data = (raw_data * np.pi) / 2**13\n\n        # \u5982\u679c\u63d0\u4f9b\u4e86target_col\uff0c\u53ea\u9009\u62e9\u6307\u5b9a\u5217 (lazy)\n        if target_col is not None:\n            raw_data = raw_data[:, target_col]\n\n        return raw_data\n    except Exception as e:\n        self.logger.error(f\"\u8bfb\u53d6H5\u6587\u4ef6\u65f6\u53d1\u751f\u9519\u8bef: {e}\")\n        raise IOError(f\"\u65e0\u6cd5\u8bfb\u53d6H5\u6587\u4ef6: {file_path}\") from e\n</code></pre>"},{"location":"reference/DASMatrix/acquisition/das_reader/#DASMatrix.acquisition.das_reader.SEGYReader","title":"SEGYReader","text":"<pre><code>SEGYReader(sampling_config: SamplingConfig)\n</code></pre> <p>               Bases: <code>DataReader</code></p> <p>SEGY\u683c\u5f0f\u6570\u636e\u8bfb\u53d6\u5668</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/acquisition/das_reader.py</code> <pre><code>def __init__(self, sampling_config: SamplingConfig):\n    \"\"\"\u521d\u59cb\u5316\u6570\u636e\u8bfb\u53d6\u5668\n\n    Args:\n        sampling_config: \u91c7\u6837\u914d\u7f6e\u5bf9\u8c61\uff0c\u5305\u542b\u91c7\u6837\u9891\u7387\u3001\u901a\u9053\u6570\u7b49\u4fe1\u606f\n    \"\"\"\n    self.sampling_config = sampling_config\n    self.logger = logging.getLogger(__name__)\n</code></pre>"},{"location":"reference/DASMatrix/acquisition/das_reader/#DASMatrix.acquisition.das_reader.SEGYReader.ReadRawData","title":"ReadRawData","text":"<pre><code>ReadRawData(\n    file_path: Path, target_col: Optional[List[int]] = None\n) -&gt; Union[np.ndarray, da.Array]\n</code></pre> <p>\u8bfb\u53d6SEGY\u683c\u5f0f\u7684\u539f\u59cb\u6570\u636e</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>file_path</code> <code>Path</code> <p>\u6570\u636e\u6587\u4ef6\u8def\u5f84</p> \u5fc5\u9700 <code>target_col</code> <code>Optional[List[int]]</code> <p>\u76ee\u6807\u5217\u7d22\u5f15\u5217\u8868</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Union[ndarray, Array]</code> <p>np.ndarray: \u8bfb\u53d6\u7684\u539f\u59cb\u6570\u636e (n_samples, n_channels)</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/acquisition/das_reader.py</code> <pre><code>def ReadRawData(\n    self, file_path: Path, target_col: Optional[List[int]] = None\n) -&gt; Union[np.ndarray, \"da.Array\"]:\n    \"\"\"\u8bfb\u53d6SEGY\u683c\u5f0f\u7684\u539f\u59cb\u6570\u636e\n\n    Args:\n        file_path: \u6570\u636e\u6587\u4ef6\u8def\u5f84\n        target_col: \u76ee\u6807\u5217\u7d22\u5f15\u5217\u8868\n\n    Returns:\n        np.ndarray: \u8bfb\u53d6\u7684\u539f\u59cb\u6570\u636e (n_samples, n_channels)\n    \"\"\"\n    self.ValidateFile(file_path)\n\n    try:\n        # \u8bfb\u53d6SEGY\u6587\u4ef6\n        # unpack_trace_headers=True \u53ef\u4ee5\u8bfb\u53d6\u5934\u90e8\u4fe1\u606f\uff0c\u4f46\u4f1a\u589e\u52a0\u5185\u5b58\u6d88\u8017\n        # headonly=True \u53ea\u8bfb\u53d6\u5934\u90e8\u7528\u4e8e\u6821\u9a8c\uff0c\u8fd9\u91cc\u6211\u4eec\u9700\u8981\u6570\u636e\n        st = obspy.read(str(file_path), format=\"SEGY\")\n\n        # \u5c06Stream\u8f6c\u6362\u4e3anumpy\u6570\u7ec4\n        # ObsPy\u7684\u4e60\u60ef\u662f (n_traces, n_samples)\n        # \u6211\u4eec\u9700\u8981\u8f6c\u7f6e\u4e3a (n_samples, n_channels)\n        # stack=True \u786e\u4fdd\u6240\u6709trace\u957f\u5ea6\u4e00\u81f4\u5e76\u5806\u53e0\u6210\u4e8c\u7ef4\u6570\u7ec4\n        data = np.stack([tr.data for tr in st], axis=1)\n\n        # \u5982\u679c\u63d0\u4f9b\u4e86target_col\uff0c\u53ea\u9009\u62e9\u6307\u5b9a\u5217\n        if target_col is not None:\n            data = data[:, target_col]\n\n        return data\n    except Exception as e:\n        self.logger.error(f\"\u8bfb\u53d6SEGY\u6587\u4ef6\u65f6\u53d1\u751f\u9519\u8bef: {e}\")\n        raise IOError(f\"\u65e0\u6cd5\u8bfb\u53d6SEGY\u6587\u4ef6: {file_path}\") from e\n</code></pre>"},{"location":"reference/DASMatrix/acquisition/das_reader/#DASMatrix.acquisition.das_reader.MiniSEEDReader","title":"MiniSEEDReader","text":"<pre><code>MiniSEEDReader(sampling_config: SamplingConfig)\n</code></pre> <p>               Bases: <code>DataReader</code></p> <p>MiniSEED\u683c\u5f0f\u6570\u636e\u8bfb\u53d6\u5668</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/acquisition/das_reader.py</code> <pre><code>def __init__(self, sampling_config: SamplingConfig):\n    \"\"\"\u521d\u59cb\u5316\u6570\u636e\u8bfb\u53d6\u5668\n\n    Args:\n        sampling_config: \u91c7\u6837\u914d\u7f6e\u5bf9\u8c61\uff0c\u5305\u542b\u91c7\u6837\u9891\u7387\u3001\u901a\u9053\u6570\u7b49\u4fe1\u606f\n    \"\"\"\n    self.sampling_config = sampling_config\n    self.logger = logging.getLogger(__name__)\n</code></pre>"},{"location":"reference/DASMatrix/acquisition/das_reader/#DASMatrix.acquisition.das_reader.MiniSEEDReader.ReadRawData","title":"ReadRawData","text":"<pre><code>ReadRawData(\n    file_path: Path, target_col: Optional[List[int]] = None\n) -&gt; Union[np.ndarray, da.Array]\n</code></pre> <p>\u8bfb\u53d6MiniSEED\u683c\u5f0f\u7684\u539f\u59cb\u6570\u636e</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>file_path</code> <code>Path</code> <p>\u6570\u636e\u6587\u4ef6\u8def\u5f84</p> \u5fc5\u9700 <code>target_col</code> <code>Optional[List[int]]</code> <p>\u76ee\u6807\u5217\u7d22\u5f15\u5217\u8868</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Union[ndarray, Array]</code> <p>np.ndarray: \u8bfb\u53d6\u7684\u539f\u59cb\u6570\u636e (n_samples, n_channels)</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/acquisition/das_reader.py</code> <pre><code>def ReadRawData(\n    self, file_path: Path, target_col: Optional[List[int]] = None\n) -&gt; Union[np.ndarray, \"da.Array\"]:\n    \"\"\"\u8bfb\u53d6MiniSEED\u683c\u5f0f\u7684\u539f\u59cb\u6570\u636e\n\n    Args:\n        file_path: \u6570\u636e\u6587\u4ef6\u8def\u5f84\n        target_col: \u76ee\u6807\u5217\u7d22\u5f15\u5217\u8868\n\n    Returns:\n        np.ndarray: \u8bfb\u53d6\u7684\u539f\u59cb\u6570\u636e (n_samples, n_channels)\n    \"\"\"\n    self.ValidateFile(file_path)\n\n    try:\n        st = obspy.read(str(file_path), format=\"MSEED\")\n\n        # \u786e\u4fdd\u6240\u6709trace\u5bf9\u9f50\uff08MiniSEED\u53ef\u80fd\u6709\u95f4\u9699\uff09\n        st.merge(method=1, fill_value=\"interpolate\")\n\n        # \u8f6c\u6362\u4e3anumpy\u6570\u7ec4 (n_channels, n_samples) -&gt; (n_samples, n_channels)\n        # \u7531\u4e8eMiniSEED\u4e0d\u4fdd\u8bc1\u6240\u6709trace\u957f\u5ea6\u7edd\u5bf9\u4e00\u81f4\uff08\u9664\u975emerge\u540etrim\uff09\n        lens = [len(tr) for tr in st]\n        if len(set(lens)) &gt; 1:\n            # \u88c1\u526a\u5230\u6700\u5c0f\u957f\u5ea6\n            min_len = min(lens)\n            self.logger.warning(\n                f\"Trace lengths inconsistent, trimming to {min_len}\"\n            )\n            data = np.stack([tr.data[:min_len] for tr in st], axis=1)\n        else:\n            data = np.stack([tr.data for tr in st], axis=1)\n\n        # \u5982\u679c\u63d0\u4f9b\u4e86target_col\uff0c\u53ea\u9009\u62e9\u6307\u5b9a\u5217\n        if target_col is not None:\n            data = data[:, target_col]\n\n        return data\n    except Exception as e:\n        self.logger.error(f\"\u8bfb\u53d6MiniSEED\u6587\u4ef6\u65f6\u53d1\u751f\u9519\u8bef: {e}\")\n        raise IOError(f\"\u65e0\u6cd5\u8bfb\u53d6MiniSEED\u6587\u4ef6: {file_path}\") from e\n</code></pre>"},{"location":"reference/DASMatrix/acquisition/das_reader/#DASMatrix.acquisition.das_reader.DASReader","title":"DASReader","text":"<pre><code>DASReader(\n    sampling_config: SamplingConfig,\n    data_type: DataType = DataType.DAT,\n)\n</code></pre> <p>\u6570\u636e\u8bfb\u53d6\u5668\u7c7b, \u7528\u4e8e\u8bfb\u53d6\u4e0d\u540c\u683c\u5f0f\u7684\u6570\u636e\u6587\u4ef6</p> <p>\u521d\u59cb\u5316\u6570\u636e\u8bfb\u53d6\u5668</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>sampling_config</code> <code>SamplingConfig</code> <p>\u91c7\u6837\u914d\u7f6e\u5bf9\u8c61</p> \u5fc5\u9700 <code>data_type</code> <code>DataType</code> <p>\u6570\u636e\u7c7b\u578b\uff0c\u9ed8\u8ba4\u4e3aDAT\u683c\u5f0f</p> <code>DAT</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/acquisition/das_reader.py</code> <pre><code>def __init__(\n    self, sampling_config: SamplingConfig, data_type: DataType = DataType.DAT\n):\n    \"\"\"\u521d\u59cb\u5316\u6570\u636e\u8bfb\u53d6\u5668\n\n    Args:\n        sampling_config: \u91c7\u6837\u914d\u7f6e\u5bf9\u8c61\n        data_type: \u6570\u636e\u7c7b\u578b\uff0c\u9ed8\u8ba4\u4e3aDAT\u683c\u5f0f\n    \"\"\"\n    self.sampling_config = sampling_config\n    self.reader: DataReader\n    self.data_type = data_type\n    self.logger = logging.getLogger(__name__)\n\n    # \u6839\u636e\u6570\u636e\u7c7b\u578b\u9009\u62e9\u5408\u9002\u7684\u8bfb\u53d6\u5668\n    if data_type == DataType.DAT:\n        self.reader = DATReader(sampling_config)\n    elif data_type == DataType.H5:\n        self.reader = H5Reader(sampling_config)\n    elif data_type == DataType.SEGY:\n        self.reader = SEGYReader(sampling_config)\n    elif data_type == DataType.MINISEED:\n        self.reader = MiniSEEDReader(sampling_config)\n    else:\n        raise ValueError(f\"\u4e0d\u652f\u6301\u7684\u6570\u636e\u7c7b\u578b: {data_type}\")\n</code></pre>"},{"location":"reference/DASMatrix/acquisition/das_reader/#DASMatrix.acquisition.das_reader.DASReader.ReadRawData","title":"ReadRawData","text":"<pre><code>ReadRawData(\n    file_path: Path, target_col: Optional[List[int]] = None\n) -&gt; Union[np.ndarray, da.Array]\n</code></pre> <p>\u8bfb\u53d6\u6307\u5b9a\u8def\u5f84\u7684\u6570\u636e\u6587\u4ef6</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>file_path</code> <code>Path</code> <p>\u6570\u636e\u6587\u4ef6\u8def\u5f84</p> \u5fc5\u9700 <code>target_col</code> <code>Optional[List[int]]</code> <p>\u76ee\u6807\u5217\u7d22\u5f15\u5217\u8868</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Union[ndarray, Array]</code> <p>np.ndarray: \u5305\u542b\u539f\u59cb\u6570\u636e\u7684 NumPy \u6570\u7ec4</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/acquisition/das_reader.py</code> <pre><code>def ReadRawData(\n    self, file_path: Path, target_col: Optional[List[int]] = None\n) -&gt; Union[np.ndarray, \"da.Array\"]:\n    \"\"\"\u8bfb\u53d6\u6307\u5b9a\u8def\u5f84\u7684\u6570\u636e\u6587\u4ef6\n\n    Args:\n        file_path: \u6570\u636e\u6587\u4ef6\u8def\u5f84\n        target_col: \u76ee\u6807\u5217\u7d22\u5f15\u5217\u8868\n\n    Returns:\n        np.ndarray: \u5305\u542b\u539f\u59cb\u6570\u636e\u7684 NumPy \u6570\u7ec4\n    \"\"\"\n    try:\n        # \u8bfb\u53d6\u539f\u59cb\u6570\u636e\n        raw_data = self.reader.ReadRawData(file_path, target_col)\n        return raw_data\n    except Exception as e:\n        self.logger.error(f\"\u8bfb\u53d6\u6570\u636e\u65f6\u53d1\u751f\u9519\u8bef: {e}\uff0c\u6587\u4ef6\u8def\u5f84: {file_path}\")\n        raise\n</code></pre>"},{"location":"reference/DASMatrix/api/","title":"api","text":""},{"location":"reference/DASMatrix/api/#DASMatrix.api","title":"api","text":"<p>DASMatrix API\u5c42\uff0c\u63d0\u4f9b\u9ad8\u7ea7\u63a5\u53e3\u548cDSL\u3002</p>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame","title":"DASFrame","text":"<pre><code>DASFrame(\n    data: Union[DataArray, ndarray, Array, DASFrame],\n    fs: float,\n    dx: float = 1.0,\n    **metadata: Any,\n)\n</code></pre> <p>DAS \u6570\u636e\u5904\u7406\u6838\u5fc3\u7c7b (Xarray/Dask Backend)\u3002</p> <p>\u6240\u6709\u4fe1\u53f7\u5904\u7406\u64cd\u4f5c\u57fa\u4e8e xarray \u548c dask \u8fdb\u884c\u5ef6\u8fdf\u8ba1\u7b97\u3002</p> <p>Initialize DASFrame.</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>Union[DataArray, ndarray, Array, DASFrame]</code> <p>Input data.</p> \u5fc5\u9700 <code>fs</code> <code>float</code> <p>Sampling frequency (Hz).</p> \u5fc5\u9700 <code>dx</code> <code>float</code> <p>Channel spacing (m).</p> <code>1.0</code> <code>**metadata</code> <code>Any</code> <p>Additional metadata.</p> <code>{}</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def __init__(\n    self,\n    data: Union[xr.DataArray, np.ndarray, da.Array, \"DASFrame\"],\n    fs: float,\n    dx: float = 1.0,\n    **metadata: Any,\n) -&gt; None:\n    \"\"\"Initialize DASFrame.\n\n    Args:\n        data: Input data.\n        fs: Sampling frequency (Hz).\n        dx: Channel spacing (m).\n        **metadata: Additional metadata.\n    \"\"\"\n    if isinstance(data, DASFrame):\n        # Copy constructor roughly\n        self._data = data._data\n        self._fs = data.fs\n        self._dx = getattr(data, \"_dx\", dx)\n        self._metadata = {**data._metadata, **metadata}\n        return\n\n    self._fs = fs\n    self._dx = dx\n    self._metadata = metadata\n\n    if isinstance(data, xr.DataArray):\n        # Ensure order is (time, distance)\n        if \"time\" in data.dims and data.dims[0] != \"time\":\n            data = data.transpose(\"time\", ...)\n        self._data = data\n    else:\n        # Wrap numpy/dask array into xarray\n        # Assume dims are (time, channel)\n        if not isinstance(data, (np.ndarray, da.Array)):\n            data = np.asarray(data)\n\n        # Create coordinates\n        nt, nx = data.shape\n        coords = {\n            \"time\": np.arange(nt) / fs,\n            \"distance\": np.arange(nx) * dx,\n        }\n\n        self._data = xr.DataArray(\n            data,\n            dims=(\"time\", \"distance\"),\n            coords=coords,\n            name=\"das_strain\",\n            attrs={\"fs\": fs, \"dx\": dx, **metadata},\n        )\n\n        # Ensure it is chunked (dask backed) if it isn't already\n        if not self._data.chunks:\n            self._data = self._data.chunk({\"time\": \"auto\", \"distance\": -1})\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.data","title":"data  <code>property</code>","text":"<pre><code>data: DataArray\n</code></pre> <p>Access underlying xarray DataArray.</p>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.shape","title":"shape  <code>property</code>","text":"<pre><code>shape: Tuple[int, ...]\n</code></pre> <p>Get shape of data.</p>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.collect","title":"collect","text":"<pre><code>collect() -&gt; np.ndarray\n</code></pre> <p>Compute and return numpy array.</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def collect(self) -&gt; np.ndarray:\n    \"\"\"Compute and return numpy array.\"\"\"\n    return self._data.compute().values\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.slice","title":"slice","text":"<pre><code>slice(\n    t: slice = slice(None), x: slice = slice(None)\n) -&gt; DASFrame\n</code></pre> <p>Slice data.</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def slice(self, t: slice = slice(None), x: slice = slice(None)) -&gt; \"DASFrame\":\n    \"\"\"Slice data.\"\"\"\n    # xarray is slicing by index here (isel)\n    sliced = self._data.isel(time=t, distance=x)\n    return DASFrame(sliced, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.bandpass","title":"bandpass","text":"<pre><code>bandpass(\n    low: float, high: float, order: int = 4\n) -&gt; DASFrame\n</code></pre> <p>Apply bandpass filter using dask map_overlap or map_blocks.</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def bandpass(self, low: float, high: float, order: int = 4) -&gt; \"DASFrame\":\n    \"\"\"Apply bandpass filter using dask map_overlap or map_blocks.\"\"\"\n\n    def _filter_func(block, fs, low, high, order):\n        nyq = 0.5 * fs\n        sos = signal.butter(\n            order, [low / nyq, high / nyq], btype=\"band\", output=\"sos\"\n        )\n        # Apply along the last axis (core dimension moved to end by apply_ufunc)\n        return signal.sosfiltfilt(sos, block, axis=-1)\n\n    data_contiguous_time = self._data.chunk({\"time\": -1})\n\n    filtered = xr.apply_ufunc(\n        _filter_func,\n        data_contiguous_time,\n        kwargs={\"fs\": self._fs, \"low\": low, \"high\": high, \"order\": order},\n        input_core_dims=[[\"time\"]],\n        output_core_dims=[[\"time\"]],\n        dask=\"parallelized\",\n        output_dtypes=[data_contiguous_time.dtype],\n    )\n\n    return DASFrame(filtered, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.lowpass","title":"lowpass","text":"<pre><code>lowpass(cutoff: float, order: int = 4) -&gt; DASFrame\n</code></pre> <p>Apply lowpass filter.</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def lowpass(self, cutoff: float, order: int = 4) -&gt; \"DASFrame\":\n    \"\"\"Apply lowpass filter.\"\"\"\n\n    def _filter_func(block, fs, cutoff, order):\n        nyq = 0.5 * fs\n        sos = signal.butter(order, cutoff / nyq, btype=\"low\", output=\"sos\")\n        return signal.sosfiltfilt(sos, block, axis=-1)\n\n    data_contiguous_time = self._data.chunk({\"time\": -1})\n    filtered = xr.apply_ufunc(\n        _filter_func,\n        data_contiguous_time,\n        kwargs={\"fs\": self._fs, \"cutoff\": cutoff, \"order\": order},\n        input_core_dims=[[\"time\"]],\n        output_core_dims=[[\"time\"]],\n        dask=\"parallelized\",\n        output_dtypes=[data_contiguous_time.dtype],\n    )\n    return DASFrame(filtered, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.highpass","title":"highpass","text":"<pre><code>highpass(cutoff: float, order: int = 4) -&gt; DASFrame\n</code></pre> <p>\u9ad8\u901a\u6ee4\u6ce2\u5668\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def highpass(self, cutoff: float, order: int = 4) -&gt; \"DASFrame\":\n    \"\"\"\u9ad8\u901a\u6ee4\u6ce2\u5668\u3002\"\"\"\n\n    def _filter_func(block, fs, cutoff, order):\n        nyq = 0.5 * fs\n        sos = signal.butter(order, cutoff / nyq, btype=\"high\", output=\"sos\")\n        return signal.sosfiltfilt(sos, block, axis=-1)\n\n    data_contiguous_time = self._data.chunk({\"time\": -1})\n    filtered = xr.apply_ufunc(\n        _filter_func,\n        data_contiguous_time,\n        kwargs={\"fs\": self._fs, \"cutoff\": cutoff, \"order\": order},\n        input_core_dims=[[\"time\"]],\n        output_core_dims=[[\"time\"]],\n        dask=\"parallelized\",\n        output_dtypes=[data_contiguous_time.dtype],\n    )\n    return DASFrame(filtered, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.notch","title":"notch","text":"<pre><code>notch(freq: float, Q: float = 30) -&gt; DASFrame\n</code></pre> <p>\u9677\u6ce2\u6ee4\u6ce2\u5668\uff0c\u79fb\u9664\u7279\u5b9a\u9891\u7387\u6210\u5206\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def notch(self, freq: float, Q: float = 30) -&gt; \"DASFrame\":\n    \"\"\"\u9677\u6ce2\u6ee4\u6ce2\u5668\uff0c\u79fb\u9664\u7279\u5b9a\u9891\u7387\u6210\u5206\u3002\"\"\"\n\n    def _filter_func(block, fs, freq, Q):\n        b, a = signal.iirnotch(freq, Q, fs)\n        return signal.filtfilt(b, a, block, axis=-1)\n\n    data_contiguous_time = self._data.chunk({\"time\": -1})\n    filtered = xr.apply_ufunc(\n        _filter_func,\n        data_contiguous_time,\n        kwargs={\"fs\": self._fs, \"freq\": freq, \"Q\": Q},\n        input_core_dims=[[\"time\"]],\n        output_core_dims=[[\"time\"]],\n        dask=\"parallelized\",\n        output_dtypes=[data_contiguous_time.dtype],\n    )\n    return DASFrame(filtered, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.detrend","title":"detrend","text":"<pre><code>detrend(axis: str = 'time') -&gt; DASFrame\n</code></pre> <p>Detrend data.</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def detrend(self, axis: str = \"time\") -&gt; \"DASFrame\":\n    \"\"\"Detrend data.\"\"\"\n\n    def _detrend_func(data):\n        return signal.detrend(data, axis=-1)\n\n    if axis == \"time\":\n        data = self._data.chunk({\"time\": -1})\n    else:\n        data = self._data.chunk({\"distance\": -1})\n\n    detrended = xr.apply_ufunc(\n        _detrend_func,\n        data,\n        input_core_dims=[[axis]],\n        output_core_dims=[[axis]],\n        dask=\"parallelized\",\n        output_dtypes=[data.dtype],\n    )\n\n    return DASFrame(detrended, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.demean","title":"demean","text":"<pre><code>demean(axis: str = 'time') -&gt; DASFrame\n</code></pre> <p>Remove mean value along specified axis.</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def demean(self, axis: str = \"time\") -&gt; \"DASFrame\":\n    \"\"\"Remove mean value along specified axis.\"\"\"\n    dim = \"time\" if axis == \"time\" else \"distance\"\n    demeaned = self._data - self._data.mean(dim=dim)\n    return DASFrame(demeaned, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.normalize","title":"normalize","text":"<pre><code>normalize(method: str = 'minmax') -&gt; DASFrame\n</code></pre> <p>\u5f52\u4e00\u5316\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def normalize(self, method: str = \"minmax\") -&gt; \"DASFrame\":\n    \"\"\"\u5f52\u4e00\u5316\u3002\"\"\"\n    if method == \"zscore\":\n        mean = self._data.mean(dim=\"time\")\n        std = self._data.std(dim=\"time\")\n        std = xr.where(std == 0, 1.0, std)\n        normalized = (self._data - mean) / std\n    else:  # minmax\n        min_val = self._data.min(dim=\"time\")\n        max_val = self._data.max(dim=\"time\")\n        range_val = max_val - min_val\n        range_val = xr.where(range_val == 0, 1.0, range_val)\n        normalized = 2 * (self._data - min_val) / range_val - 1\n\n    return DASFrame(normalized, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.mean","title":"mean","text":"<pre><code>mean(axis: Optional[int] = 0) -&gt; np.ndarray\n</code></pre> <p>\u8ba1\u7b97\u5747\u503c\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>axis</code> <code>Optional[int]</code> <p>\u8ba1\u7b97\u8f74\uff0c0 \u8868\u793a\u6cbf\u65f6\u95f4\u8f74\u8fd4\u56de\u6bcf\u901a\u9053\u7684\u5747\u503c\uff0cNone \u8fd4\u56de\u5168\u5c40\u6807\u91cf</p> <code>0</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def mean(self, axis: Optional[int] = 0) -&gt; np.ndarray:\n    \"\"\"\u8ba1\u7b97\u5747\u503c\u3002\n\n    Args:\n        axis: \u8ba1\u7b97\u8f74\uff0c0 \u8868\u793a\u6cbf\u65f6\u95f4\u8f74\u8fd4\u56de\u6bcf\u901a\u9053\u7684\u5747\u503c\uff0cNone \u8fd4\u56de\u5168\u5c40\u6807\u91cf\n    \"\"\"\n    if axis is None:\n        return self._data.mean().compute().values\n    dim = \"time\" if axis == 0 else \"distance\"\n    return self._data.mean(dim=dim).compute().values\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.std","title":"std","text":"<pre><code>std(axis: Optional[int] = 0) -&gt; np.ndarray\n</code></pre> <p>\u8ba1\u7b97\u6807\u51c6\u5dee\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def std(self, axis: Optional[int] = 0) -&gt; np.ndarray:\n    \"\"\"\u8ba1\u7b97\u6807\u51c6\u5dee\u3002\"\"\"\n    if axis is None:\n        return self._data.std().compute().values\n    dim = \"time\" if axis == 0 else \"distance\"\n    return self._data.std(dim=dim).compute().values\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.max","title":"max","text":"<pre><code>max(axis: Optional[int] = 0) -&gt; np.ndarray\n</code></pre> <p>\u8ba1\u7b97\u6700\u5927\u503c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def max(self, axis: Optional[int] = 0) -&gt; np.ndarray:\n    \"\"\"\u8ba1\u7b97\u6700\u5927\u503c\u3002\"\"\"\n    if axis is None:\n        return self._data.max().compute().values\n    dim = \"time\" if axis == 0 else \"distance\"\n    return self._data.max(dim=dim).compute().values\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.min","title":"min","text":"<pre><code>min(axis: Optional[int] = 0) -&gt; np.ndarray\n</code></pre> <p>\u8ba1\u7b97\u6700\u5c0f\u503c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def min(self, axis: Optional[int] = 0) -&gt; np.ndarray:\n    \"\"\"\u8ba1\u7b97\u6700\u5c0f\u503c\u3002\"\"\"\n    if axis is None:\n        return self._data.min().compute().values\n    dim = \"time\" if axis == 0 else \"distance\"\n    return self._data.min(dim=dim).compute().values\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.rms","title":"rms","text":"<pre><code>rms(window: Optional[int] = None) -&gt; np.ndarray\n</code></pre> <p>\u8ba1\u7b97 RMS\uff08\u5747\u65b9\u6839\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def rms(self, window: Optional[int] = None) -&gt; np.ndarray:\n    \"\"\"\u8ba1\u7b97 RMS\uff08\u5747\u65b9\u6839\uff09\u3002\"\"\"\n    data_sq = self._data**2\n    if window is None:\n        return np.sqrt(data_sq.mean(dim=\"time\").compute().values)\n    else:\n        # \u6ed1\u52a8 RMS\uff0c\u4f7f\u7528 xarray \u6eda\u52a8\u7a97\u53e3\n        rolling_mean = data_sq.rolling(time=window, center=True).mean()\n        return np.sqrt(rolling_mean.compute().values)\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.fft","title":"fft","text":"<pre><code>fft() -&gt; DASFrame\n</code></pre> <p>\u5feb\u901f\u5085\u7acb\u53f6\u53d8\u6362\uff0c\u8ba1\u7b97\u9891\u8c31\u5e45\u5ea6\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def fft(self) -&gt; \"DASFrame\":\n    \"\"\"\u5feb\u901f\u5085\u7acb\u53f6\u53d8\u6362\uff0c\u8ba1\u7b97\u9891\u8c31\u5e45\u5ea6\u3002\"\"\"\n\n    def _fft_func(data):\n        return np.abs(np.fft.fft(data, axis=-1))\n\n    data = self._data.chunk({\"time\": -1})\n    n_samples = data.sizes[\"time\"]\n    freqs = np.fft.fftfreq(n_samples, 1 / self._fs)\n\n    spectrum = xr.apply_ufunc(\n        _fft_func,\n        data,\n        input_core_dims=[[\"time\"]],\n        output_core_dims=[[\"frequency\"]],\n        dask=\"parallelized\",\n        output_dtypes=[float],\n        dask_gufunc_kwargs={\"output_sizes\": {\"frequency\": n_samples}},\n    )\n\n    spectrum = spectrum.assign_coords(frequency=freqs)\n    # \u6ce8\u610f\uff1aFFT \u53d8\u6362\u540e\uff0c'time' \u8f74\u53d8\u6210\u4e86 'frequency' \u8f74\uff0cfs \u542b\u4e49\u4e5f\u53d8\u5316\u4e86\n    # \u8fd9\u91cc\u4e3a\u4e86\u94fe\u5f0f\u8c03\u7528\u8fd4\u56de DASFrame\uff0c\u4f46\u5176\u5185\u90e8\u7ed3\u6784\u5df2\u7ecf\u53d1\u751f\u4e86\u53d8\u5316\uff08domain \u4f4d\u79fb\uff09\n    return DASFrame(spectrum, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.hilbert","title":"hilbert","text":"<pre><code>hilbert() -&gt; DASFrame\n</code></pre> <p>\u5e0c\u5c14\u4f2f\u7279\u53d8\u6362\uff0c\u8fd4\u56de\u89e3\u6790\u4fe1\u53f7\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def hilbert(self) -&gt; \"DASFrame\":\n    \"\"\"\u5e0c\u5c14\u4f2f\u7279\u53d8\u6362\uff0c\u8fd4\u56de\u89e3\u6790\u4fe1\u53f7\u3002\"\"\"\n\n    def _hilbert_func(data):\n        return signal.hilbert(data, axis=-1)\n\n    data = self._data.chunk({\"time\": -1})\n    analytical = xr.apply_ufunc(\n        _hilbert_func,\n        data,\n        input_core_dims=[[\"time\"]],\n        output_core_dims=[[\"time\"]],\n        dask=\"parallelized\",\n        output_dtypes=[complex],\n    )\n    return DASFrame(analytical, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.envelope","title":"envelope","text":"<pre><code>envelope() -&gt; DASFrame\n</code></pre> <p>\u63d0\u53d6\u4fe1\u53f7\u5305\u7edc\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def envelope(self) -&gt; \"DASFrame\":\n    \"\"\"\u63d0\u53d6\u4fe1\u53f7\u5305\u7edc\u3002\"\"\"\n    analytical = self.hilbert()\n    return analytical.abs()\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.scale","title":"scale","text":"<pre><code>scale(factor: float = 1.0) -&gt; DASFrame\n</code></pre> <p>Scale amplitude.</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def scale(self, factor: float = 1.0) -&gt; \"DASFrame\":\n    \"\"\"Scale amplitude.\"\"\"\n    scaled = self._data * factor\n    return DASFrame(scaled, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.abs","title":"abs","text":"<pre><code>abs() -&gt; DASFrame\n</code></pre> <p>Absolute value.</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def abs(self) -&gt; \"DASFrame\":\n    \"\"\"Absolute value.\"\"\"\n    return DASFrame(np.abs(self._data), self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.stft","title":"stft","text":"<pre><code>stft(\n    nperseg: int = 256, noverlap: Optional[int] = None\n) -&gt; DASFrame\n</code></pre> <p>\u77ed\u65f6\u5085\u7acb\u53f6\u53d8\u6362\uff0c\u8fdb\u884c\u65f6\u9891\u5206\u6790\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def stft(self, nperseg: int = 256, noverlap: Optional[int] = None) -&gt; \"DASFrame\":\n    \"\"\"\u77ed\u65f6\u5085\u7acb\u53f6\u53d8\u6362\uff0c\u8fdb\u884c\u65f6\u9891\u5206\u6790\u3002\"\"\"\n    if noverlap is None:\n        noverlap = nperseg // 2\n\n    data = self.collect()\n    # signal.stft for 2D data with axis=0:\n    # returns f, t, Zxx where Zxx shape is (freq, distance, time)\n    f, t, Zxx = signal.stft(\n        data, fs=self._fs, nperseg=nperseg, noverlap=noverlap, axis=0\n    )\n\n    # \u5c06 Zxx \u4ece (freq, distance, time) \u8f6c\u6362\u4e3a (freq, time, distance)\n    Zxx_abs = np.abs(Zxx).transpose(0, 2, 1)\n\n    # \u5c06\u7ed3\u679c\u5305\u88c5\u56de xr.DataArray\n    stft_data = xr.DataArray(\n        Zxx_abs,\n        dims=(\"frequency\", \"time\", \"distance\"),\n        coords={\n            \"frequency\": f,\n            \"time\": t,\n            \"distance\": self._data.distance,\n        },\n        name=\"stft\",\n        attrs=self._data.attrs,\n    )\n    return DASFrame(stft_data, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.fk_filter","title":"fk_filter","text":"<pre><code>fk_filter(\n    v_min: Optional[float] = None,\n    v_max: Optional[float] = None,\n    dx: float = 1.0,\n) -&gt; DASFrame\n</code></pre> <p>F-K \u6ee4\u6ce2 (\u901f\u5ea6\u6ee4\u6ce2)\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def fk_filter(\n    self,\n    v_min: Optional[float] = None,\n    v_max: Optional[float] = None,\n    dx: float = 1.0,\n) -&gt; \"DASFrame\":\n    \"\"\"F-K \u6ee4\u6ce2 (\u901f\u5ea6\u6ee4\u6ce2)\u3002\"\"\"\n    data = self.collect()\n    from ..config.sampling_config import SamplingConfig\n    from ..processing.das_processor import DASProcessor\n\n    config = SamplingConfig(fs=self._fs, channels=data.shape[1])\n    processor = DASProcessor(config)\n    filtered = processor.FKFilter(data, v_min=v_min, v_max=v_max, dx=dx)\n    return DASFrame(filtered, self._fs, dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.threshold_detect","title":"threshold_detect","text":"<pre><code>threshold_detect(\n    threshold: Optional[float] = None, sigma: float = 3.0\n) -&gt; np.ndarray\n</code></pre> <p>\u9608\u503c\u68c0\u6d4b\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def threshold_detect(\n    self, threshold: Optional[float] = None, sigma: float = 3.0\n) -&gt; np.ndarray:\n    \"\"\"\u9608\u503c\u68c0\u6d4b\u3002\"\"\"\n    data = self.collect()\n    if threshold is None:\n        threshold = np.mean(data) + sigma * np.std(data)\n    return np.abs(data) &gt; threshold\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.plot_ts","title":"plot_ts","text":"<pre><code>plot_ts(\n    ch: Optional[int] = None,\n    title: str = \"Time Series\",\n    ax: Optional[Axes] = None,\n    **kwargs,\n) -&gt; plt.Figure\n</code></pre> <p>\u7ed8\u5236\u65f6\u95f4\u5e8f\u5217\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def plot_ts(\n    self,\n    ch: Optional[int] = None,\n    title: str = \"Time Series\",\n    ax: Optional[plt.Axes] = None,\n    **kwargs,\n) -&gt; plt.Figure:\n    \"\"\"\u7ed8\u5236\u65f6\u95f4\u5e8f\u5217\u3002\"\"\"\n    data = self.collect()\n\n    if ax is None:\n        fig, ax = plt.subplots(figsize=(10, 4))\n    else:\n        if ax.figure is None:\n            raise ValueError(\"Provided ax must belong to a figure\")\n        fig = cast(plt.Figure, ax.figure)\n\n    t = np.arange(data.shape[0]) / self._fs\n    if ch is None:\n        ax.plot(t, data[:, : min(5, data.shape[1])], alpha=0.7)\n    else:\n        ax.plot(t, data[:, ch])\n\n    ax.set_xlabel(\"Time (s)\")\n    ax.set_ylabel(\"Amplitude\")\n    ax.set_title(title)\n    ax.grid(True, alpha=0.3)\n    return fig\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.plot_spectrum","title":"plot_spectrum","text":"<pre><code>plot_spectrum(\n    ch: int = 0,\n    title: str = \"Spectrum\",\n    ax: Optional[Axes] = None,\n    **kwargs: Any,\n) -&gt; plt.Figure\n</code></pre> <p>\u7ed8\u5236\u9891\u8c31\u56fe (FFT)\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def plot_spectrum(\n    self,\n    ch: int = 0,\n    title: str = \"Spectrum\",\n    ax: Optional[plt.Axes] = None,\n    **kwargs: Any,\n) -&gt; plt.Figure:\n    \"\"\"\u7ed8\u5236\u9891\u8c31\u56fe (FFT)\u3002\"\"\"\n    data = self.collect()\n    ch_data = data[:, ch]\n\n    from ..visualization.das_visualizer import SpectrumPlot\n\n    plotter = SpectrumPlot()\n    # \u8ba1\u7b97\u9891\u8c31 (Welch \u65b9\u6cd5)\n    from scipy import signal\n\n    n = len(ch_data)\n    nperseg = min(2048, n // 4)\n    freqs, psd = signal.welch(\n        ch_data, fs=self._fs, nperseg=nperseg, scaling=\"spectrum\"\n    )\n    mags = np.sqrt(psd)\n\n    fig = plotter.plot(freqs, mags, title=title, ax=ax, **kwargs)\n    return fig\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.plot_spectrogram","title":"plot_spectrogram","text":"<pre><code>plot_spectrogram(\n    ch: int = 0,\n    title: str = \"Spectrogram\",\n    window_size: int = 1024,\n    overlap: float = 0.75,\n    ax: Optional[Axes] = None,\n    **kwargs: Any,\n) -&gt; plt.Figure\n</code></pre> <p>\u7ed8\u5236\u65f6\u9891\u56fe (STFT)\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def plot_spectrogram(\n    self,\n    ch: int = 0,\n    title: str = \"Spectrogram\",\n    window_size: int = 1024,\n    overlap: float = 0.75,\n    ax: Optional[plt.Axes] = None,\n    **kwargs: Any,\n) -&gt; plt.Figure:\n    \"\"\"\u7ed8\u5236\u65f6\u9891\u56fe (STFT)\u3002\"\"\"\n    data = self.collect()\n    ch_data = data[:, ch]\n\n    from ..visualization.das_visualizer import SpectrogramPlot\n\n    plotter = SpectrogramPlot()\n    fig = plotter.plot(\n        ch_data,\n        self._fs,\n        window_size=window_size,\n        overlap=overlap,\n        title=title,\n        ax=ax,\n        **kwargs,\n    )\n    return fig\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.DASFrame.plot_heatmap","title":"plot_heatmap","text":"<pre><code>plot_heatmap(\n    channels: Optional[slice] = None,\n    t_range: Optional[slice] = None,\n    title: str = \"DAS Waterfall\",\n    cmap: str = \"RdBu_r\",\n    ax: Optional[Axes] = None,\n    **kwargs: Any,\n) -&gt; plt.Figure\n</code></pre> <p>\u7ed8\u5236\u70ed\u56fe\uff08\u7011\u5e03\u56fe\uff09\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>channels</code> <code>Optional[slice]</code> <p>\u901a\u9053\u5207\u7247\uff0c\u4f8b\u5982 slice(10, 60, 5)\u3002</p> <code>None</code> <code>t_range</code> <code>Optional[slice]</code> <p>\u65f6\u95f4\u6837\u672c\u5207\u7247\uff08\u4ee5\u6837\u672c\u4e3a\u5355\u4f4d\uff09\uff0c\u4f8b\u5982 slice(0, 1000)\u3002</p> <code>None</code> <code>title</code> <code>str</code> <p>\u56fe\u6807\u9898\u3002</p> <code>'DAS Waterfall'</code> <code>cmap</code> <code>str</code> <p>\u989c\u8272\u6620\u5c04\u3002</p> <code>'RdBu_r'</code> <code>ax</code> <code>Optional[Axes]</code> <p>\u53ef\u9009\u7684 matplotlib Axes \u5bf9\u8c61\u3002</p> <code>None</code> <code>**kwargs</code> <code>Any</code> <p>\u4f20\u9012\u7ed9 imshow \u7684\u989d\u5916\u53c2\u6570\u3002</p> <code>{}</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Figure</code> <p>matplotlib Figure \u5bf9\u8c61\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def plot_heatmap(\n    self,\n    channels: Optional[builtins.slice] = None,\n    t_range: Optional[builtins.slice] = None,\n    title: str = \"DAS Waterfall\",\n    cmap: str = \"RdBu_r\",\n    ax: Optional[plt.Axes] = None,\n    **kwargs: Any,\n) -&gt; plt.Figure:\n    \"\"\"\u7ed8\u5236\u70ed\u56fe\uff08\u7011\u5e03\u56fe\uff09\u3002\n\n    Args:\n        channels: \u901a\u9053\u5207\u7247\uff0c\u4f8b\u5982 slice(10, 60, 5)\u3002\n        t_range: \u65f6\u95f4\u6837\u672c\u5207\u7247\uff08\u4ee5\u6837\u672c\u4e3a\u5355\u4f4d\uff09\uff0c\u4f8b\u5982 slice(0, 1000)\u3002\n        title: \u56fe\u6807\u9898\u3002\n        cmap: \u989c\u8272\u6620\u5c04\u3002\n        ax: \u53ef\u9009\u7684 matplotlib Axes \u5bf9\u8c61\u3002\n        **kwargs: \u4f20\u9012\u7ed9 imshow \u7684\u989d\u5916\u53c2\u6570\u3002\n\n    Returns:\n        matplotlib Figure \u5bf9\u8c61\u3002\n    \"\"\"\n    data = self.collect()\n\n    # \u5e94\u7528\u65f6\u95f4\u5207\u7247\n    if t_range is not None:\n        data = data[t_range, :]\n        t_start = (t_range.start or 0) / self._fs\n    else:\n        t_start = 0.0\n\n    # \u5e94\u7528\u901a\u9053\u5207\u7247\n    if channels is not None:\n        data = data[:, channels]\n        ch_start = channels.start or 0\n    else:\n        ch_start = 0\n\n    if ax is None:\n        fig, ax = plt.subplots(figsize=(10, 6))\n    else:\n        if ax.figure is None:\n            raise ValueError(\"Provided ax must belong to a figure\")\n        fig = cast(plt.Figure, ax.figure)\n\n    extent = (\n        ch_start,\n        ch_start + float(data.shape[1]),\n        t_start + float(data.shape[0] / self._fs),\n        t_start,\n    )\n    vmax = np.percentile(np.abs(data), 98)\n    im = ax.imshow(\n        data,\n        aspect=\"auto\",\n        cmap=cmap,\n        extent=extent,\n        vmin=-vmax,\n        vmax=vmax,\n        **kwargs,\n    )\n\n    ax.set_xlabel(\"Channel\")\n    ax.set_ylabel(\"Time (s)\")\n    ax.set_title(title)\n    if ax is not None:\n        plt.colorbar(im, ax=ax, label=\"Amplitude\")\n    return fig\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.from_array","title":"from_array","text":"<pre><code>from_array(\n    data: ndarray, fs: float, **kwargs: Any\n) -&gt; DASFrame\n</code></pre> <p>\u4eceNumPy\u6570\u7ec4\u521b\u5efaDASFrame\u5bf9\u8c61\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>DAS\u6570\u636e\u6570\u7ec4\uff0c\u5f62\u72b6\u4e3a(\u65f6\u95f4\u70b9\u6570, \u901a\u9053\u6570)</p> \u5fc5\u9700 <code>fs</code> <code>float</code> <p>\u91c7\u6837\u9891\u7387(Hz)</p> \u5fc5\u9700 <code>**kwargs</code> <code>Any</code> <p>\u5176\u4ed6\u5143\u6570\u636e</p> <code>{}</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>DASFrame</code> <code>DASFrame</code> <p>\u5305\u542b\u6570\u636e\u7684DASFrame\u5bf9\u8c61</p> <p>\u793a\u4f8b\uff1a</p> <pre><code>&gt;&gt;&gt; import numpy as np\n&gt;&gt;&gt; from DASMatrix.api import df\n&gt;&gt;&gt; data = np.random.randn(10000, 64)\n&gt;&gt;&gt; frame = df.from_array(data, fs=10000)\n</code></pre> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/df.py</code> <pre><code>def from_array(data: np.ndarray, fs: float, **kwargs: Any) -&gt; \"DASFrame\":\n    \"\"\"\u4eceNumPy\u6570\u7ec4\u521b\u5efaDASFrame\u5bf9\u8c61\u3002\n\n    Args:\n        data: DAS\u6570\u636e\u6570\u7ec4\uff0c\u5f62\u72b6\u4e3a(\u65f6\u95f4\u70b9\u6570, \u901a\u9053\u6570)\n        fs: \u91c7\u6837\u9891\u7387(Hz)\n        **kwargs: \u5176\u4ed6\u5143\u6570\u636e\n\n    Returns:\n        DASFrame: \u5305\u542b\u6570\u636e\u7684DASFrame\u5bf9\u8c61\n\n    Examples:\n        &gt;&gt;&gt; import numpy as np\n        &gt;&gt;&gt; from DASMatrix.api import df\n        &gt;&gt;&gt; data = np.random.randn(10000, 64)\n        &gt;&gt;&gt; frame = df.from_array(data, fs=10000)\n    \"\"\"\n    if data.ndim == 1:\n        data = data.reshape(-1, 1)\n\n    return _create_dasframe(data, fs=fs, **kwargs)\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.read","title":"read","text":"<pre><code>read(\n    path: str,\n    fs: Optional[float] = None,\n    channels: Optional[int] = None,\n    byte_order: str = \"little\",\n    **kwargs: Any,\n) -&gt; DASFrame\n</code></pre> <p>\u4ece\u6587\u4ef6\u8bfb\u53d6DAS\u6570\u636e\uff0c\u8fd4\u56deDASFrame\u5bf9\u8c61\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>path</code> <code>str</code> <p>\u6570\u636e\u6587\u4ef6\u8def\u5f84</p> \u5fc5\u9700 <code>fs</code> <code>Optional[float]</code> <p>\u91c7\u6837\u9891\u7387(Hz)\uff0cH5\u6587\u4ef6\u53ef\u81ea\u52a8\u68c0\u6d4b\uff0cDAT\u6587\u4ef6\u5fc5\u987b\u6307\u5b9a</p> <code>None</code> <code>channels</code> <code>Optional[int]</code> <p>\u901a\u9053\u6570\uff0cH5\u6587\u4ef6\u53ef\u81ea\u52a8\u68c0\u6d4b\uff0cDAT\u6587\u4ef6\u5fc5\u987b\u6307\u5b9a</p> <code>None</code> <code>byte_order</code> <code>str</code> <p>\u5b57\u8282\u5e8f\uff0c'big' \u6216 'little'\uff0c\u4ec5\u7528\u4e8e DAT \u6587\u4ef6</p> <code>'little'</code> <code>**kwargs</code> <code>Any</code> <p>\u4f20\u9012\u7ed9 DASFrame \u7684\u5176\u4ed6\u5143\u6570\u636e</p> <code>{}</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>DASFrame</code> <code>DASFrame</code> <p>\u5305\u542bDAS\u6570\u636e\u7684DASFrame\u5bf9\u8c61</p> <p>\u793a\u4f8b\uff1a</p> <pre><code>&gt;&gt;&gt; # \u8bfb\u53d6 H5 \u6587\u4ef6\uff08\u81ea\u52a8\u68c0\u6d4b\u53c2\u6570\uff09\n&gt;&gt;&gt; frame = df.read(\"data.h5\")\n</code></pre> <pre><code>&gt;&gt;&gt; # \u8bfb\u53d6 DAT \u6587\u4ef6\uff08\u9700\u8981\u6307\u5b9a\u53c2\u6570\uff09\n&gt;&gt;&gt; frame = df.read(\"data.dat\", fs=10000, channels=512)\n</code></pre> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/df.py</code> <pre><code>def read(\n    path: str,\n    fs: Optional[float] = None,\n    channels: Optional[int] = None,\n    byte_order: str = \"little\",\n    **kwargs: Any,\n) -&gt; \"DASFrame\":\n    \"\"\"\u4ece\u6587\u4ef6\u8bfb\u53d6DAS\u6570\u636e\uff0c\u8fd4\u56deDASFrame\u5bf9\u8c61\u3002\n\n    Args:\n        path: \u6570\u636e\u6587\u4ef6\u8def\u5f84\n        fs: \u91c7\u6837\u9891\u7387(Hz)\uff0cH5\u6587\u4ef6\u53ef\u81ea\u52a8\u68c0\u6d4b\uff0cDAT\u6587\u4ef6\u5fc5\u987b\u6307\u5b9a\n        channels: \u901a\u9053\u6570\uff0cH5\u6587\u4ef6\u53ef\u81ea\u52a8\u68c0\u6d4b\uff0cDAT\u6587\u4ef6\u5fc5\u987b\u6307\u5b9a\n        byte_order: \u5b57\u8282\u5e8f\uff0c'big' \u6216 'little'\uff0c\u4ec5\u7528\u4e8e DAT \u6587\u4ef6\n        **kwargs: \u4f20\u9012\u7ed9 DASFrame \u7684\u5176\u4ed6\u5143\u6570\u636e\n\n    Returns:\n        DASFrame: \u5305\u542bDAS\u6570\u636e\u7684DASFrame\u5bf9\u8c61\n\n    Examples:\n        &gt;&gt;&gt; # \u8bfb\u53d6 H5 \u6587\u4ef6\uff08\u81ea\u52a8\u68c0\u6d4b\u53c2\u6570\uff09\n        &gt;&gt;&gt; frame = df.read(\"data.h5\")\n\n        &gt;&gt;&gt; # \u8bfb\u53d6 DAT \u6587\u4ef6\uff08\u9700\u8981\u6307\u5b9a\u53c2\u6570\uff09\n        &gt;&gt;&gt; frame = df.read(\"data.dat\", fs=10000, channels=512)\n    \"\"\"\n    ext = os.path.splitext(path)[1].lower()\n\n    if ext in (\".h5\", \".hdf5\"):\n        return _read_h5(path, fs=fs, **kwargs)\n    elif ext == \".dat\":\n        if fs is None or channels is None:\n            raise ValueError(\n                \"\u8bfb\u53d6 DAT \u6587\u4ef6\u9700\u8981\u6307\u5b9a fs\uff08\u91c7\u6837\u9891\u7387\uff09\u548c channels\uff08\u901a\u9053\u6570\uff09\u53c2\u6570\"\n            )\n        return _read_dat(\n            path, fs=fs, channels=channels, byte_order=byte_order, **kwargs\n        )\n    else:\n        raise ValueError(f\"\u4e0d\u652f\u6301\u7684\u6587\u4ef6\u7c7b\u578b: {ext}\")\n</code></pre>"},{"location":"reference/DASMatrix/api/#DASMatrix.api.stream","title":"stream","text":"<pre><code>stream(\n    url: str,\n    chunk: int = 1024,\n    fs: float = 10000.0,\n    **kwargs: Any,\n) -&gt; DASFrame\n</code></pre> <p>\u521b\u5efa\u7528\u4e8e\u6d41\u5f0f\u5904\u7406\u7684DASFrame\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>url</code> <code>str</code> <p>\u6570\u636e\u6d41URL\uff0c\u4f8b\u5982 \"tcp://0.0.0.0:9000\"</p> \u5fc5\u9700 <code>chunk</code> <code>int</code> <p>\u6bcf\u6b21\u5904\u7406\u7684\u6570\u636e\u5757\u5927\u5c0f</p> <code>1024</code> <code>fs</code> <code>float</code> <p>\u9884\u671f\u7684\u91c7\u6837\u9891\u7387(Hz)</p> <code>10000.0</code> <code>**kwargs</code> <code>Any</code> <p>\u5176\u4ed6\u53c2\u6570</p> <code>{}</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>DASFrame</code> <code>DASFrame</code> <p>\u7528\u4e8e\u6d41\u5904\u7406\u7684DASFrame\u5bf9\u8c61</p> Note <p>\u5f53\u524d\u4e3a\u5360\u4f4d\u5b9e\u73b0\uff0c\u6d41\u5904\u7406\u529f\u80fd\u5c06\u5728\u540e\u7eed\u7248\u672c\u4e2d\u5b8c\u5584\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/df.py</code> <pre><code>def stream(\n    url: str, chunk: int = 1024, fs: float = 10000.0, **kwargs: Any\n) -&gt; \"DASFrame\":\n    \"\"\"\u521b\u5efa\u7528\u4e8e\u6d41\u5f0f\u5904\u7406\u7684DASFrame\u3002\n\n    Args:\n        url: \u6570\u636e\u6d41URL\uff0c\u4f8b\u5982 \"tcp://0.0.0.0:9000\"\n        chunk: \u6bcf\u6b21\u5904\u7406\u7684\u6570\u636e\u5757\u5927\u5c0f\n        fs: \u9884\u671f\u7684\u91c7\u6837\u9891\u7387(Hz)\n        **kwargs: \u5176\u4ed6\u53c2\u6570\n\n    Returns:\n        DASFrame: \u7528\u4e8e\u6d41\u5904\u7406\u7684DASFrame\u5bf9\u8c61\n\n    Note:\n        \u5f53\u524d\u4e3a\u5360\u4f4d\u5b9e\u73b0\uff0c\u6d41\u5904\u7406\u529f\u80fd\u5c06\u5728\u540e\u7eed\u7248\u672c\u4e2d\u5b8c\u5584\u3002\n    \"\"\"\n    # TODO: \u5b9e\u73b0\u771f\u6b63\u7684\u6d41\u5904\u7406\n    return _create_dasframe(\n        np.array([]).reshape(0, 1),\n        fs=fs,\n        is_stream=True,\n        stream_url=url,\n        chunk_size=chunk,\n        **kwargs,\n    )\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/","title":"dasframe","text":""},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe","title":"dasframe","text":""},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame","title":"DASFrame","text":"<pre><code>DASFrame(\n    data: Union[DataArray, ndarray, Array, DASFrame],\n    fs: float,\n    dx: float = 1.0,\n    **metadata: Any,\n)\n</code></pre> <p>DAS \u6570\u636e\u5904\u7406\u6838\u5fc3\u7c7b (Xarray/Dask Backend)\u3002</p> <p>\u6240\u6709\u4fe1\u53f7\u5904\u7406\u64cd\u4f5c\u57fa\u4e8e xarray \u548c dask \u8fdb\u884c\u5ef6\u8fdf\u8ba1\u7b97\u3002</p> <p>Initialize DASFrame.</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>Union[DataArray, ndarray, Array, DASFrame]</code> <p>Input data.</p> \u5fc5\u9700 <code>fs</code> <code>float</code> <p>Sampling frequency (Hz).</p> \u5fc5\u9700 <code>dx</code> <code>float</code> <p>Channel spacing (m).</p> <code>1.0</code> <code>**metadata</code> <code>Any</code> <p>Additional metadata.</p> <code>{}</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def __init__(\n    self,\n    data: Union[xr.DataArray, np.ndarray, da.Array, \"DASFrame\"],\n    fs: float,\n    dx: float = 1.0,\n    **metadata: Any,\n) -&gt; None:\n    \"\"\"Initialize DASFrame.\n\n    Args:\n        data: Input data.\n        fs: Sampling frequency (Hz).\n        dx: Channel spacing (m).\n        **metadata: Additional metadata.\n    \"\"\"\n    if isinstance(data, DASFrame):\n        # Copy constructor roughly\n        self._data = data._data\n        self._fs = data.fs\n        self._dx = getattr(data, \"_dx\", dx)\n        self._metadata = {**data._metadata, **metadata}\n        return\n\n    self._fs = fs\n    self._dx = dx\n    self._metadata = metadata\n\n    if isinstance(data, xr.DataArray):\n        # Ensure order is (time, distance)\n        if \"time\" in data.dims and data.dims[0] != \"time\":\n            data = data.transpose(\"time\", ...)\n        self._data = data\n    else:\n        # Wrap numpy/dask array into xarray\n        # Assume dims are (time, channel)\n        if not isinstance(data, (np.ndarray, da.Array)):\n            data = np.asarray(data)\n\n        # Create coordinates\n        nt, nx = data.shape\n        coords = {\n            \"time\": np.arange(nt) / fs,\n            \"distance\": np.arange(nx) * dx,\n        }\n\n        self._data = xr.DataArray(\n            data,\n            dims=(\"time\", \"distance\"),\n            coords=coords,\n            name=\"das_strain\",\n            attrs={\"fs\": fs, \"dx\": dx, **metadata},\n        )\n\n        # Ensure it is chunked (dask backed) if it isn't already\n        if not self._data.chunks:\n            self._data = self._data.chunk({\"time\": \"auto\", \"distance\": -1})\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.data","title":"data  <code>property</code>","text":"<pre><code>data: DataArray\n</code></pre> <p>Access underlying xarray DataArray.</p>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.shape","title":"shape  <code>property</code>","text":"<pre><code>shape: Tuple[int, ...]\n</code></pre> <p>Get shape of data.</p>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.collect","title":"collect","text":"<pre><code>collect() -&gt; np.ndarray\n</code></pre> <p>Compute and return numpy array.</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def collect(self) -&gt; np.ndarray:\n    \"\"\"Compute and return numpy array.\"\"\"\n    return self._data.compute().values\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.slice","title":"slice","text":"<pre><code>slice(\n    t: slice = slice(None), x: slice = slice(None)\n) -&gt; DASFrame\n</code></pre> <p>Slice data.</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def slice(self, t: slice = slice(None), x: slice = slice(None)) -&gt; \"DASFrame\":\n    \"\"\"Slice data.\"\"\"\n    # xarray is slicing by index here (isel)\n    sliced = self._data.isel(time=t, distance=x)\n    return DASFrame(sliced, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.bandpass","title":"bandpass","text":"<pre><code>bandpass(\n    low: float, high: float, order: int = 4\n) -&gt; DASFrame\n</code></pre> <p>Apply bandpass filter using dask map_overlap or map_blocks.</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def bandpass(self, low: float, high: float, order: int = 4) -&gt; \"DASFrame\":\n    \"\"\"Apply bandpass filter using dask map_overlap or map_blocks.\"\"\"\n\n    def _filter_func(block, fs, low, high, order):\n        nyq = 0.5 * fs\n        sos = signal.butter(\n            order, [low / nyq, high / nyq], btype=\"band\", output=\"sos\"\n        )\n        # Apply along the last axis (core dimension moved to end by apply_ufunc)\n        return signal.sosfiltfilt(sos, block, axis=-1)\n\n    data_contiguous_time = self._data.chunk({\"time\": -1})\n\n    filtered = xr.apply_ufunc(\n        _filter_func,\n        data_contiguous_time,\n        kwargs={\"fs\": self._fs, \"low\": low, \"high\": high, \"order\": order},\n        input_core_dims=[[\"time\"]],\n        output_core_dims=[[\"time\"]],\n        dask=\"parallelized\",\n        output_dtypes=[data_contiguous_time.dtype],\n    )\n\n    return DASFrame(filtered, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.lowpass","title":"lowpass","text":"<pre><code>lowpass(cutoff: float, order: int = 4) -&gt; DASFrame\n</code></pre> <p>Apply lowpass filter.</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def lowpass(self, cutoff: float, order: int = 4) -&gt; \"DASFrame\":\n    \"\"\"Apply lowpass filter.\"\"\"\n\n    def _filter_func(block, fs, cutoff, order):\n        nyq = 0.5 * fs\n        sos = signal.butter(order, cutoff / nyq, btype=\"low\", output=\"sos\")\n        return signal.sosfiltfilt(sos, block, axis=-1)\n\n    data_contiguous_time = self._data.chunk({\"time\": -1})\n    filtered = xr.apply_ufunc(\n        _filter_func,\n        data_contiguous_time,\n        kwargs={\"fs\": self._fs, \"cutoff\": cutoff, \"order\": order},\n        input_core_dims=[[\"time\"]],\n        output_core_dims=[[\"time\"]],\n        dask=\"parallelized\",\n        output_dtypes=[data_contiguous_time.dtype],\n    )\n    return DASFrame(filtered, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.highpass","title":"highpass","text":"<pre><code>highpass(cutoff: float, order: int = 4) -&gt; DASFrame\n</code></pre> <p>\u9ad8\u901a\u6ee4\u6ce2\u5668\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def highpass(self, cutoff: float, order: int = 4) -&gt; \"DASFrame\":\n    \"\"\"\u9ad8\u901a\u6ee4\u6ce2\u5668\u3002\"\"\"\n\n    def _filter_func(block, fs, cutoff, order):\n        nyq = 0.5 * fs\n        sos = signal.butter(order, cutoff / nyq, btype=\"high\", output=\"sos\")\n        return signal.sosfiltfilt(sos, block, axis=-1)\n\n    data_contiguous_time = self._data.chunk({\"time\": -1})\n    filtered = xr.apply_ufunc(\n        _filter_func,\n        data_contiguous_time,\n        kwargs={\"fs\": self._fs, \"cutoff\": cutoff, \"order\": order},\n        input_core_dims=[[\"time\"]],\n        output_core_dims=[[\"time\"]],\n        dask=\"parallelized\",\n        output_dtypes=[data_contiguous_time.dtype],\n    )\n    return DASFrame(filtered, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.notch","title":"notch","text":"<pre><code>notch(freq: float, Q: float = 30) -&gt; DASFrame\n</code></pre> <p>\u9677\u6ce2\u6ee4\u6ce2\u5668\uff0c\u79fb\u9664\u7279\u5b9a\u9891\u7387\u6210\u5206\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def notch(self, freq: float, Q: float = 30) -&gt; \"DASFrame\":\n    \"\"\"\u9677\u6ce2\u6ee4\u6ce2\u5668\uff0c\u79fb\u9664\u7279\u5b9a\u9891\u7387\u6210\u5206\u3002\"\"\"\n\n    def _filter_func(block, fs, freq, Q):\n        b, a = signal.iirnotch(freq, Q, fs)\n        return signal.filtfilt(b, a, block, axis=-1)\n\n    data_contiguous_time = self._data.chunk({\"time\": -1})\n    filtered = xr.apply_ufunc(\n        _filter_func,\n        data_contiguous_time,\n        kwargs={\"fs\": self._fs, \"freq\": freq, \"Q\": Q},\n        input_core_dims=[[\"time\"]],\n        output_core_dims=[[\"time\"]],\n        dask=\"parallelized\",\n        output_dtypes=[data_contiguous_time.dtype],\n    )\n    return DASFrame(filtered, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.detrend","title":"detrend","text":"<pre><code>detrend(axis: str = 'time') -&gt; DASFrame\n</code></pre> <p>Detrend data.</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def detrend(self, axis: str = \"time\") -&gt; \"DASFrame\":\n    \"\"\"Detrend data.\"\"\"\n\n    def _detrend_func(data):\n        return signal.detrend(data, axis=-1)\n\n    if axis == \"time\":\n        data = self._data.chunk({\"time\": -1})\n    else:\n        data = self._data.chunk({\"distance\": -1})\n\n    detrended = xr.apply_ufunc(\n        _detrend_func,\n        data,\n        input_core_dims=[[axis]],\n        output_core_dims=[[axis]],\n        dask=\"parallelized\",\n        output_dtypes=[data.dtype],\n    )\n\n    return DASFrame(detrended, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.demean","title":"demean","text":"<pre><code>demean(axis: str = 'time') -&gt; DASFrame\n</code></pre> <p>Remove mean value along specified axis.</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def demean(self, axis: str = \"time\") -&gt; \"DASFrame\":\n    \"\"\"Remove mean value along specified axis.\"\"\"\n    dim = \"time\" if axis == \"time\" else \"distance\"\n    demeaned = self._data - self._data.mean(dim=dim)\n    return DASFrame(demeaned, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.normalize","title":"normalize","text":"<pre><code>normalize(method: str = 'minmax') -&gt; DASFrame\n</code></pre> <p>\u5f52\u4e00\u5316\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def normalize(self, method: str = \"minmax\") -&gt; \"DASFrame\":\n    \"\"\"\u5f52\u4e00\u5316\u3002\"\"\"\n    if method == \"zscore\":\n        mean = self._data.mean(dim=\"time\")\n        std = self._data.std(dim=\"time\")\n        std = xr.where(std == 0, 1.0, std)\n        normalized = (self._data - mean) / std\n    else:  # minmax\n        min_val = self._data.min(dim=\"time\")\n        max_val = self._data.max(dim=\"time\")\n        range_val = max_val - min_val\n        range_val = xr.where(range_val == 0, 1.0, range_val)\n        normalized = 2 * (self._data - min_val) / range_val - 1\n\n    return DASFrame(normalized, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.mean","title":"mean","text":"<pre><code>mean(axis: Optional[int] = 0) -&gt; np.ndarray\n</code></pre> <p>\u8ba1\u7b97\u5747\u503c\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>axis</code> <code>Optional[int]</code> <p>\u8ba1\u7b97\u8f74\uff0c0 \u8868\u793a\u6cbf\u65f6\u95f4\u8f74\u8fd4\u56de\u6bcf\u901a\u9053\u7684\u5747\u503c\uff0cNone \u8fd4\u56de\u5168\u5c40\u6807\u91cf</p> <code>0</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def mean(self, axis: Optional[int] = 0) -&gt; np.ndarray:\n    \"\"\"\u8ba1\u7b97\u5747\u503c\u3002\n\n    Args:\n        axis: \u8ba1\u7b97\u8f74\uff0c0 \u8868\u793a\u6cbf\u65f6\u95f4\u8f74\u8fd4\u56de\u6bcf\u901a\u9053\u7684\u5747\u503c\uff0cNone \u8fd4\u56de\u5168\u5c40\u6807\u91cf\n    \"\"\"\n    if axis is None:\n        return self._data.mean().compute().values\n    dim = \"time\" if axis == 0 else \"distance\"\n    return self._data.mean(dim=dim).compute().values\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.std","title":"std","text":"<pre><code>std(axis: Optional[int] = 0) -&gt; np.ndarray\n</code></pre> <p>\u8ba1\u7b97\u6807\u51c6\u5dee\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def std(self, axis: Optional[int] = 0) -&gt; np.ndarray:\n    \"\"\"\u8ba1\u7b97\u6807\u51c6\u5dee\u3002\"\"\"\n    if axis is None:\n        return self._data.std().compute().values\n    dim = \"time\" if axis == 0 else \"distance\"\n    return self._data.std(dim=dim).compute().values\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.max","title":"max","text":"<pre><code>max(axis: Optional[int] = 0) -&gt; np.ndarray\n</code></pre> <p>\u8ba1\u7b97\u6700\u5927\u503c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def max(self, axis: Optional[int] = 0) -&gt; np.ndarray:\n    \"\"\"\u8ba1\u7b97\u6700\u5927\u503c\u3002\"\"\"\n    if axis is None:\n        return self._data.max().compute().values\n    dim = \"time\" if axis == 0 else \"distance\"\n    return self._data.max(dim=dim).compute().values\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.min","title":"min","text":"<pre><code>min(axis: Optional[int] = 0) -&gt; np.ndarray\n</code></pre> <p>\u8ba1\u7b97\u6700\u5c0f\u503c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def min(self, axis: Optional[int] = 0) -&gt; np.ndarray:\n    \"\"\"\u8ba1\u7b97\u6700\u5c0f\u503c\u3002\"\"\"\n    if axis is None:\n        return self._data.min().compute().values\n    dim = \"time\" if axis == 0 else \"distance\"\n    return self._data.min(dim=dim).compute().values\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.rms","title":"rms","text":"<pre><code>rms(window: Optional[int] = None) -&gt; np.ndarray\n</code></pre> <p>\u8ba1\u7b97 RMS\uff08\u5747\u65b9\u6839\uff09\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def rms(self, window: Optional[int] = None) -&gt; np.ndarray:\n    \"\"\"\u8ba1\u7b97 RMS\uff08\u5747\u65b9\u6839\uff09\u3002\"\"\"\n    data_sq = self._data**2\n    if window is None:\n        return np.sqrt(data_sq.mean(dim=\"time\").compute().values)\n    else:\n        # \u6ed1\u52a8 RMS\uff0c\u4f7f\u7528 xarray \u6eda\u52a8\u7a97\u53e3\n        rolling_mean = data_sq.rolling(time=window, center=True).mean()\n        return np.sqrt(rolling_mean.compute().values)\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.fft","title":"fft","text":"<pre><code>fft() -&gt; DASFrame\n</code></pre> <p>\u5feb\u901f\u5085\u7acb\u53f6\u53d8\u6362\uff0c\u8ba1\u7b97\u9891\u8c31\u5e45\u5ea6\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def fft(self) -&gt; \"DASFrame\":\n    \"\"\"\u5feb\u901f\u5085\u7acb\u53f6\u53d8\u6362\uff0c\u8ba1\u7b97\u9891\u8c31\u5e45\u5ea6\u3002\"\"\"\n\n    def _fft_func(data):\n        return np.abs(np.fft.fft(data, axis=-1))\n\n    data = self._data.chunk({\"time\": -1})\n    n_samples = data.sizes[\"time\"]\n    freqs = np.fft.fftfreq(n_samples, 1 / self._fs)\n\n    spectrum = xr.apply_ufunc(\n        _fft_func,\n        data,\n        input_core_dims=[[\"time\"]],\n        output_core_dims=[[\"frequency\"]],\n        dask=\"parallelized\",\n        output_dtypes=[float],\n        dask_gufunc_kwargs={\"output_sizes\": {\"frequency\": n_samples}},\n    )\n\n    spectrum = spectrum.assign_coords(frequency=freqs)\n    # \u6ce8\u610f\uff1aFFT \u53d8\u6362\u540e\uff0c'time' \u8f74\u53d8\u6210\u4e86 'frequency' \u8f74\uff0cfs \u542b\u4e49\u4e5f\u53d8\u5316\u4e86\n    # \u8fd9\u91cc\u4e3a\u4e86\u94fe\u5f0f\u8c03\u7528\u8fd4\u56de DASFrame\uff0c\u4f46\u5176\u5185\u90e8\u7ed3\u6784\u5df2\u7ecf\u53d1\u751f\u4e86\u53d8\u5316\uff08domain \u4f4d\u79fb\uff09\n    return DASFrame(spectrum, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.hilbert","title":"hilbert","text":"<pre><code>hilbert() -&gt; DASFrame\n</code></pre> <p>\u5e0c\u5c14\u4f2f\u7279\u53d8\u6362\uff0c\u8fd4\u56de\u89e3\u6790\u4fe1\u53f7\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def hilbert(self) -&gt; \"DASFrame\":\n    \"\"\"\u5e0c\u5c14\u4f2f\u7279\u53d8\u6362\uff0c\u8fd4\u56de\u89e3\u6790\u4fe1\u53f7\u3002\"\"\"\n\n    def _hilbert_func(data):\n        return signal.hilbert(data, axis=-1)\n\n    data = self._data.chunk({\"time\": -1})\n    analytical = xr.apply_ufunc(\n        _hilbert_func,\n        data,\n        input_core_dims=[[\"time\"]],\n        output_core_dims=[[\"time\"]],\n        dask=\"parallelized\",\n        output_dtypes=[complex],\n    )\n    return DASFrame(analytical, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.envelope","title":"envelope","text":"<pre><code>envelope() -&gt; DASFrame\n</code></pre> <p>\u63d0\u53d6\u4fe1\u53f7\u5305\u7edc\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def envelope(self) -&gt; \"DASFrame\":\n    \"\"\"\u63d0\u53d6\u4fe1\u53f7\u5305\u7edc\u3002\"\"\"\n    analytical = self.hilbert()\n    return analytical.abs()\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.scale","title":"scale","text":"<pre><code>scale(factor: float = 1.0) -&gt; DASFrame\n</code></pre> <p>Scale amplitude.</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def scale(self, factor: float = 1.0) -&gt; \"DASFrame\":\n    \"\"\"Scale amplitude.\"\"\"\n    scaled = self._data * factor\n    return DASFrame(scaled, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.abs","title":"abs","text":"<pre><code>abs() -&gt; DASFrame\n</code></pre> <p>Absolute value.</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def abs(self) -&gt; \"DASFrame\":\n    \"\"\"Absolute value.\"\"\"\n    return DASFrame(np.abs(self._data), self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.stft","title":"stft","text":"<pre><code>stft(\n    nperseg: int = 256, noverlap: Optional[int] = None\n) -&gt; DASFrame\n</code></pre> <p>\u77ed\u65f6\u5085\u7acb\u53f6\u53d8\u6362\uff0c\u8fdb\u884c\u65f6\u9891\u5206\u6790\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def stft(self, nperseg: int = 256, noverlap: Optional[int] = None) -&gt; \"DASFrame\":\n    \"\"\"\u77ed\u65f6\u5085\u7acb\u53f6\u53d8\u6362\uff0c\u8fdb\u884c\u65f6\u9891\u5206\u6790\u3002\"\"\"\n    if noverlap is None:\n        noverlap = nperseg // 2\n\n    data = self.collect()\n    # signal.stft for 2D data with axis=0:\n    # returns f, t, Zxx where Zxx shape is (freq, distance, time)\n    f, t, Zxx = signal.stft(\n        data, fs=self._fs, nperseg=nperseg, noverlap=noverlap, axis=0\n    )\n\n    # \u5c06 Zxx \u4ece (freq, distance, time) \u8f6c\u6362\u4e3a (freq, time, distance)\n    Zxx_abs = np.abs(Zxx).transpose(0, 2, 1)\n\n    # \u5c06\u7ed3\u679c\u5305\u88c5\u56de xr.DataArray\n    stft_data = xr.DataArray(\n        Zxx_abs,\n        dims=(\"frequency\", \"time\", \"distance\"),\n        coords={\n            \"frequency\": f,\n            \"time\": t,\n            \"distance\": self._data.distance,\n        },\n        name=\"stft\",\n        attrs=self._data.attrs,\n    )\n    return DASFrame(stft_data, self._fs, self._dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.fk_filter","title":"fk_filter","text":"<pre><code>fk_filter(\n    v_min: Optional[float] = None,\n    v_max: Optional[float] = None,\n    dx: float = 1.0,\n) -&gt; DASFrame\n</code></pre> <p>F-K \u6ee4\u6ce2 (\u901f\u5ea6\u6ee4\u6ce2)\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def fk_filter(\n    self,\n    v_min: Optional[float] = None,\n    v_max: Optional[float] = None,\n    dx: float = 1.0,\n) -&gt; \"DASFrame\":\n    \"\"\"F-K \u6ee4\u6ce2 (\u901f\u5ea6\u6ee4\u6ce2)\u3002\"\"\"\n    data = self.collect()\n    from ..config.sampling_config import SamplingConfig\n    from ..processing.das_processor import DASProcessor\n\n    config = SamplingConfig(fs=self._fs, channels=data.shape[1])\n    processor = DASProcessor(config)\n    filtered = processor.FKFilter(data, v_min=v_min, v_max=v_max, dx=dx)\n    return DASFrame(filtered, self._fs, dx, **self._metadata)\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.threshold_detect","title":"threshold_detect","text":"<pre><code>threshold_detect(\n    threshold: Optional[float] = None, sigma: float = 3.0\n) -&gt; np.ndarray\n</code></pre> <p>\u9608\u503c\u68c0\u6d4b\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def threshold_detect(\n    self, threshold: Optional[float] = None, sigma: float = 3.0\n) -&gt; np.ndarray:\n    \"\"\"\u9608\u503c\u68c0\u6d4b\u3002\"\"\"\n    data = self.collect()\n    if threshold is None:\n        threshold = np.mean(data) + sigma * np.std(data)\n    return np.abs(data) &gt; threshold\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.plot_ts","title":"plot_ts","text":"<pre><code>plot_ts(\n    ch: Optional[int] = None,\n    title: str = \"Time Series\",\n    ax: Optional[Axes] = None,\n    **kwargs,\n) -&gt; plt.Figure\n</code></pre> <p>\u7ed8\u5236\u65f6\u95f4\u5e8f\u5217\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def plot_ts(\n    self,\n    ch: Optional[int] = None,\n    title: str = \"Time Series\",\n    ax: Optional[plt.Axes] = None,\n    **kwargs,\n) -&gt; plt.Figure:\n    \"\"\"\u7ed8\u5236\u65f6\u95f4\u5e8f\u5217\u3002\"\"\"\n    data = self.collect()\n\n    if ax is None:\n        fig, ax = plt.subplots(figsize=(10, 4))\n    else:\n        if ax.figure is None:\n            raise ValueError(\"Provided ax must belong to a figure\")\n        fig = cast(plt.Figure, ax.figure)\n\n    t = np.arange(data.shape[0]) / self._fs\n    if ch is None:\n        ax.plot(t, data[:, : min(5, data.shape[1])], alpha=0.7)\n    else:\n        ax.plot(t, data[:, ch])\n\n    ax.set_xlabel(\"Time (s)\")\n    ax.set_ylabel(\"Amplitude\")\n    ax.set_title(title)\n    ax.grid(True, alpha=0.3)\n    return fig\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.plot_spectrum","title":"plot_spectrum","text":"<pre><code>plot_spectrum(\n    ch: int = 0,\n    title: str = \"Spectrum\",\n    ax: Optional[Axes] = None,\n    **kwargs: Any,\n) -&gt; plt.Figure\n</code></pre> <p>\u7ed8\u5236\u9891\u8c31\u56fe (FFT)\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def plot_spectrum(\n    self,\n    ch: int = 0,\n    title: str = \"Spectrum\",\n    ax: Optional[plt.Axes] = None,\n    **kwargs: Any,\n) -&gt; plt.Figure:\n    \"\"\"\u7ed8\u5236\u9891\u8c31\u56fe (FFT)\u3002\"\"\"\n    data = self.collect()\n    ch_data = data[:, ch]\n\n    from ..visualization.das_visualizer import SpectrumPlot\n\n    plotter = SpectrumPlot()\n    # \u8ba1\u7b97\u9891\u8c31 (Welch \u65b9\u6cd5)\n    from scipy import signal\n\n    n = len(ch_data)\n    nperseg = min(2048, n // 4)\n    freqs, psd = signal.welch(\n        ch_data, fs=self._fs, nperseg=nperseg, scaling=\"spectrum\"\n    )\n    mags = np.sqrt(psd)\n\n    fig = plotter.plot(freqs, mags, title=title, ax=ax, **kwargs)\n    return fig\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.plot_spectrogram","title":"plot_spectrogram","text":"<pre><code>plot_spectrogram(\n    ch: int = 0,\n    title: str = \"Spectrogram\",\n    window_size: int = 1024,\n    overlap: float = 0.75,\n    ax: Optional[Axes] = None,\n    **kwargs: Any,\n) -&gt; plt.Figure\n</code></pre> <p>\u7ed8\u5236\u65f6\u9891\u56fe (STFT)\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def plot_spectrogram(\n    self,\n    ch: int = 0,\n    title: str = \"Spectrogram\",\n    window_size: int = 1024,\n    overlap: float = 0.75,\n    ax: Optional[plt.Axes] = None,\n    **kwargs: Any,\n) -&gt; plt.Figure:\n    \"\"\"\u7ed8\u5236\u65f6\u9891\u56fe (STFT)\u3002\"\"\"\n    data = self.collect()\n    ch_data = data[:, ch]\n\n    from ..visualization.das_visualizer import SpectrogramPlot\n\n    plotter = SpectrogramPlot()\n    fig = plotter.plot(\n        ch_data,\n        self._fs,\n        window_size=window_size,\n        overlap=overlap,\n        title=title,\n        ax=ax,\n        **kwargs,\n    )\n    return fig\n</code></pre>"},{"location":"reference/DASMatrix/api/dasframe/#DASMatrix.api.dasframe.DASFrame.plot_heatmap","title":"plot_heatmap","text":"<pre><code>plot_heatmap(\n    channels: Optional[slice] = None,\n    t_range: Optional[slice] = None,\n    title: str = \"DAS Waterfall\",\n    cmap: str = \"RdBu_r\",\n    ax: Optional[Axes] = None,\n    **kwargs: Any,\n) -&gt; plt.Figure\n</code></pre> <p>\u7ed8\u5236\u70ed\u56fe\uff08\u7011\u5e03\u56fe\uff09\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>channels</code> <code>Optional[slice]</code> <p>\u901a\u9053\u5207\u7247\uff0c\u4f8b\u5982 slice(10, 60, 5)\u3002</p> <code>None</code> <code>t_range</code> <code>Optional[slice]</code> <p>\u65f6\u95f4\u6837\u672c\u5207\u7247\uff08\u4ee5\u6837\u672c\u4e3a\u5355\u4f4d\uff09\uff0c\u4f8b\u5982 slice(0, 1000)\u3002</p> <code>None</code> <code>title</code> <code>str</code> <p>\u56fe\u6807\u9898\u3002</p> <code>'DAS Waterfall'</code> <code>cmap</code> <code>str</code> <p>\u989c\u8272\u6620\u5c04\u3002</p> <code>'RdBu_r'</code> <code>ax</code> <code>Optional[Axes]</code> <p>\u53ef\u9009\u7684 matplotlib Axes \u5bf9\u8c61\u3002</p> <code>None</code> <code>**kwargs</code> <code>Any</code> <p>\u4f20\u9012\u7ed9 imshow \u7684\u989d\u5916\u53c2\u6570\u3002</p> <code>{}</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Figure</code> <p>matplotlib Figure \u5bf9\u8c61\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/dasframe.py</code> <pre><code>def plot_heatmap(\n    self,\n    channels: Optional[builtins.slice] = None,\n    t_range: Optional[builtins.slice] = None,\n    title: str = \"DAS Waterfall\",\n    cmap: str = \"RdBu_r\",\n    ax: Optional[plt.Axes] = None,\n    **kwargs: Any,\n) -&gt; plt.Figure:\n    \"\"\"\u7ed8\u5236\u70ed\u56fe\uff08\u7011\u5e03\u56fe\uff09\u3002\n\n    Args:\n        channels: \u901a\u9053\u5207\u7247\uff0c\u4f8b\u5982 slice(10, 60, 5)\u3002\n        t_range: \u65f6\u95f4\u6837\u672c\u5207\u7247\uff08\u4ee5\u6837\u672c\u4e3a\u5355\u4f4d\uff09\uff0c\u4f8b\u5982 slice(0, 1000)\u3002\n        title: \u56fe\u6807\u9898\u3002\n        cmap: \u989c\u8272\u6620\u5c04\u3002\n        ax: \u53ef\u9009\u7684 matplotlib Axes \u5bf9\u8c61\u3002\n        **kwargs: \u4f20\u9012\u7ed9 imshow \u7684\u989d\u5916\u53c2\u6570\u3002\n\n    Returns:\n        matplotlib Figure \u5bf9\u8c61\u3002\n    \"\"\"\n    data = self.collect()\n\n    # \u5e94\u7528\u65f6\u95f4\u5207\u7247\n    if t_range is not None:\n        data = data[t_range, :]\n        t_start = (t_range.start or 0) / self._fs\n    else:\n        t_start = 0.0\n\n    # \u5e94\u7528\u901a\u9053\u5207\u7247\n    if channels is not None:\n        data = data[:, channels]\n        ch_start = channels.start or 0\n    else:\n        ch_start = 0\n\n    if ax is None:\n        fig, ax = plt.subplots(figsize=(10, 6))\n    else:\n        if ax.figure is None:\n            raise ValueError(\"Provided ax must belong to a figure\")\n        fig = cast(plt.Figure, ax.figure)\n\n    extent = (\n        ch_start,\n        ch_start + float(data.shape[1]),\n        t_start + float(data.shape[0] / self._fs),\n        t_start,\n    )\n    vmax = np.percentile(np.abs(data), 98)\n    im = ax.imshow(\n        data,\n        aspect=\"auto\",\n        cmap=cmap,\n        extent=extent,\n        vmin=-vmax,\n        vmax=vmax,\n        **kwargs,\n    )\n\n    ax.set_xlabel(\"Channel\")\n    ax.set_ylabel(\"Time (s)\")\n    ax.set_title(title)\n    if ax is not None:\n        plt.colorbar(im, ax=ax, label=\"Amplitude\")\n    return fig\n</code></pre>"},{"location":"reference/DASMatrix/api/df/","title":"df","text":""},{"location":"reference/DASMatrix/api/df/#DASMatrix.api.df","title":"df","text":"<p>\u51fd\u6570\u5f0fAPI\u5165\u53e3\uff0c\u63d0\u4f9b\u4fbf\u6377\u7684DASFrame\u521b\u5efa\u65b9\u6cd5\u3002</p>"},{"location":"reference/DASMatrix/api/df/#DASMatrix.api.df.read","title":"read","text":"<pre><code>read(\n    path: str,\n    fs: Optional[float] = None,\n    channels: Optional[int] = None,\n    byte_order: str = \"little\",\n    **kwargs: Any,\n) -&gt; DASFrame\n</code></pre> <p>\u4ece\u6587\u4ef6\u8bfb\u53d6DAS\u6570\u636e\uff0c\u8fd4\u56deDASFrame\u5bf9\u8c61\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>path</code> <code>str</code> <p>\u6570\u636e\u6587\u4ef6\u8def\u5f84</p> \u5fc5\u9700 <code>fs</code> <code>Optional[float]</code> <p>\u91c7\u6837\u9891\u7387(Hz)\uff0cH5\u6587\u4ef6\u53ef\u81ea\u52a8\u68c0\u6d4b\uff0cDAT\u6587\u4ef6\u5fc5\u987b\u6307\u5b9a</p> <code>None</code> <code>channels</code> <code>Optional[int]</code> <p>\u901a\u9053\u6570\uff0cH5\u6587\u4ef6\u53ef\u81ea\u52a8\u68c0\u6d4b\uff0cDAT\u6587\u4ef6\u5fc5\u987b\u6307\u5b9a</p> <code>None</code> <code>byte_order</code> <code>str</code> <p>\u5b57\u8282\u5e8f\uff0c'big' \u6216 'little'\uff0c\u4ec5\u7528\u4e8e DAT \u6587\u4ef6</p> <code>'little'</code> <code>**kwargs</code> <code>Any</code> <p>\u4f20\u9012\u7ed9 DASFrame \u7684\u5176\u4ed6\u5143\u6570\u636e</p> <code>{}</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>DASFrame</code> <code>DASFrame</code> <p>\u5305\u542bDAS\u6570\u636e\u7684DASFrame\u5bf9\u8c61</p> <p>\u793a\u4f8b\uff1a</p> <pre><code>&gt;&gt;&gt; # \u8bfb\u53d6 H5 \u6587\u4ef6\uff08\u81ea\u52a8\u68c0\u6d4b\u53c2\u6570\uff09\n&gt;&gt;&gt; frame = df.read(\"data.h5\")\n</code></pre> <pre><code>&gt;&gt;&gt; # \u8bfb\u53d6 DAT \u6587\u4ef6\uff08\u9700\u8981\u6307\u5b9a\u53c2\u6570\uff09\n&gt;&gt;&gt; frame = df.read(\"data.dat\", fs=10000, channels=512)\n</code></pre> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/df.py</code> <pre><code>def read(\n    path: str,\n    fs: Optional[float] = None,\n    channels: Optional[int] = None,\n    byte_order: str = \"little\",\n    **kwargs: Any,\n) -&gt; \"DASFrame\":\n    \"\"\"\u4ece\u6587\u4ef6\u8bfb\u53d6DAS\u6570\u636e\uff0c\u8fd4\u56deDASFrame\u5bf9\u8c61\u3002\n\n    Args:\n        path: \u6570\u636e\u6587\u4ef6\u8def\u5f84\n        fs: \u91c7\u6837\u9891\u7387(Hz)\uff0cH5\u6587\u4ef6\u53ef\u81ea\u52a8\u68c0\u6d4b\uff0cDAT\u6587\u4ef6\u5fc5\u987b\u6307\u5b9a\n        channels: \u901a\u9053\u6570\uff0cH5\u6587\u4ef6\u53ef\u81ea\u52a8\u68c0\u6d4b\uff0cDAT\u6587\u4ef6\u5fc5\u987b\u6307\u5b9a\n        byte_order: \u5b57\u8282\u5e8f\uff0c'big' \u6216 'little'\uff0c\u4ec5\u7528\u4e8e DAT \u6587\u4ef6\n        **kwargs: \u4f20\u9012\u7ed9 DASFrame \u7684\u5176\u4ed6\u5143\u6570\u636e\n\n    Returns:\n        DASFrame: \u5305\u542bDAS\u6570\u636e\u7684DASFrame\u5bf9\u8c61\n\n    Examples:\n        &gt;&gt;&gt; # \u8bfb\u53d6 H5 \u6587\u4ef6\uff08\u81ea\u52a8\u68c0\u6d4b\u53c2\u6570\uff09\n        &gt;&gt;&gt; frame = df.read(\"data.h5\")\n\n        &gt;&gt;&gt; # \u8bfb\u53d6 DAT \u6587\u4ef6\uff08\u9700\u8981\u6307\u5b9a\u53c2\u6570\uff09\n        &gt;&gt;&gt; frame = df.read(\"data.dat\", fs=10000, channels=512)\n    \"\"\"\n    ext = os.path.splitext(path)[1].lower()\n\n    if ext in (\".h5\", \".hdf5\"):\n        return _read_h5(path, fs=fs, **kwargs)\n    elif ext == \".dat\":\n        if fs is None or channels is None:\n            raise ValueError(\n                \"\u8bfb\u53d6 DAT \u6587\u4ef6\u9700\u8981\u6307\u5b9a fs\uff08\u91c7\u6837\u9891\u7387\uff09\u548c channels\uff08\u901a\u9053\u6570\uff09\u53c2\u6570\"\n            )\n        return _read_dat(\n            path, fs=fs, channels=channels, byte_order=byte_order, **kwargs\n        )\n    else:\n        raise ValueError(f\"\u4e0d\u652f\u6301\u7684\u6587\u4ef6\u7c7b\u578b: {ext}\")\n</code></pre>"},{"location":"reference/DASMatrix/api/df/#DASMatrix.api.df.from_array","title":"from_array","text":"<pre><code>from_array(\n    data: ndarray, fs: float, **kwargs: Any\n) -&gt; DASFrame\n</code></pre> <p>\u4eceNumPy\u6570\u7ec4\u521b\u5efaDASFrame\u5bf9\u8c61\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>DAS\u6570\u636e\u6570\u7ec4\uff0c\u5f62\u72b6\u4e3a(\u65f6\u95f4\u70b9\u6570, \u901a\u9053\u6570)</p> \u5fc5\u9700 <code>fs</code> <code>float</code> <p>\u91c7\u6837\u9891\u7387(Hz)</p> \u5fc5\u9700 <code>**kwargs</code> <code>Any</code> <p>\u5176\u4ed6\u5143\u6570\u636e</p> <code>{}</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>DASFrame</code> <code>DASFrame</code> <p>\u5305\u542b\u6570\u636e\u7684DASFrame\u5bf9\u8c61</p> <p>\u793a\u4f8b\uff1a</p> <pre><code>&gt;&gt;&gt; import numpy as np\n&gt;&gt;&gt; from DASMatrix.api import df\n&gt;&gt;&gt; data = np.random.randn(10000, 64)\n&gt;&gt;&gt; frame = df.from_array(data, fs=10000)\n</code></pre> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/df.py</code> <pre><code>def from_array(data: np.ndarray, fs: float, **kwargs: Any) -&gt; \"DASFrame\":\n    \"\"\"\u4eceNumPy\u6570\u7ec4\u521b\u5efaDASFrame\u5bf9\u8c61\u3002\n\n    Args:\n        data: DAS\u6570\u636e\u6570\u7ec4\uff0c\u5f62\u72b6\u4e3a(\u65f6\u95f4\u70b9\u6570, \u901a\u9053\u6570)\n        fs: \u91c7\u6837\u9891\u7387(Hz)\n        **kwargs: \u5176\u4ed6\u5143\u6570\u636e\n\n    Returns:\n        DASFrame: \u5305\u542b\u6570\u636e\u7684DASFrame\u5bf9\u8c61\n\n    Examples:\n        &gt;&gt;&gt; import numpy as np\n        &gt;&gt;&gt; from DASMatrix.api import df\n        &gt;&gt;&gt; data = np.random.randn(10000, 64)\n        &gt;&gt;&gt; frame = df.from_array(data, fs=10000)\n    \"\"\"\n    if data.ndim == 1:\n        data = data.reshape(-1, 1)\n\n    return _create_dasframe(data, fs=fs, **kwargs)\n</code></pre>"},{"location":"reference/DASMatrix/api/df/#DASMatrix.api.df.stream","title":"stream","text":"<pre><code>stream(\n    url: str,\n    chunk: int = 1024,\n    fs: float = 10000.0,\n    **kwargs: Any,\n) -&gt; DASFrame\n</code></pre> <p>\u521b\u5efa\u7528\u4e8e\u6d41\u5f0f\u5904\u7406\u7684DASFrame\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>url</code> <code>str</code> <p>\u6570\u636e\u6d41URL\uff0c\u4f8b\u5982 \"tcp://0.0.0.0:9000\"</p> \u5fc5\u9700 <code>chunk</code> <code>int</code> <p>\u6bcf\u6b21\u5904\u7406\u7684\u6570\u636e\u5757\u5927\u5c0f</p> <code>1024</code> <code>fs</code> <code>float</code> <p>\u9884\u671f\u7684\u91c7\u6837\u9891\u7387(Hz)</p> <code>10000.0</code> <code>**kwargs</code> <code>Any</code> <p>\u5176\u4ed6\u53c2\u6570</p> <code>{}</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>DASFrame</code> <code>DASFrame</code> <p>\u7528\u4e8e\u6d41\u5904\u7406\u7684DASFrame\u5bf9\u8c61</p> Note <p>\u5f53\u524d\u4e3a\u5360\u4f4d\u5b9e\u73b0\uff0c\u6d41\u5904\u7406\u529f\u80fd\u5c06\u5728\u540e\u7eed\u7248\u672c\u4e2d\u5b8c\u5584\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/api/df.py</code> <pre><code>def stream(\n    url: str, chunk: int = 1024, fs: float = 10000.0, **kwargs: Any\n) -&gt; \"DASFrame\":\n    \"\"\"\u521b\u5efa\u7528\u4e8e\u6d41\u5f0f\u5904\u7406\u7684DASFrame\u3002\n\n    Args:\n        url: \u6570\u636e\u6d41URL\uff0c\u4f8b\u5982 \"tcp://0.0.0.0:9000\"\n        chunk: \u6bcf\u6b21\u5904\u7406\u7684\u6570\u636e\u5757\u5927\u5c0f\n        fs: \u9884\u671f\u7684\u91c7\u6837\u9891\u7387(Hz)\n        **kwargs: \u5176\u4ed6\u53c2\u6570\n\n    Returns:\n        DASFrame: \u7528\u4e8e\u6d41\u5904\u7406\u7684DASFrame\u5bf9\u8c61\n\n    Note:\n        \u5f53\u524d\u4e3a\u5360\u4f4d\u5b9e\u73b0\uff0c\u6d41\u5904\u7406\u529f\u80fd\u5c06\u5728\u540e\u7eed\u7248\u672c\u4e2d\u5b8c\u5584\u3002\n    \"\"\"\n    # TODO: \u5b9e\u73b0\u771f\u6b63\u7684\u6d41\u5904\u7406\n    return _create_dasframe(\n        np.array([]).reshape(0, 1),\n        fs=fs,\n        is_stream=True,\n        stream_url=url,\n        chunk_size=chunk,\n        **kwargs,\n    )\n</code></pre>"},{"location":"reference/DASMatrix/config/","title":"config","text":""},{"location":"reference/DASMatrix/config/#DASMatrix.config","title":"config","text":"<p>\u914d\u7f6e\u6a21\u5757</p> <p>\u63d0\u4f9b DASMatrix \u7684\u5404\u79cd\u914d\u7f6e\u7c7b\u3002</p>"},{"location":"reference/DASMatrix/config/#DASMatrix.config.SamplingConfig","title":"SamplingConfig  <code>dataclass</code>","text":"<pre><code>SamplingConfig(\n    fs: float = 30000.0,\n    channels: int = 100,\n    byte_order: str = \"little\",\n    wn: float = 1.0,\n)\n</code></pre> <p>\u91c7\u6837\u914d\u7f6e</p>"},{"location":"reference/DASMatrix/config/#DASMatrix.config.ColorPalette","title":"ColorPalette  <code>dataclass</code>","text":"<pre><code>ColorPalette(\n    primary: List[str] = (\n        lambda: [\n            \"#0072B2\",\n            \"#D55E00\",\n            \"#009E73\",\n            \"#CC79A7\",\n            \"#E69F00\",\n            \"#56B4E9\",\n            \"#F0E442\",\n            \"#000000\",\n        ]\n    )(),\n    sequential: str = \"viridis\",\n    diverging: str = \"RdBu_r\",\n    spectrogram: str = \"inferno\",\n    heatmap: str = \"magma\",\n    highlight: str = \"#D55E00\",\n    annotation: str = \"#0072B2\",\n    grid: str = \"#CCCCCC\",\n    spine: str = \"#333333\",\n)\n</code></pre> <p>\u8272\u76f2\u53cb\u597d\u7684\u914d\u8272\u65b9\u6848</p> <p>\u57fa\u4e8e Nature \u8272\u76f2\u53cb\u597d\u914d\u8272\u6307\u5357\u548c ColorBrewer\u3002</p>"},{"location":"reference/DASMatrix/config/#DASMatrix.config.ColorPalette.get_color","title":"get_color","text":"<pre><code>get_color(index: int) -&gt; str\n</code></pre> <p>\u83b7\u53d6\u6307\u5b9a\u7d22\u5f15\u7684\u989c\u8272</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/config/visualization_config.py</code> <pre><code>def get_color(self, index: int) -&gt; str:\n    \"\"\"\u83b7\u53d6\u6307\u5b9a\u7d22\u5f15\u7684\u989c\u8272\"\"\"\n    return self.primary[index % len(self.primary)]\n</code></pre>"},{"location":"reference/DASMatrix/config/#DASMatrix.config.FigureSize","title":"FigureSize","text":"<p>               Bases: <code>Enum</code></p> <p>Nature \u671f\u520a\u6807\u51c6\u56fe\u8868\u5c3a\u5bf8\uff08\u82f1\u5bf8\uff09</p> <p>\u57fa\u4e8e Nature \u6295\u7a3f\u6307\u5357\uff1a\u5355\u680f 89mm\uff0c1.5\u680f 120mm\uff0c\u53cc\u680f 183mm</p>"},{"location":"reference/DASMatrix/config/#DASMatrix.config.JournalStyle","title":"JournalStyle","text":"<p>               Bases: <code>Enum</code></p> <p>\u671f\u520a\u98ce\u683c\u679a\u4e3e</p>"},{"location":"reference/DASMatrix/config/#DASMatrix.config.Typography","title":"Typography  <code>dataclass</code>","text":"<pre><code>Typography(\n    family: str = \"Arial\",\n    math_family: str = \"stix\",\n    cjk_family: str = \"STHeiti\",\n    title: int = 10,\n    label: int = 8,\n    tick: int = 7,\n    legend: int = 7,\n    annotation: int = 7,\n    title_weight: str = \"bold\",\n    label_weight: str = \"normal\",\n)\n</code></pre> <p>\u6392\u7248\u8bbe\u7f6e - \u9075\u5faa\u671f\u520a\u6807\u51c6</p> <p>Nature \u8981\u6c42\uff1aArial/Helvetica, 5-7pt \u6700\u5c0f\u5b57\u53f7 Science \u8981\u6c42\uff1aHelvetica/Arial, 6-8pt \u6700\u5c0f\u5b57\u53f7</p>"},{"location":"reference/DASMatrix/config/#DASMatrix.config.VisualizationConfig","title":"VisualizationConfig  <code>dataclass</code>","text":"<pre><code>VisualizationConfig(\n    style: JournalStyle = JournalStyle.NATURE,\n    dpi: int = 300,\n    figsize: Tuple[\n        float, float\n    ] = FigureSize.SINGLE_COLUMN.value,\n    figsize_standard: Tuple[\n        float, float\n    ] = FigureSize.SINGLE_COLUMN.value,\n    figsize_wide: Tuple[\n        float, float\n    ] = FigureSize.WIDE.value,\n    colors: ColorPalette = ColorPalette(),\n    typography: Typography = Typography(),\n    grid: bool = False,\n    grid_style: str = \"-\",\n    grid_alpha: float = 0.3,\n    grid_linewidth: float = 0.5,\n    spine_linewidth: float = 0.8,\n    tick_direction: str = \"in\",\n    tick_major_size: float = 3.0,\n    tick_minor_size: float = 1.5,\n    tick_major_width: float = 0.8,\n    tick_minor_width: float = 0.5,\n    show_minor_ticks: bool = False,\n    line_width: float = 1.0,\n    line_width_thin: float = 0.5,\n    marker_size: float = 4.0,\n    legend_frameon: bool = False,\n    legend_loc: str = \"best\",\n    colorbar_width: float = 0.02,\n    colorbar_pad: float = 0.02,\n    label_pad: float = 4.0,\n    title_pad: float = 8.0,\n    font_size: int = 8,\n    label_size: int = 8,\n    tick_size: int = 7,\n    legend_size: int = 7,\n    plot_title_font_size: int = 10,\n)\n</code></pre> <p>Nature/Science \u7ea7\u522b\u53ef\u89c6\u5316\u914d\u7f6e\u7c7b</p> <p>\u793a\u4f8b\uff1a</p> <pre><code>&gt;&gt;&gt; config = VisualizationConfig()\n&gt;&gt;&gt; config = VisualizationConfig(style=JournalStyle.NATURE)\n&gt;&gt;&gt; config = VisualizationConfig.for_print()  # \u6253\u5370\u4f18\u5316\n&gt;&gt;&gt; config = VisualizationConfig.for_screen() # \u5c4f\u5e55\u4f18\u5316\n</code></pre>"},{"location":"reference/DASMatrix/config/#DASMatrix.config.VisualizationConfig.for_print","title":"for_print  <code>classmethod</code>","text":"<pre><code>for_print() -&gt; VisualizationConfig\n</code></pre> <p>\u521b\u5efa\u9002\u5408\u6253\u5370\u7684\u914d\u7f6e\uff08\u9ad8\u5bf9\u6bd4\u5ea6\uff09</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/config/visualization_config.py</code> <pre><code>@classmethod\ndef for_print(cls) -&gt; \"VisualizationConfig\":\n    \"\"\"\u521b\u5efa\u9002\u5408\u6253\u5370\u7684\u914d\u7f6e\uff08\u9ad8\u5bf9\u6bd4\u5ea6\uff09\"\"\"\n    config = cls()\n    config.dpi = 600\n    config.line_width = 1.2\n    config.spine_linewidth = 1.0\n    return config\n</code></pre>"},{"location":"reference/DASMatrix/config/#DASMatrix.config.VisualizationConfig.for_screen","title":"for_screen  <code>classmethod</code>","text":"<pre><code>for_screen() -&gt; VisualizationConfig\n</code></pre> <p>\u521b\u5efa\u9002\u5408\u5c4f\u5e55\u663e\u793a\u7684\u914d\u7f6e</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/config/visualization_config.py</code> <pre><code>@classmethod\ndef for_screen(cls) -&gt; \"VisualizationConfig\":\n    \"\"\"\u521b\u5efa\u9002\u5408\u5c4f\u5e55\u663e\u793a\u7684\u914d\u7f6e\"\"\"\n    config = cls()\n    config.dpi = 150\n    config.line_width = 1.5\n    config.typography.title = 12\n    config.typography.label = 10\n    config.typography.tick = 9\n    return config\n</code></pre>"},{"location":"reference/DASMatrix/config/#DASMatrix.config.VisualizationConfig.for_presentation","title":"for_presentation  <code>classmethod</code>","text":"<pre><code>for_presentation() -&gt; VisualizationConfig\n</code></pre> <p>\u521b\u5efa\u9002\u5408\u6f14\u793a\u6587\u7a3f\u7684\u914d\u7f6e</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/config/visualization_config.py</code> <pre><code>@classmethod\ndef for_presentation(cls) -&gt; \"VisualizationConfig\":\n    \"\"\"\u521b\u5efa\u9002\u5408\u6f14\u793a\u6587\u7a3f\u7684\u914d\u7f6e\"\"\"\n    config = cls()\n    config.dpi = 150\n    config.figsize = FigureSize.DOUBLE_COLUMN.value\n    config.line_width = 2.0\n    config.marker_size = 6.0\n    config.typography.title = 16\n    config.typography.label = 14\n    config.typography.tick = 12\n    config.typography.legend = 12\n    return config\n</code></pre>"},{"location":"reference/DASMatrix/config/#DASMatrix.config.VisualizationConfig.get_rcparams","title":"get_rcparams","text":"<pre><code>get_rcparams() -&gt; Dict\n</code></pre> <p>\u751f\u6210 matplotlib rcParams \u5b57\u5178</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/config/visualization_config.py</code> <pre><code>def get_rcparams(self) -&gt; Dict:\n    \"\"\"\u751f\u6210 matplotlib rcParams \u5b57\u5178\"\"\"\n    return {\n        # \u56fe\u5f62\u8bbe\u7f6e\n        \"figure.dpi\": self.dpi,\n        \"figure.figsize\": self.figsize,\n        \"figure.facecolor\": \"white\",\n        \"figure.edgecolor\": \"white\",\n        \"figure.autolayout\": False,\n        \"figure.constrained_layout.use\": True,\n        # \u5750\u6807\u8f74\n        \"axes.linewidth\": self.spine_linewidth,\n        \"axes.edgecolor\": self.colors.spine,\n        \"axes.facecolor\": \"white\",\n        \"axes.labelcolor\": \"black\",\n        \"axes.spines.top\": True,\n        \"axes.spines.right\": True,\n        \"axes.spines.bottom\": True,\n        \"axes.spines.left\": True,\n        \"axes.grid\": self.grid,\n        \"axes.axisbelow\": True,\n        \"axes.prop_cycle\": f\"cycler('color', {self.colors.primary})\",\n        # \u7f51\u683c\n        \"grid.color\": self.colors.grid,\n        \"grid.linestyle\": self.grid_style,\n        \"grid.alpha\": self.grid_alpha,\n        \"grid.linewidth\": self.grid_linewidth,\n        # \u523b\u5ea6\n        \"xtick.direction\": self.tick_direction,\n        \"ytick.direction\": self.tick_direction,\n        \"xtick.major.size\": self.tick_major_size,\n        \"ytick.major.size\": self.tick_major_size,\n        \"xtick.minor.size\": self.tick_minor_size,\n        \"ytick.minor.size\": self.tick_minor_size,\n        \"xtick.major.width\": self.tick_major_width,\n        \"ytick.major.width\": self.tick_major_width,\n        \"xtick.minor.width\": self.tick_minor_width,\n        \"ytick.minor.width\": self.tick_minor_width,\n        \"xtick.top\": True,\n        \"ytick.right\": True,\n        \"xtick.minor.visible\": self.show_minor_ticks,\n        \"ytick.minor.visible\": self.show_minor_ticks,\n        # \u5b57\u4f53 - \u4e2d\u6587\u5b57\u4f53\u4f18\u5148\uff0c\u786e\u4fdd\u4e2d\u6587\u6b63\u786e\u663e\u793a\n        \"font.family\": \"sans-serif\",\n        \"font.sans-serif\": [\n            self.typography.cjk_family,  # \u4e2d\u6587\u5b57\u4f53\u4f18\u5148\uff08\u9ed8\u8ba4 STHeiti\uff09\n            \"Songti SC\",  # macOS \u5b8b\u4f53\n            \"Heiti TC\",  # macOS \u9ed1\u4f53\u7e41\u4f53\n            \"Noto Serif SC\",  # Linux \u4e2d\u6587\u5b57\u4f53\n            \"Microsoft YaHei\",  # Windows \u4e2d\u6587\u5b57\u4f53\n            self.typography.family,\n            \"Helvetica\",\n            \"DejaVu Sans\",\n        ],\n        \"font.size\": self.typography.label,\n        \"axes.labelsize\": self.typography.label,\n        \"axes.titlesize\": self.typography.title,\n        \"axes.titleweight\": self.typography.title_weight,\n        \"axes.labelweight\": self.typography.label_weight,\n        \"xtick.labelsize\": self.typography.tick,\n        \"ytick.labelsize\": self.typography.tick,\n        \"legend.fontsize\": self.typography.legend,\n        \"axes.unicode_minus\": False,\n        # \u7ebf\u6761\n        \"lines.linewidth\": self.line_width,\n        \"lines.markersize\": self.marker_size,\n        \"lines.markeredgewidth\": 0.5,\n        \"lines.solid_capstyle\": \"round\",\n        # \u56fe\u4f8b\n        \"legend.frameon\": self.legend_frameon,\n        \"legend.framealpha\": 0.8,\n        \"legend.fancybox\": False,\n        \"legend.borderaxespad\": 0.5,\n        # \u4fdd\u5b58\n        \"savefig.dpi\": self.dpi,\n        \"savefig.bbox\": \"tight\",\n        \"savefig.pad_inches\": 0.02,\n        \"savefig.transparent\": False,\n        \"savefig.format\": \"pdf\",  # Nature \u8981\u6c42 PDF \u6216 EPS\n        # \u6570\u5b66\u6587\u672c\n        \"mathtext.fontset\": self.typography.math_family,\n    }\n</code></pre>"},{"location":"reference/DASMatrix/config/sampling_config/","title":"sampling_config","text":""},{"location":"reference/DASMatrix/config/sampling_config/#DASMatrix.config.sampling_config","title":"sampling_config","text":""},{"location":"reference/DASMatrix/config/sampling_config/#DASMatrix.config.sampling_config.SamplingConfig","title":"SamplingConfig  <code>dataclass</code>","text":"<pre><code>SamplingConfig(\n    fs: float = 30000.0,\n    channels: int = 100,\n    byte_order: str = \"little\",\n    wn: float = 1.0,\n)\n</code></pre> <p>\u91c7\u6837\u914d\u7f6e</p>"},{"location":"reference/DASMatrix/config/visualization_config/","title":"visualization_config","text":""},{"location":"reference/DASMatrix/config/visualization_config/#DASMatrix.config.visualization_config","title":"visualization_config","text":"<p>Nature/Science \u671f\u520a\u7ea7\u522b\u53ef\u89c6\u5316\u914d\u7f6e</p> <p>\u4e13\u4e3a\u8fbe\u5230\u9876\u7ea7\u671f\u520a\u51fa\u7248\u8d28\u91cf\u8bbe\u8ba1\u7684\u53ef\u89c6\u5316\u914d\u7f6e\u7cfb\u7edf\u3002 \u9075\u5faa Nature\u3001Science\u3001Cell \u7b49\u671f\u520a\u7684\u56fe\u8868\u5236\u4f5c\u6307\u5357\u3002</p>"},{"location":"reference/DASMatrix/config/visualization_config/#DASMatrix.config.visualization_config.JournalStyle","title":"JournalStyle","text":"<p>               Bases: <code>Enum</code></p> <p>\u671f\u520a\u98ce\u683c\u679a\u4e3e</p>"},{"location":"reference/DASMatrix/config/visualization_config/#DASMatrix.config.visualization_config.FigureSize","title":"FigureSize","text":"<p>               Bases: <code>Enum</code></p> <p>Nature \u671f\u520a\u6807\u51c6\u56fe\u8868\u5c3a\u5bf8\uff08\u82f1\u5bf8\uff09</p> <p>\u57fa\u4e8e Nature \u6295\u7a3f\u6307\u5357\uff1a\u5355\u680f 89mm\uff0c1.5\u680f 120mm\uff0c\u53cc\u680f 183mm</p>"},{"location":"reference/DASMatrix/config/visualization_config/#DASMatrix.config.visualization_config.ColorPalette","title":"ColorPalette  <code>dataclass</code>","text":"<pre><code>ColorPalette(\n    primary: List[str] = (\n        lambda: [\n            \"#0072B2\",\n            \"#D55E00\",\n            \"#009E73\",\n            \"#CC79A7\",\n            \"#E69F00\",\n            \"#56B4E9\",\n            \"#F0E442\",\n            \"#000000\",\n        ]\n    )(),\n    sequential: str = \"viridis\",\n    diverging: str = \"RdBu_r\",\n    spectrogram: str = \"inferno\",\n    heatmap: str = \"magma\",\n    highlight: str = \"#D55E00\",\n    annotation: str = \"#0072B2\",\n    grid: str = \"#CCCCCC\",\n    spine: str = \"#333333\",\n)\n</code></pre> <p>\u8272\u76f2\u53cb\u597d\u7684\u914d\u8272\u65b9\u6848</p> <p>\u57fa\u4e8e Nature \u8272\u76f2\u53cb\u597d\u914d\u8272\u6307\u5357\u548c ColorBrewer\u3002</p>"},{"location":"reference/DASMatrix/config/visualization_config/#DASMatrix.config.visualization_config.ColorPalette.get_color","title":"get_color","text":"<pre><code>get_color(index: int) -&gt; str\n</code></pre> <p>\u83b7\u53d6\u6307\u5b9a\u7d22\u5f15\u7684\u989c\u8272</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/config/visualization_config.py</code> <pre><code>def get_color(self, index: int) -&gt; str:\n    \"\"\"\u83b7\u53d6\u6307\u5b9a\u7d22\u5f15\u7684\u989c\u8272\"\"\"\n    return self.primary[index % len(self.primary)]\n</code></pre>"},{"location":"reference/DASMatrix/config/visualization_config/#DASMatrix.config.visualization_config.Typography","title":"Typography  <code>dataclass</code>","text":"<pre><code>Typography(\n    family: str = \"Arial\",\n    math_family: str = \"stix\",\n    cjk_family: str = \"STHeiti\",\n    title: int = 10,\n    label: int = 8,\n    tick: int = 7,\n    legend: int = 7,\n    annotation: int = 7,\n    title_weight: str = \"bold\",\n    label_weight: str = \"normal\",\n)\n</code></pre> <p>\u6392\u7248\u8bbe\u7f6e - \u9075\u5faa\u671f\u520a\u6807\u51c6</p> <p>Nature \u8981\u6c42\uff1aArial/Helvetica, 5-7pt \u6700\u5c0f\u5b57\u53f7 Science \u8981\u6c42\uff1aHelvetica/Arial, 6-8pt \u6700\u5c0f\u5b57\u53f7</p>"},{"location":"reference/DASMatrix/config/visualization_config/#DASMatrix.config.visualization_config.VisualizationConfig","title":"VisualizationConfig  <code>dataclass</code>","text":"<pre><code>VisualizationConfig(\n    style: JournalStyle = JournalStyle.NATURE,\n    dpi: int = 300,\n    figsize: Tuple[\n        float, float\n    ] = FigureSize.SINGLE_COLUMN.value,\n    figsize_standard: Tuple[\n        float, float\n    ] = FigureSize.SINGLE_COLUMN.value,\n    figsize_wide: Tuple[\n        float, float\n    ] = FigureSize.WIDE.value,\n    colors: ColorPalette = ColorPalette(),\n    typography: Typography = Typography(),\n    grid: bool = False,\n    grid_style: str = \"-\",\n    grid_alpha: float = 0.3,\n    grid_linewidth: float = 0.5,\n    spine_linewidth: float = 0.8,\n    tick_direction: str = \"in\",\n    tick_major_size: float = 3.0,\n    tick_minor_size: float = 1.5,\n    tick_major_width: float = 0.8,\n    tick_minor_width: float = 0.5,\n    show_minor_ticks: bool = False,\n    line_width: float = 1.0,\n    line_width_thin: float = 0.5,\n    marker_size: float = 4.0,\n    legend_frameon: bool = False,\n    legend_loc: str = \"best\",\n    colorbar_width: float = 0.02,\n    colorbar_pad: float = 0.02,\n    label_pad: float = 4.0,\n    title_pad: float = 8.0,\n    font_size: int = 8,\n    label_size: int = 8,\n    tick_size: int = 7,\n    legend_size: int = 7,\n    plot_title_font_size: int = 10,\n)\n</code></pre> <p>Nature/Science \u7ea7\u522b\u53ef\u89c6\u5316\u914d\u7f6e\u7c7b</p> <p>\u793a\u4f8b\uff1a</p> <pre><code>&gt;&gt;&gt; config = VisualizationConfig()\n&gt;&gt;&gt; config = VisualizationConfig(style=JournalStyle.NATURE)\n&gt;&gt;&gt; config = VisualizationConfig.for_print()  # \u6253\u5370\u4f18\u5316\n&gt;&gt;&gt; config = VisualizationConfig.for_screen() # \u5c4f\u5e55\u4f18\u5316\n</code></pre>"},{"location":"reference/DASMatrix/config/visualization_config/#DASMatrix.config.visualization_config.VisualizationConfig.for_print","title":"for_print  <code>classmethod</code>","text":"<pre><code>for_print() -&gt; VisualizationConfig\n</code></pre> <p>\u521b\u5efa\u9002\u5408\u6253\u5370\u7684\u914d\u7f6e\uff08\u9ad8\u5bf9\u6bd4\u5ea6\uff09</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/config/visualization_config.py</code> <pre><code>@classmethod\ndef for_print(cls) -&gt; \"VisualizationConfig\":\n    \"\"\"\u521b\u5efa\u9002\u5408\u6253\u5370\u7684\u914d\u7f6e\uff08\u9ad8\u5bf9\u6bd4\u5ea6\uff09\"\"\"\n    config = cls()\n    config.dpi = 600\n    config.line_width = 1.2\n    config.spine_linewidth = 1.0\n    return config\n</code></pre>"},{"location":"reference/DASMatrix/config/visualization_config/#DASMatrix.config.visualization_config.VisualizationConfig.for_screen","title":"for_screen  <code>classmethod</code>","text":"<pre><code>for_screen() -&gt; VisualizationConfig\n</code></pre> <p>\u521b\u5efa\u9002\u5408\u5c4f\u5e55\u663e\u793a\u7684\u914d\u7f6e</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/config/visualization_config.py</code> <pre><code>@classmethod\ndef for_screen(cls) -&gt; \"VisualizationConfig\":\n    \"\"\"\u521b\u5efa\u9002\u5408\u5c4f\u5e55\u663e\u793a\u7684\u914d\u7f6e\"\"\"\n    config = cls()\n    config.dpi = 150\n    config.line_width = 1.5\n    config.typography.title = 12\n    config.typography.label = 10\n    config.typography.tick = 9\n    return config\n</code></pre>"},{"location":"reference/DASMatrix/config/visualization_config/#DASMatrix.config.visualization_config.VisualizationConfig.for_presentation","title":"for_presentation  <code>classmethod</code>","text":"<pre><code>for_presentation() -&gt; VisualizationConfig\n</code></pre> <p>\u521b\u5efa\u9002\u5408\u6f14\u793a\u6587\u7a3f\u7684\u914d\u7f6e</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/config/visualization_config.py</code> <pre><code>@classmethod\ndef for_presentation(cls) -&gt; \"VisualizationConfig\":\n    \"\"\"\u521b\u5efa\u9002\u5408\u6f14\u793a\u6587\u7a3f\u7684\u914d\u7f6e\"\"\"\n    config = cls()\n    config.dpi = 150\n    config.figsize = FigureSize.DOUBLE_COLUMN.value\n    config.line_width = 2.0\n    config.marker_size = 6.0\n    config.typography.title = 16\n    config.typography.label = 14\n    config.typography.tick = 12\n    config.typography.legend = 12\n    return config\n</code></pre>"},{"location":"reference/DASMatrix/config/visualization_config/#DASMatrix.config.visualization_config.VisualizationConfig.get_rcparams","title":"get_rcparams","text":"<pre><code>get_rcparams() -&gt; Dict\n</code></pre> <p>\u751f\u6210 matplotlib rcParams \u5b57\u5178</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/config/visualization_config.py</code> <pre><code>def get_rcparams(self) -&gt; Dict:\n    \"\"\"\u751f\u6210 matplotlib rcParams \u5b57\u5178\"\"\"\n    return {\n        # \u56fe\u5f62\u8bbe\u7f6e\n        \"figure.dpi\": self.dpi,\n        \"figure.figsize\": self.figsize,\n        \"figure.facecolor\": \"white\",\n        \"figure.edgecolor\": \"white\",\n        \"figure.autolayout\": False,\n        \"figure.constrained_layout.use\": True,\n        # \u5750\u6807\u8f74\n        \"axes.linewidth\": self.spine_linewidth,\n        \"axes.edgecolor\": self.colors.spine,\n        \"axes.facecolor\": \"white\",\n        \"axes.labelcolor\": \"black\",\n        \"axes.spines.top\": True,\n        \"axes.spines.right\": True,\n        \"axes.spines.bottom\": True,\n        \"axes.spines.left\": True,\n        \"axes.grid\": self.grid,\n        \"axes.axisbelow\": True,\n        \"axes.prop_cycle\": f\"cycler('color', {self.colors.primary})\",\n        # \u7f51\u683c\n        \"grid.color\": self.colors.grid,\n        \"grid.linestyle\": self.grid_style,\n        \"grid.alpha\": self.grid_alpha,\n        \"grid.linewidth\": self.grid_linewidth,\n        # \u523b\u5ea6\n        \"xtick.direction\": self.tick_direction,\n        \"ytick.direction\": self.tick_direction,\n        \"xtick.major.size\": self.tick_major_size,\n        \"ytick.major.size\": self.tick_major_size,\n        \"xtick.minor.size\": self.tick_minor_size,\n        \"ytick.minor.size\": self.tick_minor_size,\n        \"xtick.major.width\": self.tick_major_width,\n        \"ytick.major.width\": self.tick_major_width,\n        \"xtick.minor.width\": self.tick_minor_width,\n        \"ytick.minor.width\": self.tick_minor_width,\n        \"xtick.top\": True,\n        \"ytick.right\": True,\n        \"xtick.minor.visible\": self.show_minor_ticks,\n        \"ytick.minor.visible\": self.show_minor_ticks,\n        # \u5b57\u4f53 - \u4e2d\u6587\u5b57\u4f53\u4f18\u5148\uff0c\u786e\u4fdd\u4e2d\u6587\u6b63\u786e\u663e\u793a\n        \"font.family\": \"sans-serif\",\n        \"font.sans-serif\": [\n            self.typography.cjk_family,  # \u4e2d\u6587\u5b57\u4f53\u4f18\u5148\uff08\u9ed8\u8ba4 STHeiti\uff09\n            \"Songti SC\",  # macOS \u5b8b\u4f53\n            \"Heiti TC\",  # macOS \u9ed1\u4f53\u7e41\u4f53\n            \"Noto Serif SC\",  # Linux \u4e2d\u6587\u5b57\u4f53\n            \"Microsoft YaHei\",  # Windows \u4e2d\u6587\u5b57\u4f53\n            self.typography.family,\n            \"Helvetica\",\n            \"DejaVu Sans\",\n        ],\n        \"font.size\": self.typography.label,\n        \"axes.labelsize\": self.typography.label,\n        \"axes.titlesize\": self.typography.title,\n        \"axes.titleweight\": self.typography.title_weight,\n        \"axes.labelweight\": self.typography.label_weight,\n        \"xtick.labelsize\": self.typography.tick,\n        \"ytick.labelsize\": self.typography.tick,\n        \"legend.fontsize\": self.typography.legend,\n        \"axes.unicode_minus\": False,\n        # \u7ebf\u6761\n        \"lines.linewidth\": self.line_width,\n        \"lines.markersize\": self.marker_size,\n        \"lines.markeredgewidth\": 0.5,\n        \"lines.solid_capstyle\": \"round\",\n        # \u56fe\u4f8b\n        \"legend.frameon\": self.legend_frameon,\n        \"legend.framealpha\": 0.8,\n        \"legend.fancybox\": False,\n        \"legend.borderaxespad\": 0.5,\n        # \u4fdd\u5b58\n        \"savefig.dpi\": self.dpi,\n        \"savefig.bbox\": \"tight\",\n        \"savefig.pad_inches\": 0.02,\n        \"savefig.transparent\": False,\n        \"savefig.format\": \"pdf\",  # Nature \u8981\u6c42 PDF \u6216 EPS\n        # \u6570\u5b66\u6587\u672c\n        \"mathtext.fontset\": self.typography.math_family,\n    }\n</code></pre>"},{"location":"reference/DASMatrix/core/","title":"core","text":""},{"location":"reference/DASMatrix/core/#DASMatrix.core","title":"core","text":"<p>DASMatrix\u6838\u5fc3\u6a21\u5757\uff0c\u63d0\u4f9b\u8ba1\u7b97\u5f15\u64ce\u548c\u8ba1\u7b97\u56fe\u5b9e\u73b0\u3002</p>"},{"location":"reference/DASMatrix/core/#DASMatrix.core.ComputationGraph","title":"ComputationGraph","text":"<pre><code>ComputationGraph(root: Optional[Node] = None)\n</code></pre> <p>\u8ba1\u7b97\u56fe\u5bb9\u5668\uff0c\u7ba1\u7406\u8282\u70b9\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u3002</p> <p>ComputationGraph \u662f\u4e0d\u53ef\u53d8\u7684\uff0c\u6bcf\u6b21\u6dfb\u52a0\u8282\u70b9\u90fd\u8fd4\u56de\u65b0\u7684\u56fe\u5b9e\u4f8b\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>root</code> <p>\u8ba1\u7b97\u56fe\u7684\u6839\u8282\u70b9\uff08\u8f93\u51fa\u8282\u70b9\uff09</p> <p>\u521d\u59cb\u5316\u8ba1\u7b97\u56fe\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>root</code> <code>Optional[Node]</code> <p>\u6839\u8282\u70b9\uff0c\u9ed8\u8ba4\u4e3a None \u8868\u793a\u7a7a\u56fe</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/core/computation_graph.py</code> <pre><code>def __init__(self, root: Optional[Node] = None) -&gt; None:\n    \"\"\"\u521d\u59cb\u5316\u8ba1\u7b97\u56fe\u3002\n\n    Args:\n        root: \u6839\u8282\u70b9\uff0c\u9ed8\u8ba4\u4e3a None \u8868\u793a\u7a7a\u56fe\n    \"\"\"\n    self.root = root\n</code></pre>"},{"location":"reference/DASMatrix/core/#DASMatrix.core.ComputationGraph.nodes","title":"nodes  <code>property</code>","text":"<pre><code>nodes: List[Node]\n</code></pre> <p>\u83b7\u53d6\u8ba1\u7b97\u56fe\u4e2d\u7684\u6240\u6709\u8282\u70b9\uff08\u62d3\u6251\u5e8f\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[Node]</code> <p>List[Node]: \u6309\u62d3\u6251\u987a\u5e8f\u6392\u5217\u7684\u8282\u70b9\u5217\u8868</p>"},{"location":"reference/DASMatrix/core/#DASMatrix.core.ComputationGraph.leaf","title":"leaf  <code>classmethod</code>","text":"<pre><code>leaf(data: Any) -&gt; ComputationGraph\n</code></pre> <p>\u521b\u5efa\u53ea\u5305\u542b\u4e00\u4e2a\u6570\u636e\u6e90\u8282\u70b9\u7684\u8ba1\u7b97\u56fe\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>Any</code> <p>\u539f\u59cb\u8f93\u5165\u6570\u636e</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>ComputationGraph</code> <code>ComputationGraph</code> <p>\u65b0\u7684\u8ba1\u7b97\u56fe\u5b9e\u4f8b</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/core/computation_graph.py</code> <pre><code>@classmethod\ndef leaf(cls, data: Any) -&gt; \"ComputationGraph\":\n    \"\"\"\u521b\u5efa\u53ea\u5305\u542b\u4e00\u4e2a\u6570\u636e\u6e90\u8282\u70b9\u7684\u8ba1\u7b97\u56fe\u3002\n\n    Args:\n        data: \u539f\u59cb\u8f93\u5165\u6570\u636e\n\n    Returns:\n        ComputationGraph: \u65b0\u7684\u8ba1\u7b97\u56fe\u5b9e\u4f8b\n    \"\"\"\n    source = SourceNode(data)\n    return cls(source)\n</code></pre>"},{"location":"reference/DASMatrix/core/#DASMatrix.core.ComputationGraph.add_node","title":"add_node","text":"<pre><code>add_node(node: Node) -&gt; ComputationGraph\n</code></pre> <p>\u6dfb\u52a0\u8282\u70b9\u5e76\u8fd4\u56de\u65b0\u7684\u56fe\u5b9e\u4f8b\u3002</p> <p>\u91c7\u7528\u4e0d\u53ef\u53d8\u98ce\u683c\uff0c\u8fd4\u56de\u4e00\u4e2a\u6307\u5411\u65b0\u6839\u8282\u70b9\u7684\u65b0\u56fe\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>node</code> <code>Node</code> <p>\u8981\u6dfb\u52a0\u7684\u8282\u70b9</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>ComputationGraph</code> <code>ComputationGraph</code> <p>\u65b0\u7684\u8ba1\u7b97\u56fe\u5b9e\u4f8b</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/core/computation_graph.py</code> <pre><code>def add_node(self, node: Node) -&gt; \"ComputationGraph\":\n    \"\"\"\u6dfb\u52a0\u8282\u70b9\u5e76\u8fd4\u56de\u65b0\u7684\u56fe\u5b9e\u4f8b\u3002\n\n    \u91c7\u7528\u4e0d\u53ef\u53d8\u98ce\u683c\uff0c\u8fd4\u56de\u4e00\u4e2a\u6307\u5411\u65b0\u6839\u8282\u70b9\u7684\u65b0\u56fe\u3002\n\n    Args:\n        node: \u8981\u6dfb\u52a0\u7684\u8282\u70b9\n\n    Returns:\n        ComputationGraph: \u65b0\u7684\u8ba1\u7b97\u56fe\u5b9e\u4f8b\n    \"\"\"\n    return ComputationGraph(node)\n</code></pre>"},{"location":"reference/DASMatrix/core/#DASMatrix.core.Node","title":"Node","text":"<pre><code>Node(name: str, domain: NodeDomain = NodeDomain.GENERIC)\n</code></pre> <p>               Bases: <code>ABC</code></p> <p>\u8ba1\u7b97\u56fe\u8282\u70b9\u62bd\u8c61\u57fa\u7c7b\u3002</p> <p>\u6240\u6709\u8282\u70b9\u7c7b\u578b\u7684\u57fa\u7c7b\uff0c\u5b9a\u4e49\u4e86\u8282\u70b9\u7684\u57fa\u672c\u5c5e\u6027\u548c\u63a5\u53e3\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>name</code> <p>\u8282\u70b9\u540d\u79f0\uff0c\u7528\u4e8e\u8c03\u8bd5\u548c\u65e5\u5fd7</p> <code>domain</code> <p>\u8282\u70b9\u8ba1\u7b97\u57df</p> <code>inputs</code> <code>List[Node]</code> <p>\u8f93\u5165\u8282\u70b9\u5217\u8868</p> <code>result</code> <code>Any</code> <p>\u7f13\u5b58\u7684\u8ba1\u7b97\u7ed3\u679c</p> <code>computed</code> <p>\u662f\u5426\u5df2\u8ba1\u7b97\u7684\u6807\u5fd7</p> <p>\u521d\u59cb\u5316\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>name</code> <code>str</code> <p>\u8282\u70b9\u540d\u79f0</p> \u5fc5\u9700 <code>domain</code> <code>NodeDomain</code> <p>\u8282\u70b9\u8ba1\u7b97\u57df\uff0c\u9ed8\u8ba4\u4e3a GENERIC</p> <code>GENERIC</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/core/computation_graph.py</code> <pre><code>def __init__(self, name: str, domain: NodeDomain = NodeDomain.GENERIC) -&gt; None:\n    \"\"\"\u521d\u59cb\u5316\u8282\u70b9\u3002\n\n    Args:\n        name: \u8282\u70b9\u540d\u79f0\n        domain: \u8282\u70b9\u8ba1\u7b97\u57df\uff0c\u9ed8\u8ba4\u4e3a GENERIC\n    \"\"\"\n    self.name = name\n    self.domain = domain\n    self.inputs: List[\"Node\"] = []\n    self.result: Any = None\n    self.computed = False\n</code></pre>"},{"location":"reference/DASMatrix/core/#DASMatrix.core.Node.add_input","title":"add_input","text":"<pre><code>add_input(node: Node) -&gt; Node\n</code></pre> <p>\u6dfb\u52a0\u8f93\u5165\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>node</code> <code>Node</code> <p>\u8981\u6dfb\u52a0\u7684\u8f93\u5165\u8282\u70b9</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Node</code> <code>Node</code> <p>\u8fd4\u56de\u81ea\u8eab\u4ee5\u652f\u6301\u94fe\u5f0f\u8c03\u7528</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/core/computation_graph.py</code> <pre><code>def add_input(self, node: \"Node\") -&gt; \"Node\":\n    \"\"\"\u6dfb\u52a0\u8f93\u5165\u8282\u70b9\u3002\n\n    Args:\n        node: \u8981\u6dfb\u52a0\u7684\u8f93\u5165\u8282\u70b9\n\n    Returns:\n        Node: \u8fd4\u56de\u81ea\u8eab\u4ee5\u652f\u6301\u94fe\u5f0f\u8c03\u7528\n    \"\"\"\n    self.inputs.append(node)\n    return self\n</code></pre>"},{"location":"reference/DASMatrix/core/#DASMatrix.core.Node.compute","title":"compute  <code>abstractmethod</code>","text":"<pre><code>compute(backend: Any = None) -&gt; Any\n</code></pre> <p>\u6267\u884c\u8282\u70b9\u8ba1\u7b97\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>backend</code> <code>Any</code> <p>\u540e\u7aef\u5f15\u64ce\u5b9e\u4f8b</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Any</code> <code>Any</code> <p>\u8ba1\u7b97\u7ed3\u679c</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/core/computation_graph.py</code> <pre><code>@abstractmethod\ndef compute(self, backend: Any = None) -&gt; Any:\n    \"\"\"\u6267\u884c\u8282\u70b9\u8ba1\u7b97\u3002\n\n    Args:\n        backend: \u540e\u7aef\u5f15\u64ce\u5b9e\u4f8b\n\n    Returns:\n        Any: \u8ba1\u7b97\u7ed3\u679c\n    \"\"\"\n    pass\n</code></pre>"},{"location":"reference/DASMatrix/core/#DASMatrix.core.Node.reset","title":"reset","text":"<pre><code>reset() -&gt; None\n</code></pre> <p>\u91cd\u7f6e\u8282\u70b9\u72b6\u6001\uff0c\u6e05\u9664\u7f13\u5b58\u7ed3\u679c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/core/computation_graph.py</code> <pre><code>def reset(self) -&gt; None:\n    \"\"\"\u91cd\u7f6e\u8282\u70b9\u72b6\u6001\uff0c\u6e05\u9664\u7f13\u5b58\u7ed3\u679c\u3002\"\"\"\n    self.result = None\n    self.computed = False\n</code></pre>"},{"location":"reference/DASMatrix/core/computation_graph/","title":"computation_graph","text":""},{"location":"reference/DASMatrix/core/computation_graph/#DASMatrix.core.computation_graph","title":"computation_graph","text":"<p>\u8ba1\u7b97\u56fe\u5b9e\u73b0\u6a21\u5757\u3002</p> <p>\u672c\u6a21\u5757\u63d0\u4f9b\u5ef6\u8fdf\u8ba1\u7b97\u56fe\u7684\u6838\u5fc3\u6570\u636e\u7ed3\u6784\uff0c\u652f\u6301\uff1a - \u8282\u70b9\u7c7b\u578b\uff1aSourceNode\uff08\u6570\u636e\u6e90\uff09\u3001OperationNode\uff08\u64cd\u4f5c\uff09\u3001FusionNode\uff08\u878d\u5408\u8282\u70b9\uff09 - \u8ba1\u7b97\u57df\u6807\u8bb0\uff1a\u7528\u4e8e\u5f15\u64ce\u8c03\u5ea6\u51b3\u7b56 - \u4f9d\u8d56\u8ddf\u8e2a\uff1a\u652f\u6301\u8ba1\u7b97\u56fe\u904d\u5386\u548c\u4f18\u5316</p> <p>\u8ba1\u7b97\u56fe\u662f DASFrame \u5ef6\u8fdf\u8ba1\u7b97\u6a21\u5f0f\u7684\u57fa\u7840\uff0c\u6240\u6709\u4fe1\u53f7\u5904\u7406\u64cd\u4f5c\u9996\u5148\u6784\u5efa\u8ba1\u7b97\u56fe\u8282\u70b9\uff0c \u7136\u540e\u7531\u6267\u884c\u5f15\u64ce\u7edf\u4e00\u4f18\u5316\u548c\u6267\u884c\u3002</p>"},{"location":"reference/DASMatrix/core/computation_graph/#DASMatrix.core.computation_graph.NodeDomain","title":"NodeDomain","text":"<p>               Bases: <code>Enum</code></p> <p>\u8282\u70b9\u8ba1\u7b97\u57df\u679a\u4e3e\u3002</p> <p>\u7528\u4e8e\u6807\u8bc6\u8282\u70b9\u5e94\u8be5\u7531\u54ea\u4e2a\u540e\u7aef\u5f15\u64ce\u6267\u884c\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>GENERIC</code> <p>\u901a\u7528\u57df\uff0c\u53ef\u7531\u4efb\u610f\u540e\u7aef\u6267\u884c</p> <code>METADATA</code> <p>\u5143\u6570\u636e\u57df\uff0c\u7531 Polars \u540e\u7aef\u5904\u7406</p> <code>SIGNAL</code> <p>\u4fe1\u53f7\u57df\uff0c\u7531 Numba/NumPy \u540e\u7aef\u5904\u7406</p>"},{"location":"reference/DASMatrix/core/computation_graph/#DASMatrix.core.computation_graph.Node","title":"Node","text":"<pre><code>Node(name: str, domain: NodeDomain = NodeDomain.GENERIC)\n</code></pre> <p>               Bases: <code>ABC</code></p> <p>\u8ba1\u7b97\u56fe\u8282\u70b9\u62bd\u8c61\u57fa\u7c7b\u3002</p> <p>\u6240\u6709\u8282\u70b9\u7c7b\u578b\u7684\u57fa\u7c7b\uff0c\u5b9a\u4e49\u4e86\u8282\u70b9\u7684\u57fa\u672c\u5c5e\u6027\u548c\u63a5\u53e3\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>name</code> <p>\u8282\u70b9\u540d\u79f0\uff0c\u7528\u4e8e\u8c03\u8bd5\u548c\u65e5\u5fd7</p> <code>domain</code> <p>\u8282\u70b9\u8ba1\u7b97\u57df</p> <code>inputs</code> <code>List[Node]</code> <p>\u8f93\u5165\u8282\u70b9\u5217\u8868</p> <code>result</code> <code>Any</code> <p>\u7f13\u5b58\u7684\u8ba1\u7b97\u7ed3\u679c</p> <code>computed</code> <p>\u662f\u5426\u5df2\u8ba1\u7b97\u7684\u6807\u5fd7</p> <p>\u521d\u59cb\u5316\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>name</code> <code>str</code> <p>\u8282\u70b9\u540d\u79f0</p> \u5fc5\u9700 <code>domain</code> <code>NodeDomain</code> <p>\u8282\u70b9\u8ba1\u7b97\u57df\uff0c\u9ed8\u8ba4\u4e3a GENERIC</p> <code>GENERIC</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/core/computation_graph.py</code> <pre><code>def __init__(self, name: str, domain: NodeDomain = NodeDomain.GENERIC) -&gt; None:\n    \"\"\"\u521d\u59cb\u5316\u8282\u70b9\u3002\n\n    Args:\n        name: \u8282\u70b9\u540d\u79f0\n        domain: \u8282\u70b9\u8ba1\u7b97\u57df\uff0c\u9ed8\u8ba4\u4e3a GENERIC\n    \"\"\"\n    self.name = name\n    self.domain = domain\n    self.inputs: List[\"Node\"] = []\n    self.result: Any = None\n    self.computed = False\n</code></pre>"},{"location":"reference/DASMatrix/core/computation_graph/#DASMatrix.core.computation_graph.Node.add_input","title":"add_input","text":"<pre><code>add_input(node: Node) -&gt; Node\n</code></pre> <p>\u6dfb\u52a0\u8f93\u5165\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>node</code> <code>Node</code> <p>\u8981\u6dfb\u52a0\u7684\u8f93\u5165\u8282\u70b9</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Node</code> <code>Node</code> <p>\u8fd4\u56de\u81ea\u8eab\u4ee5\u652f\u6301\u94fe\u5f0f\u8c03\u7528</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/core/computation_graph.py</code> <pre><code>def add_input(self, node: \"Node\") -&gt; \"Node\":\n    \"\"\"\u6dfb\u52a0\u8f93\u5165\u8282\u70b9\u3002\n\n    Args:\n        node: \u8981\u6dfb\u52a0\u7684\u8f93\u5165\u8282\u70b9\n\n    Returns:\n        Node: \u8fd4\u56de\u81ea\u8eab\u4ee5\u652f\u6301\u94fe\u5f0f\u8c03\u7528\n    \"\"\"\n    self.inputs.append(node)\n    return self\n</code></pre>"},{"location":"reference/DASMatrix/core/computation_graph/#DASMatrix.core.computation_graph.Node.compute","title":"compute  <code>abstractmethod</code>","text":"<pre><code>compute(backend: Any = None) -&gt; Any\n</code></pre> <p>\u6267\u884c\u8282\u70b9\u8ba1\u7b97\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>backend</code> <code>Any</code> <p>\u540e\u7aef\u5f15\u64ce\u5b9e\u4f8b</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Any</code> <code>Any</code> <p>\u8ba1\u7b97\u7ed3\u679c</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/core/computation_graph.py</code> <pre><code>@abstractmethod\ndef compute(self, backend: Any = None) -&gt; Any:\n    \"\"\"\u6267\u884c\u8282\u70b9\u8ba1\u7b97\u3002\n\n    Args:\n        backend: \u540e\u7aef\u5f15\u64ce\u5b9e\u4f8b\n\n    Returns:\n        Any: \u8ba1\u7b97\u7ed3\u679c\n    \"\"\"\n    pass\n</code></pre>"},{"location":"reference/DASMatrix/core/computation_graph/#DASMatrix.core.computation_graph.Node.reset","title":"reset","text":"<pre><code>reset() -&gt; None\n</code></pre> <p>\u91cd\u7f6e\u8282\u70b9\u72b6\u6001\uff0c\u6e05\u9664\u7f13\u5b58\u7ed3\u679c\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/core/computation_graph.py</code> <pre><code>def reset(self) -&gt; None:\n    \"\"\"\u91cd\u7f6e\u8282\u70b9\u72b6\u6001\uff0c\u6e05\u9664\u7f13\u5b58\u7ed3\u679c\u3002\"\"\"\n    self.result = None\n    self.computed = False\n</code></pre>"},{"location":"reference/DASMatrix/core/computation_graph/#DASMatrix.core.computation_graph.SourceNode","title":"SourceNode","text":"<pre><code>SourceNode(\n    data: Any,\n    name: str = \"source\",\n    domain: NodeDomain = NodeDomain.GENERIC,\n)\n</code></pre> <p>               Bases: <code>Node</code></p> <p>\u6570\u636e\u6e90\u8282\u70b9\uff0c\u4ee3\u8868\u8ba1\u7b97\u56fe\u7684\u8f93\u5165\u6570\u636e\u3002</p> <p>SourceNode \u662f\u8ba1\u7b97\u56fe\u7684\u53f6\u5b50\u8282\u70b9\uff0c\u4e0d\u4f9d\u8d56\u5176\u4ed6\u8282\u70b9\uff0c \u76f4\u63a5\u6301\u6709\u539f\u59cb\u6570\u636e\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>data</code> <p>\u539f\u59cb\u8f93\u5165\u6570\u636e</p> <p>\u521d\u59cb\u5316\u6570\u636e\u6e90\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>Any</code> <p>\u539f\u59cb\u8f93\u5165\u6570\u636e\uff0c\u901a\u5e38\u4e3a NumPy \u6570\u7ec4</p> \u5fc5\u9700 <code>name</code> <code>str</code> <p>\u8282\u70b9\u540d\u79f0\uff0c\u9ed8\u8ba4\u4e3a \"source\"</p> <code>'source'</code> <code>domain</code> <code>NodeDomain</code> <p>\u8282\u70b9\u8ba1\u7b97\u57df</p> <code>GENERIC</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/core/computation_graph.py</code> <pre><code>def __init__(\n    self, data: Any, name: str = \"source\", domain: NodeDomain = NodeDomain.GENERIC\n) -&gt; None:\n    \"\"\"\u521d\u59cb\u5316\u6570\u636e\u6e90\u8282\u70b9\u3002\n\n    Args:\n        data: \u539f\u59cb\u8f93\u5165\u6570\u636e\uff0c\u901a\u5e38\u4e3a NumPy \u6570\u7ec4\n        name: \u8282\u70b9\u540d\u79f0\uff0c\u9ed8\u8ba4\u4e3a \"source\"\n        domain: \u8282\u70b9\u8ba1\u7b97\u57df\n    \"\"\"\n    super().__init__(name, domain)\n    self.data = data\n</code></pre>"},{"location":"reference/DASMatrix/core/computation_graph/#DASMatrix.core.computation_graph.SourceNode.compute","title":"compute","text":"<pre><code>compute(backend: Any = None) -&gt; Any\n</code></pre> <p>\u8fd4\u56de\u539f\u59cb\u6570\u636e\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Any</code> <code>Any</code> <p>\u539f\u59cb\u8f93\u5165\u6570\u636e</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/core/computation_graph.py</code> <pre><code>def compute(self, backend: Any = None) -&gt; Any:\n    \"\"\"\u8fd4\u56de\u539f\u59cb\u6570\u636e\u3002\n\n    Returns:\n        Any: \u539f\u59cb\u8f93\u5165\u6570\u636e\n    \"\"\"\n    return self.data\n</code></pre>"},{"location":"reference/DASMatrix/core/computation_graph/#DASMatrix.core.computation_graph.OperationNode","title":"OperationNode","text":"<pre><code>OperationNode(\n    operation: str,\n    inputs: List[Node],\n    args: Tuple[Any, ...] = (),\n    kwargs: Optional[Dict[str, Any]] = None,\n    domain: NodeDomain = NodeDomain.GENERIC,\n    name: str = \"operation\",\n)\n</code></pre> <p>               Bases: <code>Node</code></p> <p>\u64cd\u4f5c\u8282\u70b9\uff0c\u4ee3\u8868\u4e00\u4e2a\u4fe1\u53f7\u5904\u7406\u64cd\u4f5c\u3002</p> <p>OperationNode \u5c01\u88c5\u4e86\u5355\u4e2a\u64cd\u4f5c\u7684\u5168\u90e8\u4fe1\u606f\uff0c\u5305\u62ec\u64cd\u4f5c\u540d\u79f0\u3001\u53c2\u6570\u7b49\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>operation</code> <p>\u64cd\u4f5c\u540d\u79f0\uff0c\u5982 'detrend', 'bandpass' \u7b49</p> <code>args</code> <p>\u4f4d\u7f6e\u53c2\u6570\u5143\u7ec4</p> <code>kwargs</code> <p>\u5173\u952e\u5b57\u53c2\u6570\u5b57\u5178</p> <p>\u521d\u59cb\u5316\u64cd\u4f5c\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>operation</code> <code>str</code> <p>\u64cd\u4f5c\u540d\u79f0</p> \u5fc5\u9700 <code>inputs</code> <code>List[Node]</code> <p>\u8f93\u5165\u8282\u70b9\u5217\u8868</p> \u5fc5\u9700 <code>args</code> <code>Tuple[Any, ...]</code> <p>\u4f4d\u7f6e\u53c2\u6570</p> <code>()</code> <code>kwargs</code> <code>Optional[Dict[str, Any]]</code> <p>\u5173\u952e\u5b57\u53c2\u6570</p> <code>None</code> <code>domain</code> <code>NodeDomain</code> <p>\u8282\u70b9\u8ba1\u7b97\u57df</p> <code>GENERIC</code> <code>name</code> <code>str</code> <p>\u8282\u70b9\u540d\u79f0</p> <code>'operation'</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/core/computation_graph.py</code> <pre><code>def __init__(\n    self,\n    operation: str,\n    inputs: List[Node],\n    args: Tuple[Any, ...] = (),\n    kwargs: Optional[Dict[str, Any]] = None,\n    domain: NodeDomain = NodeDomain.GENERIC,\n    name: str = \"operation\",\n) -&gt; None:\n    \"\"\"\u521d\u59cb\u5316\u64cd\u4f5c\u8282\u70b9\u3002\n\n    Args:\n        operation: \u64cd\u4f5c\u540d\u79f0\n        inputs: \u8f93\u5165\u8282\u70b9\u5217\u8868\n        args: \u4f4d\u7f6e\u53c2\u6570\n        kwargs: \u5173\u952e\u5b57\u53c2\u6570\n        domain: \u8282\u70b9\u8ba1\u7b97\u57df\n        name: \u8282\u70b9\u540d\u79f0\n    \"\"\"\n    super().__init__(name, domain)\n    self.operation = operation\n    self.inputs = inputs\n    self.args = args\n    self.kwargs = kwargs or {}\n</code></pre>"},{"location":"reference/DASMatrix/core/computation_graph/#DASMatrix.core.computation_graph.OperationNode.compute","title":"compute","text":"<pre><code>compute(backend: Any = None) -&gt; Any\n</code></pre> <p>\u6267\u884c\u64cd\u4f5c\u8ba1\u7b97\u3002</p> <p>\u6ce8\u610f\uff1a\u5728\u6df7\u5408\u5f15\u64ce\u4e2d\uff0c\u6b64\u65b9\u6cd5\u4e0d\u5e94\u76f4\u63a5\u8c03\u7528\uff0c \u5e94\u7531 ExecutionPlanner \u751f\u6210\u6267\u884c\u8ba1\u5212\u540e\u7531 Backend \u6267\u884c\u3002</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>NotImplementedError</code> <p>\u59cb\u7ec8\u629b\u51fa\uff0c\u63d0\u793a\u4f7f\u7528\u6b63\u786e\u7684\u6267\u884c\u65b9\u5f0f</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/core/computation_graph.py</code> <pre><code>def compute(self, backend: Any = None) -&gt; Any:\n    \"\"\"\u6267\u884c\u64cd\u4f5c\u8ba1\u7b97\u3002\n\n    \u6ce8\u610f\uff1a\u5728\u6df7\u5408\u5f15\u64ce\u4e2d\uff0c\u6b64\u65b9\u6cd5\u4e0d\u5e94\u76f4\u63a5\u8c03\u7528\uff0c\n    \u5e94\u7531 ExecutionPlanner \u751f\u6210\u6267\u884c\u8ba1\u5212\u540e\u7531 Backend \u6267\u884c\u3002\n\n    Raises:\n        NotImplementedError: \u59cb\u7ec8\u629b\u51fa\uff0c\u63d0\u793a\u4f7f\u7528\u6b63\u786e\u7684\u6267\u884c\u65b9\u5f0f\n    \"\"\"\n    raise NotImplementedError(\n        \"OperationNode should be executed by a Backend/Planner\"\n    )\n</code></pre>"},{"location":"reference/DASMatrix/core/computation_graph/#DASMatrix.core.computation_graph.FusionNode","title":"FusionNode","text":"<pre><code>FusionNode(\n    nodes: List[OperationNode], name: str = \"fused_kernel\"\n)\n</code></pre> <p>               Bases: <code>Node</code></p> <p>\u878d\u5408\u8282\u70b9\uff0c\u5305\u542b\u591a\u4e2a\u53ef\u5408\u5e76\u7684\u8fde\u7eed\u64cd\u4f5c\u3002</p> <p>FusionNode \u662f\u4f18\u5316\u5668\u7684\u4ea7\u7269\uff0c\u5c06\u591a\u4e2a\u8fde\u7eed\u7684 Signal \u57df\u64cd\u4f5c\u878d\u5408\u4e3a \u5355\u4e2a\u8282\u70b9\uff0c\u7531 Numba JIT \u7f16\u8bd1\u4e3a\u9ad8\u6548\u5185\u6838\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>fused_nodes</code> <p>\u88ab\u878d\u5408\u7684\u64cd\u4f5c\u8282\u70b9\u5217\u8868</p> <p>\u521d\u59cb\u5316\u878d\u5408\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>nodes</code> <code>List[OperationNode]</code> <p>\u8981\u878d\u5408\u7684\u64cd\u4f5c\u8282\u70b9\u5217\u8868</p> \u5fc5\u9700 <code>name</code> <code>str</code> <p>\u8282\u70b9\u540d\u79f0\uff0c\u9ed8\u8ba4\u4e3a \"fused_kernel\"</p> <code>'fused_kernel'</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/core/computation_graph.py</code> <pre><code>def __init__(self, nodes: List[OperationNode], name: str = \"fused_kernel\") -&gt; None:\n    \"\"\"\u521d\u59cb\u5316\u878d\u5408\u8282\u70b9\u3002\n\n    Args:\n        nodes: \u8981\u878d\u5408\u7684\u64cd\u4f5c\u8282\u70b9\u5217\u8868\n        name: \u8282\u70b9\u540d\u79f0\uff0c\u9ed8\u8ba4\u4e3a \"fused_kernel\"\n    \"\"\"\n    super().__init__(name, NodeDomain.SIGNAL)\n    self.fused_nodes = nodes\n    if nodes:\n        self.inputs = nodes[0].inputs\n</code></pre>"},{"location":"reference/DASMatrix/core/computation_graph/#DASMatrix.core.computation_graph.FusionNode.compute","title":"compute","text":"<pre><code>compute(backend: Any = None) -&gt; Any\n</code></pre> <p>\u6267\u884c\u878d\u5408\u8282\u70b9\u8ba1\u7b97\u3002</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>NotImplementedError</code> <p>\u878d\u5408\u8282\u70b9\u5fc5\u987b\u7531 NumbaBackend \u7f16\u8bd1\u6267\u884c</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/core/computation_graph.py</code> <pre><code>def compute(self, backend: Any = None) -&gt; Any:\n    \"\"\"\u6267\u884c\u878d\u5408\u8282\u70b9\u8ba1\u7b97\u3002\n\n    Raises:\n        NotImplementedError: \u878d\u5408\u8282\u70b9\u5fc5\u987b\u7531 NumbaBackend \u7f16\u8bd1\u6267\u884c\n    \"\"\"\n    raise NotImplementedError(\n        \"FusionNode must be compiled and executed by NumbaBackend\"\n    )\n</code></pre>"},{"location":"reference/DASMatrix/core/computation_graph/#DASMatrix.core.computation_graph.ComputationGraph","title":"ComputationGraph","text":"<pre><code>ComputationGraph(root: Optional[Node] = None)\n</code></pre> <p>\u8ba1\u7b97\u56fe\u5bb9\u5668\uff0c\u7ba1\u7406\u8282\u70b9\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u3002</p> <p>ComputationGraph \u662f\u4e0d\u53ef\u53d8\u7684\uff0c\u6bcf\u6b21\u6dfb\u52a0\u8282\u70b9\u90fd\u8fd4\u56de\u65b0\u7684\u56fe\u5b9e\u4f8b\u3002</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>root</code> <p>\u8ba1\u7b97\u56fe\u7684\u6839\u8282\u70b9\uff08\u8f93\u51fa\u8282\u70b9\uff09</p> <p>\u521d\u59cb\u5316\u8ba1\u7b97\u56fe\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>root</code> <code>Optional[Node]</code> <p>\u6839\u8282\u70b9\uff0c\u9ed8\u8ba4\u4e3a None \u8868\u793a\u7a7a\u56fe</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/core/computation_graph.py</code> <pre><code>def __init__(self, root: Optional[Node] = None) -&gt; None:\n    \"\"\"\u521d\u59cb\u5316\u8ba1\u7b97\u56fe\u3002\n\n    Args:\n        root: \u6839\u8282\u70b9\uff0c\u9ed8\u8ba4\u4e3a None \u8868\u793a\u7a7a\u56fe\n    \"\"\"\n    self.root = root\n</code></pre>"},{"location":"reference/DASMatrix/core/computation_graph/#DASMatrix.core.computation_graph.ComputationGraph.nodes","title":"nodes  <code>property</code>","text":"<pre><code>nodes: List[Node]\n</code></pre> <p>\u83b7\u53d6\u8ba1\u7b97\u56fe\u4e2d\u7684\u6240\u6709\u8282\u70b9\uff08\u62d3\u6251\u5e8f\uff09\u3002</p> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[Node]</code> <p>List[Node]: \u6309\u62d3\u6251\u987a\u5e8f\u6392\u5217\u7684\u8282\u70b9\u5217\u8868</p>"},{"location":"reference/DASMatrix/core/computation_graph/#DASMatrix.core.computation_graph.ComputationGraph.leaf","title":"leaf  <code>classmethod</code>","text":"<pre><code>leaf(data: Any) -&gt; ComputationGraph\n</code></pre> <p>\u521b\u5efa\u53ea\u5305\u542b\u4e00\u4e2a\u6570\u636e\u6e90\u8282\u70b9\u7684\u8ba1\u7b97\u56fe\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>Any</code> <p>\u539f\u59cb\u8f93\u5165\u6570\u636e</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>ComputationGraph</code> <code>ComputationGraph</code> <p>\u65b0\u7684\u8ba1\u7b97\u56fe\u5b9e\u4f8b</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/core/computation_graph.py</code> <pre><code>@classmethod\ndef leaf(cls, data: Any) -&gt; \"ComputationGraph\":\n    \"\"\"\u521b\u5efa\u53ea\u5305\u542b\u4e00\u4e2a\u6570\u636e\u6e90\u8282\u70b9\u7684\u8ba1\u7b97\u56fe\u3002\n\n    Args:\n        data: \u539f\u59cb\u8f93\u5165\u6570\u636e\n\n    Returns:\n        ComputationGraph: \u65b0\u7684\u8ba1\u7b97\u56fe\u5b9e\u4f8b\n    \"\"\"\n    source = SourceNode(data)\n    return cls(source)\n</code></pre>"},{"location":"reference/DASMatrix/core/computation_graph/#DASMatrix.core.computation_graph.ComputationGraph.add_node","title":"add_node","text":"<pre><code>add_node(node: Node) -&gt; ComputationGraph\n</code></pre> <p>\u6dfb\u52a0\u8282\u70b9\u5e76\u8fd4\u56de\u65b0\u7684\u56fe\u5b9e\u4f8b\u3002</p> <p>\u91c7\u7528\u4e0d\u53ef\u53d8\u98ce\u683c\uff0c\u8fd4\u56de\u4e00\u4e2a\u6307\u5411\u65b0\u6839\u8282\u70b9\u7684\u65b0\u56fe\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>node</code> <code>Node</code> <p>\u8981\u6dfb\u52a0\u7684\u8282\u70b9</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>ComputationGraph</code> <code>ComputationGraph</code> <p>\u65b0\u7684\u8ba1\u7b97\u56fe\u5b9e\u4f8b</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/core/computation_graph.py</code> <pre><code>def add_node(self, node: Node) -&gt; \"ComputationGraph\":\n    \"\"\"\u6dfb\u52a0\u8282\u70b9\u5e76\u8fd4\u56de\u65b0\u7684\u56fe\u5b9e\u4f8b\u3002\n\n    \u91c7\u7528\u4e0d\u53ef\u53d8\u98ce\u683c\uff0c\u8fd4\u56de\u4e00\u4e2a\u6307\u5411\u65b0\u6839\u8282\u70b9\u7684\u65b0\u56fe\u3002\n\n    Args:\n        node: \u8981\u6dfb\u52a0\u7684\u8282\u70b9\n\n    Returns:\n        ComputationGraph: \u65b0\u7684\u8ba1\u7b97\u56fe\u5b9e\u4f8b\n    \"\"\"\n    return ComputationGraph(node)\n</code></pre>"},{"location":"reference/DASMatrix/processing/","title":"processing","text":""},{"location":"reference/DASMatrix/processing/#DASMatrix.processing","title":"processing","text":""},{"location":"reference/DASMatrix/processing/das_processor/","title":"das_processor","text":""},{"location":"reference/DASMatrix/processing/das_processor/#DASMatrix.processing.das_processor","title":"das_processor","text":""},{"location":"reference/DASMatrix/processing/das_processor/#DASMatrix.processing.das_processor.DASProcessor","title":"DASProcessor","text":"<pre><code>DASProcessor(sampling_config: SamplingConfig)\n</code></pre> <p>DAS\u6570\u636e\u5904\u7406\u5668\uff0c\u7528\u4e8e\u5904\u7406\u548c\u5206\u6790DAS\u6570\u636e</p> <p>\u521d\u59cb\u5316DAS\u6570\u636e\u5904\u7406\u5668</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>sampling_config</code> <code>SamplingConfig</code> <p>\u91c7\u6837\u914d\u7f6e\u5bf9\u8c61\uff0c\u5305\u542b\u91c7\u6837\u9891\u7387\u7b49\u4fe1\u606f</p> \u5fc5\u9700 \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/das_processor.py</code> <pre><code>def __init__(self, sampling_config: SamplingConfig):\n    \"\"\"\u521d\u59cb\u5316DAS\u6570\u636e\u5904\u7406\u5668\n\n    Args:\n        sampling_config: \u91c7\u6837\u914d\u7f6e\u5bf9\u8c61\uff0c\u5305\u542b\u91c7\u6837\u9891\u7387\u7b49\u4fe1\u606f\n    \"\"\"\n    self.sampling_config = sampling_config\n    self.fs = sampling_config.fs\n    self.logger = logging.getLogger(__name__)\n\n    # \u9884\u8ba1\u7b97\u9ad8\u901a\u6ee4\u6ce2\u5668\u7cfb\u6570\n    self.sos_highpass = self._create_filter(\n        cutoff=self.sampling_config.wn, btype=\"high\"\n    )\n</code></pre>"},{"location":"reference/DASMatrix/processing/das_processor/#DASMatrix.processing.das_processor.DASProcessor.ApplyFilter","title":"ApplyFilter","text":"<pre><code>ApplyFilter(data: ndarray, sos: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u5e94\u7528\u6ee4\u6ce2\u5668 (\u96f6\u76f8\u4f4d)</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u8f93\u5165\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)</p> \u5fc5\u9700 <code>sos</code> <code>ndarray</code> <p>\u6ee4\u6ce2\u5668\u7cfb\u6570 (SOS format)</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u6ee4\u6ce2\u540e\u7684\u6570\u636e</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/das_processor.py</code> <pre><code>def ApplyFilter(self, data: np.ndarray, sos: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u5e94\u7528\u6ee4\u6ce2\u5668 (\u96f6\u76f8\u4f4d)\n\n    Args:\n        data: \u8f93\u5165\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)\n        sos: \u6ee4\u6ce2\u5668\u7cfb\u6570 (SOS format)\n\n    Returns:\n        np.ndarray: \u6ee4\u6ce2\u540e\u7684\u6570\u636e\n    \"\"\"\n    # \u786e\u4fdd\u6570\u636e\u662f\u6d6e\u70b9\u6570\u7c7b\u578b\u4ee5\u83b7\u5f97\u6700\u4f73\u7cbe\u5ea6\n    if not np.issubdtype(data.dtype, np.floating):\n        data = data.astype(np.float64)\n    filtered_data = signal.sosfiltfilt(sos, data, axis=0)\n    return filtered_data\n</code></pre>"},{"location":"reference/DASMatrix/processing/das_processor/#DASMatrix.processing.das_processor.DASProcessor.NormalizeDC","title":"NormalizeDC","text":"<pre><code>NormalizeDC(data: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u79fb\u9664\u76f4\u6d41\u504f\u7f6e (\u6309\u5217)</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u8f93\u5165\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u53bb\u9664\u76f4\u6d41\u504f\u7f6e\u540e\u7684\u6570\u636e</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/das_processor.py</code> <pre><code>def NormalizeDC(self, data: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u79fb\u9664\u76f4\u6d41\u504f\u7f6e (\u6309\u5217)\n\n    Args:\n        data: \u8f93\u5165\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)\n\n    Returns:\n        np.ndarray: \u53bb\u9664\u76f4\u6d41\u504f\u7f6e\u540e\u7684\u6570\u636e\n    \"\"\"\n    return data - np.mean(data, axis=0, keepdims=True)\n</code></pre>"},{"location":"reference/DASMatrix/processing/das_processor/#DASMatrix.processing.das_processor.DASProcessor.ProcessDifferential","title":"ProcessDifferential","text":"<pre><code>ProcessDifferential(raw_data: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u5904\u7406\u539f\u59cb\u6570\u636e\uff0c\u5f97\u5230\u5dee\u5206\u6570\u636e (\u9ad8\u901a\u6ee4\u6ce2\u548c\u53bb\u76f4\u6d41)</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>raw_data</code> <code>ndarray</code> <p>\u539f\u59cb\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u5904\u7406\u540e\u7684\u5dee\u5206\u6570\u636e</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/das_processor.py</code> <pre><code>def ProcessDifferential(self, raw_data: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u5904\u7406\u539f\u59cb\u6570\u636e\uff0c\u5f97\u5230\u5dee\u5206\u6570\u636e (\u9ad8\u901a\u6ee4\u6ce2\u548c\u53bb\u76f4\u6d41)\n\n    Args:\n        raw_data: \u539f\u59cb\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)\n\n    Returns:\n        np.ndarray: \u5904\u7406\u540e\u7684\u5dee\u5206\u6570\u636e\n    \"\"\"\n    # \u9ad8\u901a\u6ee4\u6ce2\n    filtered_data = self.ApplyFilter(raw_data, self.sos_highpass)\n    # DC\u504f\u7f6e\u6821\u6b63\n    processed_data = self.NormalizeDC(filtered_data)\n    return processed_data\n</code></pre>"},{"location":"reference/DASMatrix/processing/das_processor/#DASMatrix.processing.das_processor.DASProcessor.IntegrateData","title":"IntegrateData","text":"<pre><code>IntegrateData(raw_data: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u8ba1\u7b97\u79ef\u5206\u6570\u636e (\u7d2f\u52a0\u3001\u9ad8\u901a\u6ee4\u6ce2\u3001\u53bb\u76f4\u6d41)</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>raw_data</code> <code>ndarray</code> <p>\u539f\u59cb\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u8ba1\u7b97\u5f97\u5230\u7684\u79ef\u5206\u6570\u636e</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/das_processor.py</code> <pre><code>def IntegrateData(self, raw_data: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u8ba1\u7b97\u79ef\u5206\u6570\u636e (\u7d2f\u52a0\u3001\u9ad8\u901a\u6ee4\u6ce2\u3001\u53bb\u76f4\u6d41)\n\n    Args:\n        raw_data: \u539f\u59cb\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)\n\n    Returns:\n        np.ndarray: \u8ba1\u7b97\u5f97\u5230\u7684\u79ef\u5206\u6570\u636e\n    \"\"\"\n    # \u8ba1\u7b97\u7d2f\u79ef\u548c (\u79ef\u5206)\n    int_data = np.cumsum(raw_data, axis=0)\n    # \u9ad8\u901a\u6ee4\u6ce2\n    filtered_int_data = self.ApplyFilter(int_data, self.sos_highpass)\n    # DC\u504f\u7f6e\u6821\u6b63\n    processed_int_data = self.NormalizeDC(filtered_int_data)\n    return processed_int_data\n</code></pre>"},{"location":"reference/DASMatrix/processing/das_processor/#DASMatrix.processing.das_processor.DASProcessor.ComputeSpectrum","title":"ComputeSpectrum","text":"<pre><code>ComputeSpectrum(\n    data: ndarray,\n    channel_index: int,\n    window_size: int = 1024,\n    overlap: float = 0.5,\n) -&gt; Dict[str, np.ndarray]\n</code></pre> <p>\u8ba1\u7b97\u6307\u5b9a\u901a\u9053\u4fe1\u53f7\u7684\u9891\u8c31</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u8f93\u5165\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)</p> \u5fc5\u9700 <code>channel_index</code> <code>int</code> <p>\u8981\u8ba1\u7b97\u9891\u8c31\u7684\u901a\u9053\u7d22\u5f15</p> \u5fc5\u9700 <code>window_size</code> <code>int</code> <p>STFT\u7a97\u53e3\u5927\u5c0f</p> <code>1024</code> <code>overlap</code> <code>float</code> <p>STFT\u7a97\u53e3\u91cd\u53e0\u6bd4\u4f8b</p> <code>0.5</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Dict[str, ndarray]</code> <p>Dict[str, np.ndarray]: \u5305\u542b\u9891\u7387('frequencies')\u548c\u5e73\u5747\u5e45\u503c('magnitudes')\u7684\u5b57\u5178</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/das_processor.py</code> <pre><code>def ComputeSpectrum(\n    self,\n    data: np.ndarray,\n    channel_index: int,\n    window_size: int = 1024,\n    overlap: float = 0.5,\n) -&gt; Dict[str, np.ndarray]:\n    \"\"\"\u8ba1\u7b97\u6307\u5b9a\u901a\u9053\u4fe1\u53f7\u7684\u9891\u8c31\n\n    Args:\n        data: \u8f93\u5165\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)\n        channel_index: \u8981\u8ba1\u7b97\u9891\u8c31\u7684\u901a\u9053\u7d22\u5f15\n        window_size: STFT\u7a97\u53e3\u5927\u5c0f\n        overlap: STFT\u7a97\u53e3\u91cd\u53e0\u6bd4\u4f8b\n\n    Returns:\n        Dict[str, np.ndarray]: \u5305\u542b\u9891\u7387('frequencies')\u548c\u5e73\u5747\u5e45\u503c('magnitudes')\u7684\u5b57\u5178\n    \"\"\"\n    if channel_index &lt; 0 or channel_index &gt;= data.shape[1]:\n        raise IndexError(\n            f\"\u901a\u9053\u7d22\u5f15 {channel_index} \u8d85\u51fa\u8303\u56f4 [0, {data.shape[1] - 1}]\"\n        )\n\n    # \u63d0\u53d6\u6307\u5b9a\u901a\u9053\u7684\u6570\u636e\n    channel_data = data[:, channel_index]\n\n    # \u8ba1\u7b97\u77ed\u65f6\u5085\u91cc\u53f6\u53d8\u6362 (STFT)\n    frequencies, times, spectrogram = signal.spectrogram(\n        channel_data,\n        fs=self.fs,\n        window=\"hann\",\n        nperseg=window_size,\n        noverlap=int(window_size * overlap),\n        detrend=\"constant\",\n        scaling=\"spectrum\",  # \u8fd4\u56de\u529f\u7387\u8c31\u5bc6\u5ea6\n    )\n\n    # \u8ba1\u7b97\u6bcf\u4e2a\u9891\u7387\u5206\u91cf\u7684\u5e73\u5747\u5e45\u503c (\u8de8\u65f6\u95f4)\n    # \u6ce8\u610f\uff1aspectrogram \u8fd4\u56de\u7684\u662f\u529f\u7387\u8c31\u5bc6\u5ea6\uff0c\u9700\u8981\u53d6\u5e73\u65b9\u6839\u5f97\u5230\u5e45\u503c\u8c31\n    # \u6216\u8005\u76f4\u63a5\u4f7f\u7528\u5e45\u503c\u8c31 (scaling='spectrum') \u8fd4\u56de\u7684\u7ed3\u679c\n    magnitudes = np.mean(np.abs(spectrogram), axis=1)\n\n    return {\"frequencies\": frequencies, \"magnitudes\": magnitudes}\n</code></pre>"},{"location":"reference/DASMatrix/processing/das_processor/#DASMatrix.processing.das_processor.DASProcessor.FindPeakFrequencies","title":"FindPeakFrequencies","text":"<pre><code>FindPeakFrequencies(\n    spectrum: Dict[str, ndarray],\n    min_freq: float = 0,\n    max_freq: Optional[float] = None,\n    n_peaks: int = 3,\n    min_prominence: Optional[float] = None,\n) -&gt; List[Dict[str, float]]\n</code></pre> <p>\u5728\u9891\u8c31\u4e2d\u67e5\u627e\u5cf0\u503c\u9891\u7387</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>spectrum</code> <code>Dict[str, ndarray]</code> <p>\u9891\u8c31\u6570\u636e\u5b57\u5178\uff0c\u5305\u542b 'frequencies' \u548c 'magnitudes'</p> \u5fc5\u9700 <code>min_freq</code> <code>float</code> <p>\u6700\u5c0f\u9891\u7387\u9650\u5236 (Hz)</p> <code>0</code> <code>max_freq</code> <code>Optional[float]</code> <p>\u6700\u5927\u9891\u7387\u9650\u5236 (Hz)\uff0c\u9ed8\u8ba4\u4e3aNone (\u4f7f\u7528\u6700\u5927\u9891\u7387)</p> <code>None</code> <code>n_peaks</code> <code>int</code> <p>\u8fd4\u56de\u7684\u6700\u5927\u5cf0\u503c\u6570\u91cf</p> <code>3</code> <code>min_prominence</code> <code>Optional[float]</code> <p>\u5cf0\u503c\u7684\u6700\u5c0f\u51f8\u8d77\u5ea6\uff0c\u7528\u4e8e\u8fc7\u6ee4\u4e0d\u663e\u8457\u7684\u5cf0\u503c</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[Dict[str, float]]</code> <p>List[Dict[str, float]]: \u5cf0\u503c\u5217\u8868\uff0c\u6bcf\u4e2a\u5cf0\u503c\u5305\u542b 'frequency' \u548c 'magnitude'</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/das_processor.py</code> <pre><code>def FindPeakFrequencies(\n    self,\n    spectrum: Dict[str, np.ndarray],\n    min_freq: float = 0,\n    max_freq: Optional[float] = None,\n    n_peaks: int = 3,\n    min_prominence: Optional[float] = None,  # \u65b0\u589e\uff1a\u5cf0\u503c\u6700\u5c0f\u51f8\u8d77\u5ea6\n) -&gt; List[Dict[str, float]]:\n    \"\"\"\u5728\u9891\u8c31\u4e2d\u67e5\u627e\u5cf0\u503c\u9891\u7387\n\n    Args:\n        spectrum: \u9891\u8c31\u6570\u636e\u5b57\u5178\uff0c\u5305\u542b 'frequencies' \u548c 'magnitudes'\n        min_freq: \u6700\u5c0f\u9891\u7387\u9650\u5236 (Hz)\n        max_freq: \u6700\u5927\u9891\u7387\u9650\u5236 (Hz)\uff0c\u9ed8\u8ba4\u4e3aNone (\u4f7f\u7528\u6700\u5927\u9891\u7387)\n        n_peaks: \u8fd4\u56de\u7684\u6700\u5927\u5cf0\u503c\u6570\u91cf\n        min_prominence: \u5cf0\u503c\u7684\u6700\u5c0f\u51f8\u8d77\u5ea6\uff0c\u7528\u4e8e\u8fc7\u6ee4\u4e0d\u663e\u8457\u7684\u5cf0\u503c\n\n    Returns:\n        List[Dict[str, float]]: \u5cf0\u503c\u5217\u8868\uff0c\u6bcf\u4e2a\u5cf0\u503c\u5305\u542b 'frequency' \u548c 'magnitude'\n    \"\"\"\n    frequencies = spectrum[\"frequencies\"]\n    magnitudes = spectrum[\"magnitudes\"]\n\n    if frequencies.size == 0 or magnitudes.size == 0:\n        self.logger.warning(\"\u9891\u8c31\u6570\u636e\u4e3a\u7a7a\uff0c\u65e0\u6cd5\u67e5\u627e\u5cf0\u503c\")\n        return []\n\n    # \u9650\u5236\u9891\u7387\u8303\u56f4\n    if max_freq is None:\n        max_freq = frequencies[-1]\n\n    mask = (frequencies &gt;= min_freq) &amp; (frequencies &lt;= max_freq)\n    valid_freqs = frequencies[mask]\n    valid_mags = magnitudes[mask]\n\n    if valid_freqs.size == 0:\n        self.logger.warning(\"\u5728\u6307\u5b9a\u9891\u7387\u8303\u56f4\u5185\u6ca1\u6709\u6570\u636e\u70b9\uff0c\u65e0\u6cd5\u67e5\u627e\u5cf0\u503c\")\n        return []\n\n    # \u67e5\u627e\u5cf0\u503c\n    peaks, properties = signal.find_peaks(valid_mags, prominence=min_prominence)\n\n    if len(peaks) == 0:\n        self.logger.info(\"\u5728\u6307\u5b9a\u8303\u56f4\u5185\u672a\u627e\u5230\u663e\u8457\u5cf0\u503c\")\n        return []\n\n    # \u6309\u5e45\u503c\u6392\u5e8f\u5cf0\u503c (\u4f7f\u7528\u5cf0\u503c\u5904\u7684\u5e45\u503c\uff0c\u800c\u4e0d\u662f\u51f8\u8d77\u5ea6)\n    peak_magnitudes = valid_mags[peaks]\n    sorted_indices = np.argsort(peak_magnitudes)[::-1]  # \u964d\u5e8f\u6392\u5e8f\n\n    # \u53d6\u524d n_peaks \u4e2a\u5cf0\u503c\n    top_peak_indices = peaks[sorted_indices[:n_peaks]]\n\n    # \u6784\u5efa\u7ed3\u679c\n    result = []\n    for idx in top_peak_indices:\n        result.append(\n            {\n                \"frequency\": valid_freqs[idx],\n                \"magnitude\": valid_mags[idx],\n            }\n        )\n\n    self.logger.debug(f\"\u627e\u5230 {len(result)} \u4e2a\u5cf0\u503c: {result}\")\n    return result\n</code></pre>"},{"location":"reference/DASMatrix/processing/das_processor/#DASMatrix.processing.das_processor.DASProcessor.ApplyBandpassFilter","title":"ApplyBandpassFilter","text":"<pre><code>ApplyBandpassFilter(\n    data: ndarray, low_freq: float, high_freq: float\n) -&gt; np.ndarray\n</code></pre> <p>\u5e94\u7528\u5e26\u901a\u6ee4\u6ce2\u5668</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u8f93\u5165\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)</p> \u5fc5\u9700 <code>low_freq</code> <code>float</code> <p>\u4f4e\u622a\u6b62\u9891\u7387 (Hz)</p> \u5fc5\u9700 <code>high_freq</code> <code>float</code> <p>\u9ad8\u622a\u6b62\u9891\u7387 (Hz)</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u6ee4\u6ce2\u540e\u7684\u6570\u636e</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/das_processor.py</code> <pre><code>def ApplyBandpassFilter(\n    self, data: np.ndarray, low_freq: float, high_freq: float\n) -&gt; np.ndarray:\n    \"\"\"\u5e94\u7528\u5e26\u901a\u6ee4\u6ce2\u5668\n\n    Args:\n        data: \u8f93\u5165\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)\n        low_freq: \u4f4e\u622a\u6b62\u9891\u7387 (Hz)\n        high_freq: \u9ad8\u622a\u6b62\u9891\u7387 (Hz)\n\n    Returns:\n        np.ndarray: \u6ee4\u6ce2\u540e\u7684\u6570\u636e\n    \"\"\"\n    # \u8bbe\u8ba1\u5e26\u901a\u6ee4\u6ce2\u5668\n    sos_bandpass = self._create_filter(\n        cutoff=[low_freq, high_freq], btype=\"bandpass\"\n    )\n\n    # \u5e94\u7528\u6ee4\u6ce2\u5668\n    filtered_data = self.ApplyFilter(data, sos_bandpass)\n    return filtered_data\n</code></pre>"},{"location":"reference/DASMatrix/processing/das_processor/#DASMatrix.processing.das_processor.DASProcessor.EvaluateFrequencyResponse","title":"EvaluateFrequencyResponse","text":"<pre><code>EvaluateFrequencyResponse(\n    data: ndarray,\n    target_frequencies: List[float],\n    window_size: int = 1024,\n) -&gt; List[Dict[str, Any]]\n</code></pre> <p>\u5206\u6790\u7279\u5b9a\u9891\u7387\u4e0b\u7684\u54cd\u5e94</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u8f93\u5165\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)</p> \u5fc5\u9700 <code>target_frequencies</code> <code>List[float]</code> <p>\u76ee\u6807\u9891\u7387\u5217\u8868 (Hz)</p> \u5fc5\u9700 <code>window_size</code> <code>int</code> <p>\u7528\u4e8e\u9891\u8c31\u8ba1\u7b97\u7684\u7a97\u53e3\u5927\u5c0f</p> <code>1024</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>List[Dict[str, Any]]</code> <p>List[Dict[str, Any]]: \u5305\u542b\u6bcf\u4e2a\u76ee\u6807\u9891\u7387\u54cd\u5e94\u4fe1\u606f\u7684\u5217\u8868                    \u6bcf\u4e2a\u5b57\u5178\u5305\u542b: 'freq', 'max_response_channel',                    'peak_response_value', 'all_channel_responses' (RMS)</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/das_processor.py</code> <pre><code>def EvaluateFrequencyResponse(\n    self, data: np.ndarray, target_frequencies: List[float], window_size: int = 1024\n) -&gt; List[Dict[str, Any]]:\n    \"\"\"\u5206\u6790\u7279\u5b9a\u9891\u7387\u4e0b\u7684\u54cd\u5e94\n\n    Args:\n        data: \u8f93\u5165\u6570\u636e (\u65f6\u95f4\u8f74\u5728 axis=0)\n        target_frequencies: \u76ee\u6807\u9891\u7387\u5217\u8868 (Hz)\n        window_size: \u7528\u4e8e\u9891\u8c31\u8ba1\u7b97\u7684\u7a97\u53e3\u5927\u5c0f\n\n    Returns:\n        List[Dict[str, Any]]: \u5305\u542b\u6bcf\u4e2a\u76ee\u6807\u9891\u7387\u54cd\u5e94\u4fe1\u606f\u7684\u5217\u8868\n                               \u6bcf\u4e2a\u5b57\u5178\u5305\u542b: 'freq', 'max_response_channel',\n                               'peak_response_value', 'all_channel_responses' (RMS)\n    \"\"\"\n    analysis_results = []\n\n    for freq in target_frequencies:\n        self.logger.debug(f\"\u5206\u6790\u9891\u7387 {freq}Hz\")\n        # \u5bf9\u6bcf\u4e2a\u9891\u7387\u5e94\u7528\u7a84\u5e26\u5e26\u901a\u6ee4\u6ce2\n        # \u53ef\u4ee5\u6839\u636e\u9700\u8981\u8c03\u6574\u5e26\u5bbd\uff0c\u4f8b\u5982 +/- 5% \u6216\u56fa\u5b9a\u5e26\u5bbd\n        bandwidth_ratio = 0.10  # \u4f8b\u5982 +/- 10%\n        low_freq = freq * (1 - bandwidth_ratio / 2)\n        high_freq = freq * (1 + bandwidth_ratio / 2)\n\n        # \u786e\u4fdd\u9891\u7387\u8303\u56f4\u6709\u6548\n        if low_freq &lt; 0:\n            low_freq = 1e-3  # \u907f\u514d0Hz\n        if high_freq &gt; self.fs / 2:\n            high_freq = self.fs / 2 - 1e-3  # \u907f\u514d\u5948\u594e\u65af\u7279\u9891\u7387\n\n        if low_freq &gt;= high_freq:\n            self.logger.warning(\n                f\"\u9891\u7387 {freq}Hz \u8ba1\u7b97\u51fa\u7684\u5e26\u5bbd\u65e0\u6548 [{low_freq:.2f}, {high_freq:.2f}]\"\n                f\"\u8df3\u8fc7\u6b64\u9891\u7387\"\n            )\n            continue\n\n        filtered_data = self.ApplyBandpassFilter(data, low_freq, high_freq)\n\n        # \u8ba1\u7b97\u6bcf\u4e2a\u901a\u9053\u6ee4\u6ce2\u540e\u7684\u5747\u65b9\u6839 (RMS) \u503c\u4f5c\u4e3a\u54cd\u5e94\u5f3a\u5ea6\n        rms_values = np.sqrt(np.mean(filtered_data**2, axis=0))\n\n        if rms_values.size == 0:\n            self.logger.warning(f\"\u9891\u7387 {freq}Hz \u6ee4\u6ce2\u540e\u65e0\u6709\u6548\u54cd\u5e94\u6570\u636e\")\n            continue\n\n        # \u627e\u51fa\u54cd\u5e94\u6700\u5f3a\u7684\u901a\u9053\u53ca\u5176RMS\u503c\n        max_response_channel = np.argmax(rms_values)\n        peak_response_value = rms_values[max_response_channel]\n\n        self.logger.debug(\n            f\"\u9891\u7387 {freq}Hz: \u6700\u5927\u54cd\u5e94\u901a\u9053 {max_response_channel}, \"\n            f\"\u5cf0\u503cRMS {peak_response_value:.4f}\"\n        )\n\n        analysis_results.append(\n            {\n                \"freq\": freq,\n                \"max_response_channel\": int(max_response_channel),  # \u786e\u4fdd\u662f\u6574\u6570\n                \"peak_response_value\": peak_response_value,\n                \"all_channel_responses\": rms_values,  # \u8fd4\u56de\u6240\u6709\u901a\u9053\u7684RMS\u503c\n            }\n        )\n\n    return analysis_results\n</code></pre>"},{"location":"reference/DASMatrix/processing/das_processor/#DASMatrix.processing.das_processor.DASProcessor.f_k_transform","title":"f_k_transform","text":"<pre><code>f_k_transform(\n    data: ndarray,\n) -&gt; Tuple[np.ndarray, np.ndarray, np.ndarray]\n</code></pre> <p>\u6267\u884c\u4e8c\u7ef4\u5085\u91cc\u53f6\u53d8\u6362 (F-K \u53d8\u6362)</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u8f93\u5165\u65f6\u7a7a\u6570\u636e (n_time, n_channels)</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Tuple[ndarray, ndarray, ndarray]</code> <p>Tuple[np.ndarray, np.ndarray, np.ndarray]: (spectrum, freqs, wavenumbers) - spectrum: FK \u8c31 (complex) - freqs: \u9891\u7387\u8f74 (Hz) - wavenumbers: \u6ce2\u6570\u8f74 (1/m) \u6ce8\u610f\uff1a\u9700\u8981\u77e5\u9053\u7a7a\u95f4\u91c7\u6837\u7387\uff0c\u6b64\u5904\u6682\u5047\u8bbe dx=1</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/das_processor.py</code> <pre><code>def f_k_transform(\n    self, data: np.ndarray\n) -&gt; Tuple[np.ndarray, np.ndarray, np.ndarray]:\n    \"\"\"\u6267\u884c\u4e8c\u7ef4\u5085\u91cc\u53f6\u53d8\u6362 (F-K \u53d8\u6362)\n\n    Args:\n        data: \u8f93\u5165\u65f6\u7a7a\u6570\u636e (n_time, n_channels)\n\n    Returns:\n        Tuple[np.ndarray, np.ndarray, np.ndarray]: (spectrum, freqs, wavenumbers)\n            - spectrum: FK \u8c31 (complex)\n            - freqs: \u9891\u7387\u8f74 (Hz)\n            - wavenumbers: \u6ce2\u6570\u8f74 (1/m) \u6ce8\u610f\uff1a\u9700\u8981\u77e5\u9053\u7a7a\u95f4\u91c7\u6837\u7387\uff0c\u6b64\u5904\u6682\u5047\u8bbe dx=1\n    \"\"\"\n    nt, nx = data.shape\n\n    # \u5bf9\u65f6\u95f4\u548c\u7a7a\u95f4\u7ef4\u5ea6\u8fdb\u884c FFT\n    # \u79fb\u4f4d\u5c06\u96f6\u9891\u79fb\u5230\u4e2d\u5fc3\n    fk = np.fft.fftshift(np.fft.fft2(data))\n\n    # \u8ba1\u7b97\u5750\u6807\u8f74\n    freqs = np.fft.fftshift(np.fft.fftfreq(nt, 1.0 / self.fs))\n    wavenumbers = np.fft.fftshift(\n        np.fft.fftfreq(nx)\n    )  # \u6807\u51c6\u5316\u6ce2\u6570\uff0c\u5b9e\u9645\u6ce2\u6570\u9700\u9664\u4ee5 d_x\n\n    return fk, freqs, wavenumbers\n</code></pre>"},{"location":"reference/DASMatrix/processing/das_processor/#DASMatrix.processing.das_processor.DASProcessor.iwf_k_transform","title":"iwf_k_transform","text":"<pre><code>iwf_k_transform(fk_spectrum: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u6267\u884c\u9006\u4e8c\u7ef4\u5085\u91cc\u53f6\u53d8\u6362 (Inverse F-K \u53d8\u6362)</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>fk_spectrum</code> <code>ndarray</code> <p>FK \u8c31 (complex)</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u6062\u590d\u7684\u65f6\u57df\u6570\u636e (real)</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/das_processor.py</code> <pre><code>def iwf_k_transform(self, fk_spectrum: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u6267\u884c\u9006\u4e8c\u7ef4\u5085\u91cc\u53f6\u53d8\u6362 (Inverse F-K \u53d8\u6362)\n\n    Args:\n        fk_spectrum: FK \u8c31 (complex)\n\n    Returns:\n        np.ndarray: \u6062\u590d\u7684\u65f6\u57df\u6570\u636e (real)\n    \"\"\"\n    # \u9006\u79fb\u4f4d\u540e\u9006\u53d8\u6362\n    # \u4f7f\u7528 ifft2 \u6062\u590d\uff0c\u5e76\u53ea\u53d6\u5b9e\u90e8\uff08\u5047\u8bbe\u8f93\u5165\u6570\u636e\u4e3a\u5b9e\u6570\uff09\n    data = np.fft.ifft2(np.fft.ifftshift(fk_spectrum)).real\n    return data\n</code></pre>"},{"location":"reference/DASMatrix/processing/das_processor/#DASMatrix.processing.das_processor.DASProcessor.FKFilter","title":"FKFilter","text":"<pre><code>FKFilter(\n    data: ndarray,\n    v_min: Optional[float] = None,\n    v_max: Optional[float] = None,\n    dx: float = 1.0,\n) -&gt; np.ndarray\n</code></pre> <p>\u5e94\u7528 F-K \u6ee4\u6ce2\u5668\uff08\u901f\u5ea6\u6ee4\u6ce2\uff09</p> <p>\u901a\u8fc7\u5728 F-K \u57df\u4e2d\u5b9a\u4e49\u6247\u5f62\u533a\u57df\u6765\u4fdd\u7559\u6216\u5207\u9664\u7279\u5b9a\u89c6\u901f\u5ea6\u7684\u6ce2\u573a\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u8f93\u5165\u6570\u636e (n_time, n_channels)</p> \u5fc5\u9700 <code>v_min</code> <code>Optional[float]</code> <p>\u6700\u5c0f\u4fdd\u7559\u89c6\u901f\u5ea6 (m/s)</p> <code>None</code> <code>v_max</code> <code>Optional[float]</code> <p>\u6700\u5927\u4fdd\u7559\u89c6\u901f\u5ea6 (m/s)</p> <code>None</code> <code>dx</code> <code>float</code> <p>\u901a\u9053\u95f4\u8ddd (m)</p> <code>1.0</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u6ee4\u6ce2\u540e\u7684\u6570\u636e</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/das_processor.py</code> <pre><code>def FKFilter(\n    self,\n    data: np.ndarray,\n    v_min: Optional[float] = None,\n    v_max: Optional[float] = None,\n    dx: float = 1.0,\n) -&gt; np.ndarray:\n    \"\"\"\u5e94\u7528 F-K \u6ee4\u6ce2\u5668\uff08\u901f\u5ea6\u6ee4\u6ce2\uff09\n\n    \u901a\u8fc7\u5728 F-K \u57df\u4e2d\u5b9a\u4e49\u6247\u5f62\u533a\u57df\u6765\u4fdd\u7559\u6216\u5207\u9664\u7279\u5b9a\u89c6\u901f\u5ea6\u7684\u6ce2\u573a\u3002\n\n    Args:\n        data: \u8f93\u5165\u6570\u636e (n_time, n_channels)\n        v_min: \u6700\u5c0f\u4fdd\u7559\u89c6\u901f\u5ea6 (m/s)\n        v_max: \u6700\u5927\u4fdd\u7559\u89c6\u901f\u5ea6 (m/s)\n        dx: \u901a\u9053\u95f4\u8ddd (m)\n\n    Returns:\n        np.ndarray: \u6ee4\u6ce2\u540e\u7684\u6570\u636e\n    \"\"\"\n    nt, nx = data.shape\n    fk, freqs, k = self.f_k_transform(data)\n\n    # \u8c03\u6574\u6ce2\u6570\u8f74\u4e3a\u7269\u7406\u5355\u4f4d (1/m)\n    k = k / dx\n\n    # \u521b\u5efa\u7f51\u683c\n    K, F = np.meshgrid(k, freqs)\n\n    # \u8ba1\u7b97\u89c6\u901f\u5ea6 V = f / k\n    # \u6ce8\u610f\u5904\u7406 k=0 \u7684\u60c5\u51b5\n    with np.errstate(divide=\"ignore\", invalid=\"ignore\"):\n        V = F / K\n\n    # \u521b\u5efa\u63a9\u7801\n    mask = np.ones_like(fk, dtype=bool)\n\n    if v_min is not None:\n        # \u4ec5\u4fdd\u7559\u901f\u5ea6\u5927\u4e8e v_min \u7684\u6ce2 (\u6216\u5c0f\u4e8e -v_min\uff0c\u5bf9\u79f0)\n        # \u5b9e\u9645\u4e0a FK \u6ee4\u6ce2\u901a\u5e38\u5b9a\u4e49\u4e3a\u4e00\u4e2a\u6247\u533a\n        # \u8fd9\u91cc\u7b80\u5355\u5b9e\u73b0\uff1a\u4fdd\u7559 abs(V) &gt;= v_min\n        mask &amp;= (np.abs(V) &gt;= abs(v_min)) | np.isnan(V)\n\n    if v_max is not None:\n        # \u4fdd\u7559 abs(V) &lt;= v_max\n        mask &amp;= (np.abs(V) &lt;= abs(v_max)) | np.isnan(V)\n\n    # \u5e94\u7528\u63a9\u7801\n    fk_filtered = fk * mask\n\n    # \u9006\u53d8\u6362\n    return self.iwf_k_transform(fk_filtered)\n</code></pre>"},{"location":"reference/DASMatrix/processing/engine/","title":"engine","text":""},{"location":"reference/DASMatrix/processing/engine/#DASMatrix.processing.engine","title":"engine","text":"<p>\u6df7\u5408\u6267\u884c\u5f15\u64ce\u6a21\u5757\u3002</p> <p>\u672c\u6a21\u5757\u63d0\u4f9b DASFrame \u5ef6\u8fdf\u8ba1\u7b97\u7684\u6838\u5fc3\u6267\u884c\u5f15\u64ce\uff0c\u8d1f\u8d23\uff1a - \u8ba1\u7b97\u56fe\u4f18\u5316\uff08\u7b97\u5b50\u878d\u5408\u7b49\uff09 - \u8c03\u5ea6\u4e0d\u540c\u540e\u7aef\uff08NumPy/SciPy\u3001Numba JIT\uff09 - \u9012\u5f52\u6267\u884c\u8ba1\u7b97\u56fe\u8282\u70b9</p>"},{"location":"reference/DASMatrix/processing/engine/#DASMatrix.processing.engine.HybridEngine","title":"HybridEngine","text":"<pre><code>HybridEngine()\n</code></pre> <p>\u6df7\u5408\u6267\u884c\u5f15\u64ce\uff0c\u534f\u8c03\u4f18\u5316\u5668\u548c\u591a\u540e\u7aef\u6267\u884c\u3002</p> <p>HybridEngine \u662f DASFrame \u5ef6\u8fdf\u8ba1\u7b97\u7684\u6838\u5fc3\u7ec4\u4ef6\uff0c\u8d1f\u8d23\uff1a 1. \u8c03\u7528 ExecutionPlanner \u4f18\u5316\u8ba1\u7b97\u56fe 2. \u6839\u636e\u8282\u70b9\u7c7b\u578b\u8c03\u5ea6\u5408\u9002\u7684\u540e\u7aef 3. \u9012\u5f52\u6267\u884c\u8ba1\u7b97\u56fe\u5e76\u7f13\u5b58\u4e2d\u95f4\u7ed3\u679c</p> <p>\u5c5e\u6027\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>planner</code> <p>\u6267\u884c\u8ba1\u5212\u4f18\u5316\u5668</p> <code>numba_backend</code> <p>Numba JIT \u540e\u7aef</p> <p>\u521d\u59cb\u5316\u6df7\u5408\u6267\u884c\u5f15\u64ce\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/engine.py</code> <pre><code>def __init__(self) -&gt; None:\n    \"\"\"\u521d\u59cb\u5316\u6df7\u5408\u6267\u884c\u5f15\u64ce\u3002\"\"\"\n    self.planner = ExecutionPlanner()\n    self.numba_backend = NumbaBackend()\n</code></pre>"},{"location":"reference/DASMatrix/processing/engine/#DASMatrix.processing.engine.HybridEngine.compute","title":"compute","text":"<pre><code>compute(graph: ComputationGraph) -&gt; Any\n</code></pre> <p>\u6267\u884c\u8ba1\u7b97\u56fe\u5e76\u8fd4\u56de\u7ed3\u679c\u3002</p> <p>\u8fd9\u662f\u5f15\u64ce\u7684\u4e3b\u5165\u53e3\u70b9\uff0c\u8d1f\u8d23\u4f18\u5316\u548c\u6267\u884c\u6574\u4e2a\u8ba1\u7b97\u56fe\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>graph</code> <code>ComputationGraph</code> <p>\u8981\u6267\u884c\u7684\u8ba1\u7b97\u56fe</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Any</code> <code>Any</code> <p>\u8ba1\u7b97\u56fe\u6839\u8282\u70b9\u7684\u8ba1\u7b97\u7ed3\u679c\uff08\u901a\u5e38\u4e3a NumPy \u6570\u7ec4\uff09</p> <p>\u5f15\u53d1\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ValueError</code> <p>\u5f53\u8ba1\u7b97\u56fe\u4e3a\u7a7a\u65f6</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/engine.py</code> <pre><code>def compute(self, graph: ComputationGraph) -&gt; Any:\n    \"\"\"\u6267\u884c\u8ba1\u7b97\u56fe\u5e76\u8fd4\u56de\u7ed3\u679c\u3002\n\n    \u8fd9\u662f\u5f15\u64ce\u7684\u4e3b\u5165\u53e3\u70b9\uff0c\u8d1f\u8d23\u4f18\u5316\u548c\u6267\u884c\u6574\u4e2a\u8ba1\u7b97\u56fe\u3002\n\n    Args:\n        graph: \u8981\u6267\u884c\u7684\u8ba1\u7b97\u56fe\n\n    Returns:\n        Any: \u8ba1\u7b97\u56fe\u6839\u8282\u70b9\u7684\u8ba1\u7b97\u7ed3\u679c\uff08\u901a\u5e38\u4e3a NumPy \u6570\u7ec4\uff09\n\n    Raises:\n        ValueError: \u5f53\u8ba1\u7b97\u56fe\u4e3a\u7a7a\u65f6\n    \"\"\"\n    opt_graph = self.planner.optimize(graph)\n\n    if not opt_graph.root:\n        raise ValueError(\"Empty computation graph\")\n\n    return self._execute_node(opt_graph.root)\n</code></pre>"},{"location":"reference/DASMatrix/processing/backends/","title":"backends","text":""},{"location":"reference/DASMatrix/processing/backends/#DASMatrix.processing.backends","title":"backends","text":""},{"location":"reference/DASMatrix/processing/backends/numba_backend/","title":"numba_backend","text":""},{"location":"reference/DASMatrix/processing/backends/numba_backend/#DASMatrix.processing.backends.numba_backend","title":"numba_backend","text":"<p>Numba \u540e\u7aef\u5b9e\u73b0\uff0c\u8d1f\u8d23 JIT \u7f16\u8bd1\u548c\u6267\u884c\u878d\u5408\u7b97\u5b50\u3002</p>"},{"location":"reference/DASMatrix/processing/backends/numba_backend/#DASMatrix.processing.backends.numba_backend.NumbaBackend","title":"NumbaBackend","text":"<pre><code>NumbaBackend()\n</code></pre> <p>Numba \u9ad8\u6027\u80fd\u8ba1\u7b97\u540e\u7aef\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/backends/numba_backend.py</code> <pre><code>def __init__(self):\n    self._cache = {}  # \u7f13\u5b58\u7f16\u8bd1\u540e\u7684\u5185\u6838\n</code></pre>"},{"location":"reference/DASMatrix/processing/backends/numba_backend/#DASMatrix.processing.backends.numba_backend.NumbaBackend.execute","title":"execute","text":"<pre><code>execute(node: FusionNode, data: ndarray) -&gt; np.ndarray\n</code></pre> <p>\u6267\u884c\u878d\u5408\u8282\u70b9\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>node</code> <code>FusionNode</code> <p>FusionNode</p> \u5fc5\u9700 <code>data</code> <code>ndarray</code> <p>\u8f93\u5165\u6570\u636e (numpy array)</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>ndarray</code> <p>np.ndarray: \u8ba1\u7b97\u7ed3\u679c</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/backends/numba_backend.py</code> <pre><code>def execute(self, node: FusionNode, data: np.ndarray) -&gt; np.ndarray:\n    \"\"\"\u6267\u884c\u878d\u5408\u8282\u70b9\u3002\n\n    Args:\n        node: FusionNode\n        data: \u8f93\u5165\u6570\u636e (numpy array)\n\n    Returns:\n        np.ndarray: \u8ba1\u7b97\u7ed3\u679c\n    \"\"\"\n    # 1. \u9884\u8ba1\u7b97\u9636\u6bb5 (Pre-computation for Reduction Ops)\n    # \u67d0\u4e9b\u7b97\u5b50\u5982 detrend, demean \u9700\u8981\u9884\u5148\u626b\u63cf\u6570\u636e\u83b7\u53d6\u5168\u5c40\u53c2\u6570\n    aux_params = self._prepare_aux_params(node, data)\n\n    # 2. \u83b7\u53d6/\u7f16\u8bd1\u5185\u6838\n    kernel_key = self._get_kernel_signature(node)\n    if kernel_key not in self._cache:\n        self._cache[kernel_key] = self._compile_kernel(\n            node, has_aux=bool(aux_params)\n        )\n\n    kernel_func = self._cache[kernel_key]\n\n    # 3. \u51c6\u5907\u8f93\u51fa\u6570\u7ec4\n    out = np.empty_like(data)\n\n    # 4. \u6267\u884c\u5185\u6838\n    # \u53c2\u6570: (inp, out, *aux_values)\n    args = [data, out]\n    if aux_params:\n        args.extend(aux_params)\n\n    kernel_func(*args)\n\n    return out\n</code></pre>"},{"location":"reference/DASMatrix/processing/backends/polars_backend/","title":"polars_backend","text":""},{"location":"reference/DASMatrix/processing/backends/polars_backend/#DASMatrix.processing.backends.polars_backend","title":"polars_backend","text":"<p>Polars \u540e\u7aef\u5b9e\u73b0\uff0c\u8d1f\u8d23\u5143\u6570\u636e\u67e5\u8be2\u4e0e\u8fc7\u6ee4\u3002</p>"},{"location":"reference/DASMatrix/processing/backends/polars_backend/#DASMatrix.processing.backends.polars_backend.PolarsBackend","title":"PolarsBackend","text":"<pre><code>PolarsBackend(meta_df: DataFrame)\n</code></pre> <p>Polars \u5143\u6570\u636e\u540e\u7aef\u3002</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/backends/polars_backend.py</code> <pre><code>def __init__(self, meta_df: pl.DataFrame):\n    self.meta = meta_df.lazy()\n</code></pre>"},{"location":"reference/DASMatrix/processing/backends/polars_backend/#DASMatrix.processing.backends.polars_backend.PolarsBackend.filter","title":"filter","text":"<pre><code>filter(expr: str) -&gt; PolarsBackend\n</code></pre> <p>\u6267\u884c SQL-like \u8fc7\u6ee4\u5b57\u7b26\u4e32</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/backends/polars_backend.py</code> <pre><code>def filter(self, expr: str) -&gt; \"PolarsBackend\":\n    \"\"\"\u6267\u884c SQL-like \u8fc7\u6ee4\u5b57\u7b26\u4e32\"\"\"\n    # \u8fd9\u91cc\u5e94\u8be5\u6709\u4e00\u4e2a\u7b80\u5355\u7684 parser \u5c06 string \u8f6c\u4e3a polars expr\n    # \u7b80\u5316\u6f14\u793a\uff1a\u76f4\u63a5\u5047\u8bbe\u4f20\u5165\u7684\u662f polars expression \u5bf9\u8c61\n    # \u5b9e\u9645 DSL \u5b9e\u73b0\u9700\u8981 dsl.py \u89e3\u6790\u5668\u7684\u652f\u6301\n    raise NotImplementedError(\"String expression filtering not implemented yet\")\n</code></pre>"},{"location":"reference/DASMatrix/processing/backends/polars_backend/#DASMatrix.processing.backends.polars_backend.PolarsBackend.select_channels","title":"select_channels","text":"<pre><code>select_channels(condition: Expr) -&gt; List[int]\n</code></pre> <p>\u6839\u636e\u6761\u4ef6\u7b5b\u9009\u901a\u9053\u7d22\u5f15</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/backends/polars_backend.py</code> <pre><code>def select_channels(self, condition: pl.Expr) -&gt; List[int]:\n    \"\"\"\u6839\u636e\u6761\u4ef6\u7b5b\u9009\u901a\u9053\u7d22\u5f15\"\"\"\n    # \u89e6\u53d1\u8ba1\u7b97\uff0c\u83b7\u53d6\u7b26\u5408\u6761\u4ef6\u7684 channel index\n    res = self.meta.filter(condition).select(\"channel_index\").collect()\n    return res[\"channel_index\"].to_list()\n</code></pre>"},{"location":"reference/DASMatrix/processing/kernels/","title":"kernels","text":""},{"location":"reference/DASMatrix/processing/kernels/#DASMatrix.processing.kernels","title":"kernels","text":""},{"location":"reference/DASMatrix/processing/kernels/cpu/","title":"cpu","text":""},{"location":"reference/DASMatrix/processing/kernels/cpu/#DASMatrix.processing.kernels.cpu","title":"cpu","text":""},{"location":"reference/DASMatrix/processing/kernels/gpu/","title":"gpu","text":""},{"location":"reference/DASMatrix/processing/kernels/gpu/#DASMatrix.processing.kernels.gpu","title":"gpu","text":""},{"location":"reference/DASMatrix/processing/planner/","title":"planner","text":""},{"location":"reference/DASMatrix/processing/planner/#DASMatrix.processing.planner","title":"planner","text":""},{"location":"reference/DASMatrix/processing/planner/optimizer/","title":"optimizer","text":""},{"location":"reference/DASMatrix/processing/planner/optimizer/#DASMatrix.processing.planner.optimizer","title":"optimizer","text":"<p>\u6267\u884c\u8ba1\u5212\u4f18\u5316\u5668\u3002\u8d1f\u8d23\u5c06\u903b\u8f91\u8ba1\u7b97\u56fe\u8f6c\u6362\u4e3a\u7269\u7406\u6267\u884c\u8ba1\u5212\uff0c\u5b9e\u65bd\u7b97\u5b50\u878d\u5408\u3002</p>"},{"location":"reference/DASMatrix/processing/planner/optimizer/#DASMatrix.processing.planner.optimizer.ExecutionPlanner","title":"ExecutionPlanner","text":"<p>\u6267\u884c\u8ba1\u5212\u751f\u6210\u5668\u4e0e\u4f18\u5316\u5668\u3002</p>"},{"location":"reference/DASMatrix/processing/planner/optimizer/#DASMatrix.processing.planner.optimizer.ExecutionPlanner.optimize","title":"optimize","text":"<pre><code>optimize(graph: ComputationGraph) -&gt; ComputationGraph\n</code></pre> <p>\u5bf9\u8ba1\u7b97\u56fe\u8fdb\u884c\u4f18\u5316\uff0c\u4e3b\u8981\u662f\u8fdb\u884c\u7b97\u5b50\u878d\u5408\u3002</p> <p>\u7b56\u7565: 1. \u904d\u5386\u56fe\u8282\u70b9 (\u62d3\u6251\u5e8f)\u3002 2. \u8bc6\u522b\u8fde\u7eed\u7684\u53ef\u878d\u5408 SIGNAL \u57df\u8282\u70b9\u3002 3. \u5c06\u5b83\u4eec\u5408\u5e76\u4e3a FusionNode\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>graph</code> <code>ComputationGraph</code> <p>\u539f\u59cb\u8ba1\u7b97\u56fe</p> \u5fc5\u9700 <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>ComputationGraph</code> <code>ComputationGraph</code> <p>\u4f18\u5316\u540e\u7684\u8ba1\u7b97\u56fe (\u5305\u542b FusionNode)</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/processing/planner/optimizer.py</code> <pre><code>def optimize(self, graph: ComputationGraph) -&gt; ComputationGraph:\n    \"\"\"\n    \u5bf9\u8ba1\u7b97\u56fe\u8fdb\u884c\u4f18\u5316\uff0c\u4e3b\u8981\u662f\u8fdb\u884c\u7b97\u5b50\u878d\u5408\u3002\n\n    \u7b56\u7565:\n    1. \u904d\u5386\u56fe\u8282\u70b9 (\u62d3\u6251\u5e8f)\u3002\n    2. \u8bc6\u522b\u8fde\u7eed\u7684\u53ef\u878d\u5408 SIGNAL \u57df\u8282\u70b9\u3002\n    3. \u5c06\u5b83\u4eec\u5408\u5e76\u4e3a FusionNode\u3002\n\n    Args:\n        graph: \u539f\u59cb\u8ba1\u7b97\u56fe\n\n    Returns:\n        ComputationGraph: \u4f18\u5316\u540e\u7684\u8ba1\u7b97\u56fe (\u5305\u542b FusionNode)\n    \"\"\"\n    if not graph.root:\n        return graph\n\n    # 1. \u83b7\u53d6\u7ebf\u6027\u5316\u7684\u8282\u70b9\u5e8f\u5217 (\u8fd9\u91cc\u7b80\u5316\u5047\u8bbe\u662f\u5355\u94fe\u7ed3\u6784\uff0c\u590d\u6742\u56fe\u9700\u8981\u66f4\u590d\u6742\u7684\u62d3\u6251\u904d\u5386)\n    # TODO: \u652f\u6301\u591a\u5206\u652f DAG\n    linear_nodes = self._linearize(graph.root)\n\n    # 2. \u6267\u884c\u878d\u5408\n    optimized_nodes = self._fuse_signal_nodes(linear_nodes)\n\n    # 3.\u4ee5\u6b64\u6784\u5efa\u65b0\u56fe\uff0c\u8fd4\u56de\u65b0\u7684 root\n    # \u6ce8\u610f\uff1a\u8fd9\u91cc\u7b80\u5316\u5904\u7406\uff0c\u5047\u8bbe optimized_nodes \u7684\u6700\u540e\u4e00\u4e2a\u662f root\n    if not optimized_nodes:\n        return ComputationGraph(None)\n\n    # \u91cd\u5efa\u5f15\u7528\u5173\u7cfb (\u94fe\u5f0f)\n    # \u8fd9\u4e00\u6b65\u6bd4\u8f83 tricky\uff0c\u56e0\u4e3a\u6211\u4eec\u6539\u53d8\u4e86\u56fe\u7ed3\u6784\u3002\n    # \u7b80\u5316\u7684\u505a\u6cd5\uff1a\u81ea\u5e95\u5411\u4e0a\u91cd\u5efa\u3002\n\n    # \u8fd9\u91cc\u7684\u5b9e\u73b0\u662f\u4e00\u4e2a\u7b80\u5316\u7684 Pass\uff1a\n    # \u6211\u4eec\u5047\u8bbe\u4e3b\u8981\u662f\u5355\u94fe\u7ed3\u6784\uff08Time-Series Pipe\uff09\uff0c\u8fd9\u8986\u76d6\u4e86 DSL 90% \u7684\u573a\u666f\u3002\n\n    current_node = optimized_nodes[0]  # Source\n    for i in range(1, len(optimized_nodes)):\n        next_node = optimized_nodes[i]\n        # \u91cd\u65b0\u8fde\u63a5 input\n        next_node.inputs = [current_node]\n        current_node = next_node\n\n    return ComputationGraph(current_node)\n</code></pre>"},{"location":"reference/DASMatrix/visualization/","title":"visualization","text":""},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization","title":"visualization","text":"<p>\u53ef\u89c6\u5316\u6a21\u5757</p> <p>\u63d0\u4f9b Nature/Science \u671f\u520a\u7ea7\u522b\u7684\u53ef\u89c6\u5316\u5de5\u5177\u3002</p>"},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization.DASVisualizer","title":"DASVisualizer","text":"<pre><code>DASVisualizer(\n    output_path: Union[str, Path],\n    sampling_frequency: float,\n    config: Optional[VisualizationConfig] = None,\n)\n</code></pre> <p>DAS \u6570\u636e\u53ef\u89c6\u5316\u5668 (DAS Data Visualizer)</p> <p>\u521d\u59cb\u5316 DAS \u6570\u636e\u53ef\u89c6\u5316\u5668</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>output_path</code> <code>Union[str, Path]</code> <p>\u56fe\u50cf\u8f93\u51fa\u76ee\u5f55</p> \u5fc5\u9700 <code>sampling_frequency</code> <code>float</code> <p>\u91c7\u6837\u9891\u7387 (Hz)</p> \u5fc5\u9700 <code>config</code> <code>Optional[VisualizationConfig]</code> <p>\u53ef\u89c6\u5316\u914d\u7f6e\uff0c\u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def __init__(\n    self,\n    output_path: Union[str, Path],\n    sampling_frequency: float,\n    config: Optional[VisualizationConfig] = None,\n):\n    \"\"\"\u521d\u59cb\u5316 DAS \u6570\u636e\u53ef\u89c6\u5316\u5668\n\n    Args:\n        output_path: \u56fe\u50cf\u8f93\u51fa\u76ee\u5f55\n        sampling_frequency: \u91c7\u6837\u9891\u7387 (Hz)\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\uff0c\u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\n    \"\"\"\n    self.output_path = (\n        Path(output_path) if isinstance(output_path, str) else output_path\n    )\n    self.output_path.mkdir(parents=True, exist_ok=True)\n    self.fs = sampling_frequency\n    self.config = config or VisualizationConfig()\n    self.logger = logging.getLogger(__name__)\n\n    # \u521d\u59cb\u5316\u7ed8\u56fe\u5668\u5b9e\u4f8b\n    self.waveform_plotter = WaveformPlot(self.config)\n    self.spectrum_plotter = SpectrumPlot(self.config)\n    self.spectrogram_plotter = SpectrogramPlot(self.config)\n    self.waterfall_plotter = WaterfallPlot(self.config)\n\n    # \u68c0\u6d4b\u662f\u5426\u5728 Jupyter \u73af\u5883\u4e2d\n    self._in_jupyter = self._check_jupyter()\n\n    # \u6027\u80fd\u4f18\u5316\uff1a\u9884\u5148\u5bfc\u5165\u5e38\u7528\u5e93\uff0c\u907f\u514d\u6bcf\u6b21\u7ed8\u56fe\u90fd\u91cd\u65b0\u5bfc\u5165\n    try:\n        import matplotlib.pyplot as plt\n\n        self._plt = plt\n        from scipy import signal\n\n        self._signal = signal\n    except ImportError:\n        self.logger.warning(\"Could not preload matplotlib or scipy.signal\")\n</code></pre>"},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization.DASVisualizer.WaveformPlot","title":"WaveformPlot","text":"<pre><code>WaveformPlot(\n    amplitude_data: ndarray,\n    time_range: Optional[Tuple[float, float]] = None,\n    amplitude_range: Optional[Tuple[float, float]] = None,\n    file_name: Optional[str] = None,\n    title: Optional[str] = None,\n    highlight_regions: Optional[\n        List[Tuple[float, float]]\n    ] = None,\n    ax: Optional[Axes] = None,\n) -&gt; Any\n</code></pre> <p>\u7ed8\u5236\u65f6\u57df\u6ce2\u5f62\u56fe</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>amplitude_data</code> <code>ndarray</code> <p>\u4e00\u7ef4\u6570\u7ec4\uff0c\u5305\u542b\u5355\u4e2a\u901a\u9053\u7684\u65f6\u57df\u6570\u636e</p> \u5fc5\u9700 <code>time_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0c\u65f6\u95f4\u663e\u793a\u8303\u56f4 (start_time, end_time)</p> <code>None</code> <code>amplitude_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0c\u5e45\u503c\u663e\u793a\u8303\u56f4 (min_amplitude, max_amplitude)</p> <code>None</code> <code>file_name</code> <code>Optional[str]</code> <p>\u4fdd\u5b58\u7684\u6587\u4ef6\u540d (\u4e0d\u542b\u6269\u5c55\u540d)\uff0c\u82e5\u63d0\u4f9b\u5219\u4fdd\u5b58\u56fe\u7247</p> <code>None</code> <code>title</code> <code>Optional[str]</code> <p>\u56fe\u8868\u6807\u9898 (\u82f1\u6587)</p> <code>None</code> <code>highlight_regions</code> <code>Optional[List[Tuple[float, float]]]</code> <p>\u53ef\u9009\u7684\u9ad8\u4eae\u533a\u57df\u5217\u8868\uff0c\u6bcf\u4e2a\u5143\u7d20\u4e3a(\u5f00\u59cb\u65f6\u95f4, \u7ed3\u675f\u65f6\u95f4)\u5143\u7ec4</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Figure</code> <code>Any</code> <p>matplotlib \u56fe\u5f62\u5bf9\u8c61\uff0c\u53ef\u5728 Jupyter notebook \u4e2d\u663e\u793a</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def WaveformPlot(\n    self,\n    amplitude_data: np.ndarray,\n    time_range: Optional[Tuple[float, float]] = None,\n    amplitude_range: Optional[Tuple[float, float]] = None,\n    file_name: Optional[str] = None,\n    title: Optional[str] = None,\n    highlight_regions: Optional[List[Tuple[float, float]]] = None,\n    ax: Optional[plt.Axes] = None,\n) -&gt; Any:\n    \"\"\"\u7ed8\u5236\u65f6\u57df\u6ce2\u5f62\u56fe\n\n    Args:\n        amplitude_data: \u4e00\u7ef4\u6570\u7ec4\uff0c\u5305\u542b\u5355\u4e2a\u901a\u9053\u7684\u65f6\u57df\u6570\u636e\n        time_range: \u53ef\u9009\uff0c\u65f6\u95f4\u663e\u793a\u8303\u56f4 (start_time, end_time)\n        amplitude_range: \u53ef\u9009\uff0c\u5e45\u503c\u663e\u793a\u8303\u56f4 (min_amplitude, max_amplitude)\n        file_name: \u4fdd\u5b58\u7684\u6587\u4ef6\u540d (\u4e0d\u542b\u6269\u5c55\u540d)\uff0c\u82e5\u63d0\u4f9b\u5219\u4fdd\u5b58\u56fe\u7247\n        title: \u56fe\u8868\u6807\u9898 (\u82f1\u6587)\n        highlight_regions: \u53ef\u9009\u7684\u9ad8\u4eae\u533a\u57df\u5217\u8868\uff0c\u6bcf\u4e2a\u5143\u7d20\u4e3a(\u5f00\u59cb\u65f6\u95f4, \u7ed3\u675f\u65f6\u95f4)\u5143\u7ec4\n\n    Returns:\n        Figure: matplotlib \u56fe\u5f62\u5bf9\u8c61\uff0c\u53ef\u5728 Jupyter notebook \u4e2d\u663e\u793a\n    \"\"\"\n    # \u6027\u80fd\u4f18\u5316\uff1a\u52a0\u5165\u6570\u636e\u9a8c\u8bc1\u524d\u7684\u5feb\u901f\u8def\u5f84\u68c0\u67e5\n    if amplitude_data is None or len(amplitude_data) == 0:\n        self.logger.error(\"\u8f93\u5165\u6570\u636e\u4e3a\u7a7a\")\n        return None\n\n    if not isinstance(amplitude_data, np.ndarray) or amplitude_data.ndim != 1:\n        self.logger.error(\n            f\"\u6570\u636e\u5fc5\u987b\u662f\u4e00\u7ef4numpy\u6570\u7ec4\uff0c\u5f53\u524d\u7ef4\u5ea6: {amplitude_data.ndim}\"\n        )\n        return None\n\n    # \u7ed8\u56fe\u524d\u542f\u7528agg\u540e\u7aef\u53ef\u4ee5\u63d0\u9ad8\u975e\u4ea4\u4e92\u5f0f\u7ed8\u56fe\u6027\u80fd\n    import matplotlib\n\n    prev_backend = matplotlib.get_backend()\n    if not self._in_jupyter:\n        matplotlib.use(\"agg\")  # \u975e\u4ea4\u4e92\u5f0f\u540e\u7aef\uff0c\u66f4\u5feb\n\n    # \u7ed8\u5236\u6ce2\u5f62\u56fe\n    fig = self.waveform_plotter.plot(\n        amplitude_data=amplitude_data,\n        fs=self.fs,  # \u4f20\u9012\u91c7\u6837\u9891\u7387\n        time_range=time_range,\n        amplitude_range=amplitude_range,\n        title=title,\n        highlight_regions=highlight_regions,\n        ax=ax,\n    )\n\n    # \u5982\u679c\u63d0\u4f9b\u4e86\u6587\u4ef6\u540d\uff0c\u5219\u4fdd\u5b58\u56fe\u7247\n    if file_name is not None:\n        save_path = self.output_path / f\"{file_name}.png\"\n        self.waveform_plotter.save_figure(save_path, close_after_save=False)\n\n    # \u8fd8\u539f\u540e\u7aef\n    if not self._in_jupyter:\n        matplotlib.use(prev_backend)\n\n    # \u5904\u7406\u56fe\u5f62\u663e\u793a\uff0c\u907f\u514d\u53cc\u91cd\u663e\u793a\n    return self._handle_figure_display(fig)\n</code></pre>"},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization.DASVisualizer.SpectrumPlot","title":"SpectrumPlot","text":"<pre><code>SpectrumPlot(\n    data: ndarray,\n    excitation_freq: Optional[float] = None,\n    file_name: Optional[str] = None,\n    title: Optional[str] = None,\n    peaks: Optional[List[Dict[str, float]]] = None,\n    freq_range: Optional[Tuple[float, float]] = None,\n    db_range: Optional[Tuple[float, float]] = None,\n    ax: Optional[Axes] = None,\n) -&gt; Any\n</code></pre> <p>\u7ed8\u5236\u5e76\u4fdd\u5b58\u9891\u8c31\u56fe</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u4e00\u7ef4\u6570\u7ec4\uff0c\u5305\u542b\u5355\u4e2a\u901a\u9053\u7684\u65f6\u57df\u4fe1\u53f7\u6570\u636e</p> \u5fc5\u9700 <code>excitation_freq</code> <code>Optional[float]</code> <p>(\u53ef\u9009) \u6fc0\u52b1\u9891\u7387 (Hz)</p> <code>None</code> <code>file_name</code> <code>Optional[str]</code> <p>\u4fdd\u5b58\u7684\u6587\u4ef6\u540d (\u4e0d\u542b\u6269\u5c55\u540d)\uff0c\u82e5\u63d0\u4f9b\u5219\u4fdd\u5b58\u56fe\u7247</p> <code>None</code> <code>title</code> <code>Optional[str]</code> <p>\u56fe\u8868\u6807\u9898 (\u82f1\u6587)</p> <code>None</code> <code>peaks</code> <code>Optional[List[Dict[str, float]]]</code> <p>(\u53ef\u9009) \u5cf0\u503c\u5217\u8868\uff0c\u6bcf\u4e2a\u5cf0\u503c\u5305\u542b 'frequency' \u548c 'magnitude'</p> <code>None</code> <code>freq_range</code> <code>Optional[Tuple[float, float]]</code> <p>(\u53ef\u9009) \u9891\u7387\u8303\u56f4 (min_freq, max_freq)\uff0c\u7528\u4e8e\u9650\u5236\u663e\u793a\u7684\u9891\u7387\u8303\u56f4</p> <code>None</code> <code>db_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0cdB\u503c\u663e\u793a\u8303\u56f4 (min_db, max_db)</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Figure</code> <code>Any</code> <p>matplotlib \u56fe\u5f62\u5bf9\u8c61\uff0c\u53ef\u5728 Jupyter notebook \u4e2d\u663e\u793a</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def SpectrumPlot(\n    self,\n    data: np.ndarray,\n    excitation_freq: Optional[float] = None,\n    file_name: Optional[str] = None,\n    title: Optional[str] = None,\n    peaks: Optional[List[Dict[str, float]]] = None,\n    freq_range: Optional[Tuple[float, float]] = None,\n    db_range: Optional[Tuple[float, float]] = None,\n    ax: Optional[plt.Axes] = None,\n) -&gt; Any:\n    \"\"\"\u7ed8\u5236\u5e76\u4fdd\u5b58\u9891\u8c31\u56fe\n\n    Args:\n        data: \u4e00\u7ef4\u6570\u7ec4\uff0c\u5305\u542b\u5355\u4e2a\u901a\u9053\u7684\u65f6\u57df\u4fe1\u53f7\u6570\u636e\n        excitation_freq: (\u53ef\u9009) \u6fc0\u52b1\u9891\u7387 (Hz)\n        file_name: \u4fdd\u5b58\u7684\u6587\u4ef6\u540d (\u4e0d\u542b\u6269\u5c55\u540d)\uff0c\u82e5\u63d0\u4f9b\u5219\u4fdd\u5b58\u56fe\u7247\n        title: \u56fe\u8868\u6807\u9898 (\u82f1\u6587)\n        peaks: (\u53ef\u9009) \u5cf0\u503c\u5217\u8868\uff0c\u6bcf\u4e2a\u5cf0\u503c\u5305\u542b 'frequency' \u548c 'magnitude'\n        freq_range: (\u53ef\u9009) \u9891\u7387\u8303\u56f4 (min_freq, max_freq)\uff0c\u7528\u4e8e\u9650\u5236\u663e\u793a\u7684\u9891\u7387\u8303\u56f4\n        db_range: \u53ef\u9009\uff0cdB\u503c\u663e\u793a\u8303\u56f4 (min_db, max_db)\n\n    Returns:\n        Figure: matplotlib \u56fe\u5f62\u5bf9\u8c61\uff0c\u53ef\u5728 Jupyter notebook \u4e2d\u663e\u793a\n    \"\"\"\n    # \u6027\u80fd\u4f18\u5316\uff1a\u52a0\u5165\u6570\u636e\u9a8c\u8bc1\u524d\u7684\u5feb\u901f\u8def\u5f84\u68c0\u67e5\n    if data is None or len(data) == 0:\n        self.logger.error(\"\u8f93\u5165\u6570\u636e\u4e3a\u7a7a\")\n        return None\n\n    if not isinstance(data, np.ndarray) or data.ndim != 1:\n        self.logger.error(f\"\u6570\u636e\u5fc5\u987b\u662f\u4e00\u7ef4numpy\u6570\u7ec4\uff0c\u5f53\u524d\u7ef4\u5ea6: {data.ndim}\")\n        return None\n\n    # \u6027\u80fd\u4f18\u5316\uff1a\u4f7f\u7528 Welch \u65b9\u6cd5\u8ba1\u7b97\u9891\u8c31\uff0c\u6bd4\u76f4\u63a5 FFT \u66f4\u7a33\u5b9a\u4e14\u53ef\u80fd\u66f4\u5feb\n    from scipy import signal\n\n    # \u6839\u636e\u6570\u636e\u957f\u5ea6\u81ea\u52a8\u786e\u5b9a\u5408\u9002\u7684\u7a97\u53e3\u5927\u5c0f\u548c\u91cd\u53e0\u53c2\u6570\n    n = len(data)\n    if n &gt; 500000:  # \u5927\u4e8e50\u4e07\u70b9\u7684\u6570\u636e\n        nperseg = 8192  # \u4f7f\u7528\u8f83\u5927\u7684\u7a97\u53e3\u589e\u52a0\u9891\u7387\u5206\u8fa8\u7387\n        noverlap = nperseg // 2  # 50% \u91cd\u53e0\n    elif n &gt; 100000:  # 10\u4e07-50\u4e07\u70b9\u7684\u6570\u636e\n        nperseg = 4096\n        noverlap = nperseg // 2\n    else:  # \u8f83\u5c0f\u89c4\u6a21\u7684\u6570\u636e\n        nperseg = min(2048, n // 4)  # \u786e\u4fdd\u7a97\u53e3\u4e0d\u8d85\u8fc7\u6570\u636e\u957f\u5ea6\u76841/4\n        noverlap = nperseg // 2\n\n    # \u4f7f\u7528 Welch \u65b9\u6cd5\u8ba1\u7b97\u529f\u7387\u8c31\u5bc6\u5ea6 (PSD)\n    frequencies, psd = signal.welch(\n        data,\n        fs=self.fs,\n        window=\"hann\",\n        nperseg=nperseg,\n        noverlap=noverlap,\n        detrend=\"constant\",\n        scaling=\"spectrum\",  # \u4f7f\u7528 'spectrum' \u800c\u4e0d\u662f 'density' \u4ee5\u83b7\u5f97\u5e45\u5ea6\u8c31\n        average=\"mean\",  # \u5e73\u5747\u591a\u4e2a\u5206\u6bb5\u7684\u7ed3\u679c\n    )\n\n    # Welch \u8fd4\u56de\u529f\u7387\u8c31\u5bc6\u5ea6\uff0c\u6211\u4eec\u8ba1\u7b97\u5e45\u5ea6\u8c31\n    magnitudes = np.sqrt(psd)\n\n    # \u5982\u679c\u6307\u5b9a\u4e86\u9891\u7387\u8303\u56f4\uff0c\u5219\u8fc7\u6ee4\u6570\u636e\n    if freq_range is not None:\n        min_freq, max_freq = freq_range\n        mask = (frequencies &gt;= min_freq) &amp; (frequencies &lt;= max_freq)\n        frequencies = frequencies[mask]\n        magnitudes = magnitudes[mask]\n\n    # \u7ed8\u56fe\u524d\u542f\u7528agg\u540e\u7aef\u53ef\u4ee5\u63d0\u9ad8\u975e\u4ea4\u4e92\u5f0f\u7ed8\u56fe\u6027\u80fd\n    import matplotlib\n\n    prev_backend = matplotlib.get_backend()\n    if not self._in_jupyter:\n        matplotlib.use(\"agg\")  # \u975e\u4ea4\u4e92\u5f0f\u540e\u7aef\uff0c\u66f4\u5feb\n\n    # \u7ed8\u5236\u9891\u8c31\u56fe\n    fig = self.spectrum_plotter.plot(\n        frequencies,\n        magnitudes,\n        excitation_freq=excitation_freq,\n        title=title,\n        peaks=peaks,\n        db_range=db_range,\n        ax=ax,\n    )\n\n    # \u5982\u679c\u63d0\u4f9b\u4e86\u6587\u4ef6\u540d\uff0c\u5219\u4fdd\u5b58\u56fe\u7247\n    if file_name is not None:\n        freq_suffix = f\"_{excitation_freq:.0f}Hz\" if excitation_freq else \"\"\n        save_path = self.output_path / f\"{file_name}{freq_suffix}.png\"\n        self.spectrum_plotter.save_figure(save_path, close_after_save=False)\n\n    # \u8fd8\u539f\u540e\u7aef\n    if not self._in_jupyter:\n        matplotlib.use(prev_backend)\n\n    # \u5904\u7406\u56fe\u5f62\u663e\u793a\uff0c\u907f\u514d\u53cc\u91cd\u663e\u793a\n    return self._handle_figure_display(fig)\n</code></pre>"},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization.DASVisualizer.SpectrogramPlot","title":"SpectrogramPlot","text":"<pre><code>SpectrogramPlot(\n    data: ndarray,\n    window_size: int = 1024,\n    overlap: float = 0.75,\n    file_name: Optional[str] = None,\n    title: Optional[str] = None,\n    freq_range: Optional[Tuple[float, float]] = None,\n    time_range: Optional[Tuple[float, float]] = None,\n    cmap: str = \"viridis\",\n    ax: Optional[Axes] = None,\n) -&gt; Any\n</code></pre> <p>\u7ed8\u5236\u65f6\u9891\u56fe\uff08\u77ed\u65f6\u5085\u91cc\u53f6\u53d8\u6362\uff09</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u4e00\u7ef4\u6570\u7ec4\uff0c\u5305\u542b\u5355\u4e2a\u901a\u9053\u7684\u65f6\u57df\u6570\u636e</p> \u5fc5\u9700 <code>window_size</code> <code>int</code> <p>STFT\u7a97\u53e3\u5927\u5c0f</p> <code>1024</code> <code>overlap</code> <code>float</code> <p>\u7a97\u53e3\u91cd\u53e0\u6bd4\u4f8b</p> <code>0.75</code> <code>file_name</code> <code>Optional[str]</code> <p>\u4fdd\u5b58\u7684\u6587\u4ef6\u540d (\u4e0d\u542b\u6269\u5c55\u540d)\uff0c\u82e5\u63d0\u4f9b\u5219\u4fdd\u5b58\u56fe\u7247</p> <code>None</code> <code>title</code> <code>Optional[str]</code> <p>\u56fe\u8868\u6807\u9898 (\u82f1\u6587)</p> <code>None</code> <code>freq_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0c\u9891\u7387\u8303\u56f4 (min_freq, max_freq)</p> <code>None</code> <code>time_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0c\u65f6\u95f4\u8303\u56f4 (start_time, end_time)</p> <code>None</code> <code>cmap</code> <code>str</code> <p>\u8272\u5f69\u6620\u5c04\u540d\u79f0</p> <code>'viridis'</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Figure</code> <code>Any</code> <p>matplotlib \u56fe\u5f62\u5bf9\u8c61\uff0c\u53ef\u5728 Jupyter notebook \u4e2d\u663e\u793a</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def SpectrogramPlot(\n    self,\n    data: np.ndarray,\n    window_size: int = 1024,\n    overlap: float = 0.75,\n    file_name: Optional[str] = None,\n    title: Optional[str] = None,\n    freq_range: Optional[Tuple[float, float]] = None,\n    time_range: Optional[Tuple[float, float]] = None,\n    cmap: str = \"viridis\",\n    ax: Optional[plt.Axes] = None,\n) -&gt; Any:\n    \"\"\"\u7ed8\u5236\u65f6\u9891\u56fe\uff08\u77ed\u65f6\u5085\u91cc\u53f6\u53d8\u6362\uff09\n\n    Args:\n        data: \u4e00\u7ef4\u6570\u7ec4\uff0c\u5305\u542b\u5355\u4e2a\u901a\u9053\u7684\u65f6\u57df\u6570\u636e\n        window_size: STFT\u7a97\u53e3\u5927\u5c0f\n        overlap: \u7a97\u53e3\u91cd\u53e0\u6bd4\u4f8b\n        file_name: \u4fdd\u5b58\u7684\u6587\u4ef6\u540d (\u4e0d\u542b\u6269\u5c55\u540d)\uff0c\u82e5\u63d0\u4f9b\u5219\u4fdd\u5b58\u56fe\u7247\n        title: \u56fe\u8868\u6807\u9898 (\u82f1\u6587)\n        freq_range: \u53ef\u9009\uff0c\u9891\u7387\u8303\u56f4 (min_freq, max_freq)\n        time_range: \u53ef\u9009\uff0c\u65f6\u95f4\u8303\u56f4 (start_time, end_time)\n        cmap: \u8272\u5f69\u6620\u5c04\u540d\u79f0\n\n    Returns:\n        Figure: matplotlib \u56fe\u5f62\u5bf9\u8c61\uff0c\u53ef\u5728 Jupyter notebook \u4e2d\u663e\u793a\n    \"\"\"\n    # \u6027\u80fd\u4f18\u5316\uff1a\u52a0\u5165\u6570\u636e\u9a8c\u8bc1\u524d\u7684\u5feb\u901f\u8def\u5f84\u68c0\u67e5\n    if data is None or len(data) == 0:\n        self.logger.error(\"\u8f93\u5165\u6570\u636e\u4e3a\u7a7a\")\n        return None\n\n    if not isinstance(data, np.ndarray) or data.ndim != 1:\n        self.logger.error(f\"\u6570\u636e\u5fc5\u987b\u662f\u4e00\u7ef4numpy\u6570\u7ec4\uff0c\u5f53\u524d\u7ef4\u5ea6: {data.ndim}\")\n        return None\n\n    # \u6027\u80fd\u4f18\u5316\uff1a\u81ea\u52a8\u8c03\u6574\u5927\u6570\u636e\u7684\u7a97\u53e3\u5927\u5c0f\u548c\u91cd\u53e0\u6bd4\u4f8b\n    data_length = len(data)\n    # \u5bf9\u4e8e\u8d85\u957f\u6570\u636e\uff0c\u81ea\u52a8\u8c03\u6574\u4e3a\u66f4\u5408\u7406\u7684\u53c2\u6570\n    if data_length &gt; 500000:  # 50\u4e07\u4ee5\u4e0a\u6570\u636e\u70b9\n        if window_size &lt; 2048:\n            window_size = 2048  # \u589e\u52a0\u7a97\u53e3\u5927\u5c0f\n        if overlap &gt; 0.5:\n            overlap = 0.5  # \u51cf\u5c11\u91cd\u53e0\n\n    # \u7ed8\u56fe\u524d\u542f\u7528agg\u540e\u7aef\u53ef\u4ee5\u63d0\u9ad8\u975e\u4ea4\u4e92\u5f0f\u7ed8\u56fe\u6027\u80fd\n    import matplotlib\n\n    prev_backend = matplotlib.get_backend()\n    if not self._in_jupyter:\n        matplotlib.use(\"agg\")  # \u975e\u4ea4\u4e92\u5f0f\u540e\u7aef\uff0c\u66f4\u5feb\n\n    # \u7ed8\u5236\u65f6\u9891\u56fe\n    fig = self.spectrogram_plotter.plot(\n        data,\n        self.fs,\n        window_size=window_size,\n        overlap=overlap,\n        title=title,\n        freq_range=freq_range,\n        time_range=time_range,\n        cmap=cmap,\n        ax=ax,\n    )\n\n    # \u5982\u679c\u63d0\u4f9b\u4e86\u6587\u4ef6\u540d\uff0c\u5219\u4fdd\u5b58\u56fe\u7247\n    if file_name is not None:\n        save_path = self.output_path / f\"{file_name}.png\"\n        self.spectrogram_plotter.save_figure(save_path, close_after_save=False)\n\n    # \u8fd8\u539f\u540e\u7aef\n    if not self._in_jupyter:\n        matplotlib.use(prev_backend)\n\n    # \u5904\u7406\u56fe\u5f62\u663e\u793a\uff0c\u907f\u514d\u53cc\u91cd\u663e\u793a\n    return self._handle_figure_display(fig)\n</code></pre>"},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization.DASVisualizer.WaterfallPlot","title":"WaterfallPlot","text":"<pre><code>WaterfallPlot(\n    data: ndarray,\n    x_label: str = \"Channels\",\n    y_label: str = \"Time (s)\",\n    file_name: Optional[str] = None,\n    title: Optional[str] = None,\n    cmap: str = \"viridis\",\n    colorbar_label: str = \"Amplitude\",\n    aspect: str = \"auto\",\n    origin: str = \"upper\",\n    x_ticks: Optional[ndarray] = None,\n    y_ticks: Optional[ndarray] = None,\n    value_range: Optional[Tuple[float, float]] = None,\n    ax: Optional[Axes] = None,\n) -&gt; Any\n</code></pre> <p>\u7ed8\u5236\u7011\u5e03\u56fe\uff08\u4e8c\u7ef4\u6570\u636e\u53ef\u89c6\u5316\uff09</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u4e8c\u7ef4\u6570\u7ec4\uff0c\u5f62\u72b6\u4e3a (time_samples, channels) \u6216 (channels, time_samples)</p> \u5fc5\u9700 <code>x_label</code> <code>str</code> <p>X\u8f74\u6807\u7b7e</p> <code>'Channels'</code> <code>y_label</code> <code>str</code> <p>Y\u8f74\u6807\u7b7e</p> <code>'Time (s)'</code> <code>file_name</code> <code>Optional[str]</code> <p>\u4fdd\u5b58\u7684\u6587\u4ef6\u540d (\u4e0d\u542b\u6269\u5c55\u540d)\uff0c\u82e5\u63d0\u4f9b\u5219\u4fdd\u5b58\u56fe\u7247</p> <code>None</code> <code>title</code> <code>Optional[str]</code> <p>\u81ea\u5b9a\u4e49\u6807\u9898 (\u82f1\u6587)</p> <code>None</code> <code>cmap</code> <code>str</code> <p>\u8272\u5f69\u6620\u5c04\u540d\u79f0</p> <code>'viridis'</code> <code>colorbar_label</code> <code>str</code> <p>\u989c\u8272\u6761\u6807\u7b7e</p> <code>'Amplitude'</code> <code>aspect</code> <code>str</code> <p>\u56fe\u50cf\u7eb5\u6a2a\u6bd4\uff0c'auto' \u6216 'equal'</p> <code>'auto'</code> <code>origin</code> <code>str</code> <p>\u6570\u636e\u539f\u70b9\u4f4d\u7f6e\uff0c'upper' \u6216 'lower'</p> <code>'upper'</code> <code>x_ticks</code> <code>Optional[ndarray]</code> <p>\u53ef\u9009\uff0cX\u8f74\u523b\u5ea6\u503c</p> <code>None</code> <code>y_ticks</code> <code>Optional[ndarray]</code> <p>\u53ef\u9009\uff0cY\u8f74\u523b\u5ea6\u503c</p> <code>None</code> <code>value_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0c\u6570\u636e\u503c\u663e\u793a\u8303\u56f4 (min_value, max_value)</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Figure</code> <code>Any</code> <p>matplotlib \u56fe\u5f62\u5bf9\u8c61\uff0c\u53ef\u5728 Jupyter notebook \u4e2d\u663e\u793a</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def WaterfallPlot(\n    self,\n    data: np.ndarray,\n    x_label: str = \"Channels\",\n    y_label: str = \"Time (s)\",\n    file_name: Optional[str] = None,\n    title: Optional[str] = None,\n    cmap: str = \"viridis\",\n    colorbar_label: str = \"Amplitude\",\n    aspect: str = \"auto\",\n    origin: str = \"upper\",\n    x_ticks: Optional[np.ndarray] = None,\n    y_ticks: Optional[np.ndarray] = None,\n    value_range: Optional[Tuple[float, float]] = None,\n    ax: Optional[plt.Axes] = None,\n) -&gt; Any:\n    \"\"\"\u7ed8\u5236\u7011\u5e03\u56fe\uff08\u4e8c\u7ef4\u6570\u636e\u53ef\u89c6\u5316\uff09\n\n    Args:\n        data: \u4e8c\u7ef4\u6570\u7ec4\uff0c\u5f62\u72b6\u4e3a (time_samples, channels) \u6216 (channels, time_samples)\n        x_label: X\u8f74\u6807\u7b7e\n        y_label: Y\u8f74\u6807\u7b7e\n        file_name: \u4fdd\u5b58\u7684\u6587\u4ef6\u540d (\u4e0d\u542b\u6269\u5c55\u540d)\uff0c\u82e5\u63d0\u4f9b\u5219\u4fdd\u5b58\u56fe\u7247\n        title: \u81ea\u5b9a\u4e49\u6807\u9898 (\u82f1\u6587)\n        cmap: \u8272\u5f69\u6620\u5c04\u540d\u79f0\n        colorbar_label: \u989c\u8272\u6761\u6807\u7b7e\n        aspect: \u56fe\u50cf\u7eb5\u6a2a\u6bd4\uff0c'auto' \u6216 'equal'\n        origin: \u6570\u636e\u539f\u70b9\u4f4d\u7f6e\uff0c'upper' \u6216 'lower'\n        x_ticks: \u53ef\u9009\uff0cX\u8f74\u523b\u5ea6\u503c\n        y_ticks: \u53ef\u9009\uff0cY\u8f74\u523b\u5ea6\u503c\n        value_range: \u53ef\u9009\uff0c\u6570\u636e\u503c\u663e\u793a\u8303\u56f4 (min_value, max_value)\n\n    Returns:\n        Figure: matplotlib \u56fe\u5f62\u5bf9\u8c61\uff0c\u53ef\u5728 Jupyter notebook \u4e2d\u663e\u793a\n    \"\"\"\n    # \u6570\u636e\u9a8c\u8bc1\n    if data is None or data.size == 0:\n        self.logger.error(\"\u8f93\u5165\u6570\u636e\u4e3a\u7a7a\")\n        return None\n\n    if not isinstance(data, np.ndarray) or data.ndim != 2:\n        self.logger.error(f\"\u6570\u636e\u5fc5\u987b\u662f\u4e8c\u7ef4numpy\u6570\u7ec4\uff0c\u5f53\u524d\u7ef4\u5ea6: {data.ndim}\")\n        return None\n\n    # \u7ed8\u56fe\u524d\u542f\u7528agg\u540e\u7aef\u53ef\u4ee5\u63d0\u9ad8\u975e\u4ea4\u4e92\u5f0f\u7ed8\u56fe\u6027\u80fd\n    import matplotlib\n\n    prev_backend = matplotlib.get_backend()\n    if not self._in_jupyter:\n        matplotlib.use(\"agg\")  # \u975e\u4ea4\u4e92\u5f0f\u540e\u7aef\uff0c\u66f4\u5feb\n\n    # \u7ed8\u5236\u7011\u5e03\u56fe\n    fig = self.waterfall_plotter.plot(\n        data=data,\n        fs=self.fs,\n        x_label=x_label,\n        y_label=y_label,\n        title=title,\n        cmap=cmap,\n        colorbar_label=colorbar_label,\n        aspect=aspect,\n        origin=origin,\n        x_ticks=x_ticks,\n        y_ticks=y_ticks,\n        value_range=value_range,\n        ax=ax,\n    )\n\n    # \u5982\u679c\u63d0\u4f9b\u4e86\u6587\u4ef6\u540d\uff0c\u5219\u4fdd\u5b58\u56fe\u7247\n    if file_name is not None:\n        save_path = self.output_path / f\"{file_name}.png\"\n        self.waterfall_plotter.save_figure(save_path, close_after_save=False)\n\n    # \u8fd8\u539f\u540e\u7aef\n    if not self._in_jupyter:\n        matplotlib.use(prev_backend)\n\n    # \u5904\u7406\u56fe\u5f62\u663e\u793a\uff0c\u907f\u514d\u53cc\u91cd\u663e\u793a\n    return self._handle_figure_display(fig)\n</code></pre>"},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization.PlotBase","title":"PlotBase","text":"<pre><code>PlotBase(config: Optional[VisualizationConfig] = None)\n</code></pre> <p>               Bases: <code>ABC</code></p> <p>\u7ed8\u56fe\u57fa\u7c7b</p> <p>\u521d\u59cb\u5316\u7ed8\u56fe\u57fa\u7c7b</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>config</code> <code>Optional[VisualizationConfig]</code> <p>\u53ef\u89c6\u5316\u914d\u7f6e\uff0c\u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def __init__(self, config: Optional[VisualizationConfig] = None):\n    \"\"\"\u521d\u59cb\u5316\u7ed8\u56fe\u57fa\u7c7b\n\n    Args:\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\uff0c\u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\n    \"\"\"\n    self.config = config or VisualizationConfig()\n    self.logger = logging.getLogger(__name__)\n    self._setup_style()\n</code></pre>"},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization.PlotBase.save_figure","title":"save_figure","text":"<pre><code>save_figure(\n    file_path: Union[str, Path],\n    close_after_save: bool = True,\n) -&gt; None\n</code></pre> <p>\u4fdd\u5b58\u56fe\u5f62\u5230\u6307\u5b9a\u8def\u5f84</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>file_path</code> <code>Union[str, Path]</code> <p>\u56fe\u5f62\u4fdd\u5b58\u8def\u5f84</p> \u5fc5\u9700 <code>close_after_save</code> <code>bool</code> <p>\u4fdd\u5b58\u540e\u662f\u5426\u5173\u95ed\u56fe\u5f62</p> <code>True</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def save_figure(\n    self, file_path: Union[str, Path], close_after_save: bool = True\n) -&gt; None:\n    \"\"\"\u4fdd\u5b58\u56fe\u5f62\u5230\u6307\u5b9a\u8def\u5f84\n\n    Args:\n        file_path: \u56fe\u5f62\u4fdd\u5b58\u8def\u5f84\n        close_after_save: \u4fdd\u5b58\u540e\u662f\u5426\u5173\u95ed\u56fe\u5f62\n    \"\"\"\n    # \u5ef6\u8fdf\u5bfc\u5165 matplotlib\n    import matplotlib.pyplot as plt\n\n    try:\n        # \u786e\u4fdd\u76ee\u5f55\u5b58\u5728\n        if isinstance(file_path, str):\n            file_path = Path(file_path)\n\n        file_path.parent.mkdir(parents=True, exist_ok=True)\n\n        plt.savefig(\n            file_path,\n            bbox_inches=\"tight\",\n            dpi=self.config.dpi,\n        )\n        self.logger.debug(f\"Figure saved to {file_path}\")\n\n        if close_after_save:\n            plt.close()\n    except Exception as e:\n        self.logger.error(f\"Error saving figure: {e}\")\n        if close_after_save:\n            plt.close()\n</code></pre>"},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization.SpectrogramPlot","title":"SpectrogramPlot","text":"<pre><code>SpectrogramPlot(\n    config: Optional[VisualizationConfig] = None,\n)\n</code></pre> <p>               Bases: <code>PlotBase</code></p> <p>\u65f6\u9891\u56fe/\u9891\u8c31\u56fe (STFT) \u7ed8\u56fe\u7c7b</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def __init__(self, config: Optional[VisualizationConfig] = None):\n    \"\"\"\u521d\u59cb\u5316\u7ed8\u56fe\u57fa\u7c7b\n\n    Args:\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\uff0c\u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\n    \"\"\"\n    self.config = config or VisualizationConfig()\n    self.logger = logging.getLogger(__name__)\n    self._setup_style()\n</code></pre>"},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization.SpectrogramPlot.plot","title":"plot","text":"<pre><code>plot(\n    data: ndarray,\n    fs: float,\n    window_size: int = 1024,\n    overlap: float = 0.75,\n    title: Optional[str] = None,\n    freq_range: Optional[Tuple[float, float]] = None,\n    time_range: Optional[Tuple[float, float]] = None,\n    cmap: str = \"inferno\",\n    ax: Optional[Axes] = None,\n) -&gt; Any\n</code></pre> <p>\u7ed8\u5236\u65f6\u9891\u8c31\u56fe\uff08\u77ed\u65f6\u5085\u91cc\u53f6\u53d8\u6362\uff09</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u65f6\u57df\u4fe1\u53f7\u6570\u636e</p> \u5fc5\u9700 <code>fs</code> <code>float</code> <p>\u91c7\u6837\u9891\u7387 (Hz)</p> \u5fc5\u9700 <code>window_size</code> <code>int</code> <p>STFT\u7a97\u53e3\u5927\u5c0f</p> <code>1024</code> <code>overlap</code> <code>float</code> <p>\u7a97\u53e3\u91cd\u53e0\u6bd4\u4f8b</p> <code>0.75</code> <code>title</code> <code>Optional[str]</code> <p>\u81ea\u5b9a\u4e49\u6807\u9898</p> <code>None</code> <code>freq_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0c\u9891\u7387\u8303\u56f4 (min_freq, max_freq)</p> <code>None</code> <code>time_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0c\u65f6\u95f4\u8303\u56f4 (start_time, end_time)</p> <code>None</code> <code>cmap</code> <code>str</code> <p>\u8272\u5f69\u6620\u5c04\u540d\u79f0</p> <code>'inferno'</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Figure</code> <code>Any</code> <p>matplotlib \u56fe\u5f62\u5bf9\u8c61</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def plot(\n    self,\n    data: np.ndarray,\n    fs: float,\n    window_size: int = 1024,\n    overlap: float = 0.75,\n    title: Optional[str] = None,\n    freq_range: Optional[Tuple[float, float]] = None,\n    time_range: Optional[Tuple[float, float]] = None,\n    cmap: str = \"inferno\",\n    ax: Optional[plt.Axes] = None,\n) -&gt; Any:\n    \"\"\"\u7ed8\u5236\u65f6\u9891\u8c31\u56fe\uff08\u77ed\u65f6\u5085\u91cc\u53f6\u53d8\u6362\uff09\n\n    Args:\n        data: \u65f6\u57df\u4fe1\u53f7\u6570\u636e\n        fs: \u91c7\u6837\u9891\u7387 (Hz)\n        window_size: STFT\u7a97\u53e3\u5927\u5c0f\n        overlap: \u7a97\u53e3\u91cd\u53e0\u6bd4\u4f8b\n        title: \u81ea\u5b9a\u4e49\u6807\u9898\n        freq_range: \u53ef\u9009\uff0c\u9891\u7387\u8303\u56f4 (min_freq, max_freq)\n        time_range: \u53ef\u9009\uff0c\u65f6\u95f4\u8303\u56f4 (start_time, end_time)\n        cmap: \u8272\u5f69\u6620\u5c04\u540d\u79f0\n\n    Returns:\n        Figure: matplotlib \u56fe\u5f62\u5bf9\u8c61\n    \"\"\"\n    # \u5ef6\u8fdf\u5bfc\u5165\u5fc5\u8981\u7684\u5e93\n    import matplotlib.pyplot as plt\n    import matplotlib.ticker as ticker\n    from scipy import signal\n\n    # \u6027\u80fd\u4f18\u5316\uff1a\u5bf9\u5927\u6570\u636e\u5904\u7406\u524d\u8fdb\u884c\u964d\u91c7\u6837\uff0c\u964d\u4f4eSTFT\u8ba1\u7b97\u91cf\n    # \u5bf9\u4e8e\u7279\u522b\u5927\u7684\u6570\u636e\uff0c\u4f7f\u7528\u66f4\u5927\u7684\u7a97\u53e3\u5927\u5c0f\u548c\u66f4\u5c11\u7684\u91cd\u53e0\u6765\u51cf\u5c11\u8ba1\u7b97\u91cf\n    MAX_DATA_POINTS = 100000  # \u6700\u5927\u5904\u7406\u70b9\u6570\u9608\u503c\n\n    # \u9488\u5bf9\u957f\u4fe1\u53f7\u8fdb\u884c\u5904\u7406\u4f18\u5316\n    if len(data) &gt; MAX_DATA_POINTS:\n        # \u5982\u679c\u4fe1\u53f7\u957f\u5ea6\u8d85\u8fc7\u9608\u503c\uff0c\u589e\u52a0\u7a97\u53e3\u5927\u5c0f\u5e76\u51cf\u5c11\u91cd\u53e0\n        if window_size &lt; 2048:\n            window_size = 2048  # \u4f7f\u7528\u66f4\u5927\u7684\u7a97\u53e3\n        if overlap &gt; 0.5:\n            overlap = 0.5  # \u51cf\u5c11\u91cd\u53e0\uff0c\u51cf\u5c11\u603b\u7a97\u53e3\u6570\u91cf\n\n    # \u5bf9\u4e8e\u8d85\u5927\u6570\u636e\uff0c\u53ef\u4ee5\u5148\u964d\u91c7\u6837\u518d\u8ba1\u7b97\n    if len(data) &gt; 1000000:  # \u767e\u4e07\u7ea7\u4ee5\u4e0a\u6570\u636e\u70b9\n        # \u964d\u91c7\u6837\u56e0\u5b50\n        downsample_factor = 4\n        data = data[::downsample_factor]\n        fs = fs / downsample_factor\n\n    # \u521b\u5efa\u56fe\u5f62\u548c\u5750\u6807\u8f74 - \u4f18\u5316\u521b\u5efa\u8fc7\u7a0b\n    if ax is None:\n        fig, ax = plt.subplots(figsize=self.config.figsize_standard)\n    else:\n        fig = ax.figure  # type: ignore\n\n    # \u8ba1\u7b97\u7a97\u53e3\u91cd\u53e0\u70b9\u6570\n    noverlap = int(window_size * overlap)\n\n    # \u6027\u80fd\u4f18\u5316\uff1a\u4f7f\u7528\u66f4\u9ad8\u6548\u7684STFT\u8ba1\u7b97\u53c2\u6570\n    # \u8ba1\u7b97STFT - \u4f18\u5316STFT\u8ba1\u7b97\u53c2\u6570\n    f, t, Sxx = signal.spectrogram(\n        data,\n        fs=fs,\n        window=\"hann\",\n        nperseg=window_size,\n        noverlap=noverlap,\n        detrend=\"constant\",\n        scaling=\"density\",\n        mode=\"magnitude\",  # \u76f4\u63a5\u4f7f\u7528\u5e45\u5ea6\u800c\u4e0d\u662f\u529f\u7387\u8c31\uff0c\u51cf\u5c11\u4e00\u6b65\u8ba1\u7b97\n    )\n\n    # \u8f6c\u6362\u4e3a\u5bf9\u6570\u5c3a\u5ea6\u4ee5\u589e\u5f3a\u53ef\u89c6\u5316\u6548\u679c (dB)\n    Sxx_db = 10 * np.log10(Sxx + 1e-12)\n\n    # \u6027\u80fd\u4f18\u5316\uff1a\u4f7f\u7528\u56fa\u5b9a\u7684\u8272\u6807\u8303\u56f4\n    # \u786e\u5b9a\u8272\u6807\u8303\u56f4\uff0c\u589e\u5f3a\u5bf9\u6bd4\u5ea6 - \u4f7f\u7528\u56fa\u5b9a\u8303\u56f4\u800c\u4e0d\u662f\u5206\u4f4d\u6570\u8ba1\u7b97\n    # \u4f7f\u7528\u7b80\u5355\u7684min-max\u52a0\u504f\u7f6e\uff0c\u800c\u4e0d\u662f\u8ba1\u7b97\u5206\u4f4d\u6570\n    vmin = np.mean(Sxx_db) - 2 * np.std(Sxx_db)  # \u5747\u503c\u51cf\u4e24\u4e2a\u6807\u51c6\u5dee\n    vmax = np.mean(Sxx_db) + 2 * np.std(Sxx_db)  # \u5747\u503c\u52a0\u4e24\u4e2a\u6807\u51c6\u5dee\n\n    # \u7ed8\u5236\u65f6\u9891\u8c31 - \u4f7f\u7528\u66f4\u9ad8\u6548\u7684\u6e32\u67d3\u8bbe\u7f6e\n    im = ax.pcolormesh(\n        t,\n        f,\n        Sxx_db,\n        shading=\"auto\",  # \u4f7f\u7528auto\u800c\u4e0d\u662fgouraud\uff0c\u66f4\u9ad8\u6548\n        cmap=cmap,\n        vmin=vmin,\n        vmax=vmax,\n        rasterized=True,  # \u5149\u6805\u5316\u4ee5\u63d0\u9ad8\u6027\u80fd\n    )\n\n    # \u6dfb\u52a0\u989c\u8272\u6761 - \u7b80\u5316\u989c\u8272\u6761\u8bbe\u7f6e\n    cbar = fig.colorbar(im, ax=ax)\n    cbar.set_label(\"Power/Frequency (dB/Hz)\")\n\n    # \u6027\u80fd\u4f18\u5316\uff1a\u79fb\u9664\u590d\u6742\u7684\u6807\u8bb0\n    # \u79fb\u9664\u6700\u5927\u70b9\u6807\u8bb0\uff0c\u63d0\u9ad8\u6027\u80fd\uff0c\u53ea\u6709\u5728\u7279\u522b\u9700\u8981\u65f6\u624d\u8ba1\u7b97\n\n    # \u8bbe\u7f6e\u5750\u6807\u8f74\u8303\u56f4\uff08\u5982\u679c\u6307\u5b9a\uff09\n    if freq_range:\n        ax.set_ylim(freq_range)\n    else:\n        # \u9ed8\u8ba4\u663e\u793a\u4f4e\u9891\u533a\u57df\uff08\u901a\u5e38\u66f4\u6709\u610f\u4e49\uff09\n        max_display_freq = min(fs / 2, 5000) if fs &gt; 10000 else fs / 2\n        ax.set_ylim(0, max_display_freq)\n\n    if time_range:\n        ax.set_xlim(time_range)\n\n    # \u7f8e\u5316\u9891\u7387\u8f74\u683c\u5f0f - \u7b80\u5316\u683c\u5f0f\u8bbe\u7f6e\n    if max(f) &gt; 1000:\n        ax.yaxis.set_major_formatter(\n            ticker.FuncFormatter(\n                lambda y, pos: f\"{y / 1000:.1f}\" if y &gt;= 1000 else f\"{y:.0f}\"\n            )\n        )\n        ax.set_ylabel(\"Frequency (kHz)\")\n    else:\n        ax.set_ylabel(\"Frequency (Hz)\")\n\n    # \u8bbe\u7f6e\u65f6\u95f4\u523b\u5ea6\u683c\u5f0f - \u7b80\u5316\u683c\u5f0f\u8bbe\u7f6e\n    if max(t) &gt; 60:\n        ax.xaxis.set_major_formatter(\n            ticker.FuncFormatter(\n                lambda x, pos: f\"{int(x / 60)}:{int(x % 60):02d}\"\n                if x &gt;= 60\n                else f\"{int(x)}\"\n            )\n        )\n        ax.set_xlabel(\"Time (min:sec)\")\n    else:\n        ax.set_xlabel(\"Time (s)\")\n\n    # \u8bbe\u7f6e\u6807\u9898\n    if title:\n        plot_title = title\n    else:\n        plot_title = \"Spectrogram\"\n    ax.set_title(plot_title, fontweight=\"bold\")\n\n    # \u6dfb\u52a0\u7f51\u683c\u4ee5\u589e\u5f3a\u53ef\u8bfb\u6027 - \u7981\u7528\u7f51\u683c\u63d0\u9ad8\u6027\u80fd\n    ax.grid(False)\n\n    # \u81ea\u52a8\u8c03\u6574\u5e03\u5c40\n    fig.tight_layout()\n\n    return fig\n</code></pre>"},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization.SpectrumPlot","title":"SpectrumPlot","text":"<pre><code>SpectrumPlot(config: Optional[VisualizationConfig] = None)\n</code></pre> <p>               Bases: <code>PlotBase</code></p> <p>\u9891\u8c31\u56fe (Spectrum Plot)</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def __init__(self, config: Optional[VisualizationConfig] = None):\n    \"\"\"\u521d\u59cb\u5316\u7ed8\u56fe\u57fa\u7c7b\n\n    Args:\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\uff0c\u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\n    \"\"\"\n    self.config = config or VisualizationConfig()\n    self.logger = logging.getLogger(__name__)\n    self._setup_style()\n</code></pre>"},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization.SpectrumPlot.plot","title":"plot","text":"<pre><code>plot(\n    frequencies: ndarray,\n    magnitudes: ndarray,\n    channel_id: Optional[Union[int, str]] = None,\n    excitation_freq: Optional[float] = None,\n    title: Optional[str] = None,\n    peaks: Optional[List[Dict[str, float]]] = None,\n    db_range: Optional[Tuple[float, float]] = None,\n    ax: Optional[Axes] = None,\n) -&gt; Any\n</code></pre> <p>\u7ed8\u5236\u9891\u8c31\u56fe</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>frequencies</code> <code>ndarray</code> <p>\u9891\u7387\u6570\u7ec4 (Hz)</p> \u5fc5\u9700 <code>magnitudes</code> <code>ndarray</code> <p>\u9891\u8c31\u5e45\u503c\u6570\u7ec4 (\u901a\u5e38\u662f\u5bf9\u6570\u5c3a\u5ea6\uff0c\u5982 dB)</p> \u5fc5\u9700 <code>channel_id</code> <code>Optional[Union[int, str]]</code> <p>\u53ef\u9009\uff0c\u901a\u9053\u6807\u8bc6</p> <code>None</code> <code>excitation_freq</code> <code>Optional[float]</code> <p>(\u53ef\u9009) \u6fc0\u52b1\u9891\u7387\uff0c\u7528\u4e8e\u5728\u56fe\u4e0a\u6807\u8bb0 (Hz)</p> <code>None</code> <code>title</code> <code>Optional[str]</code> <p>\u81ea\u5b9a\u4e49\u6807\u9898 (\u82f1\u6587), \u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u6807\u9898</p> <code>None</code> <code>peaks</code> <code>Optional[List[Dict[str, float]]]</code> <p>(\u53ef\u9009) \u5cf0\u503c\u5217\u8868\uff0c\u6bcf\u4e2a\u5cf0\u503c\u5305\u542b 'frequency' \u548c 'magnitude'</p> <code>None</code> <code>db_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0cdB\u503c\u663e\u793a\u8303\u56f4 (min_db, max_db)</p> <code>None</code> <code>ax</code> <code>Optional[Axes]</code> <p>\u53ef\u9009\u7684 Axes \u5bf9\u8c61</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Figure</code> <code>Any</code> <p>matplotlib \u56fe\u5f62\u5bf9\u8c61</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def plot(\n    self,\n    frequencies: np.ndarray,\n    magnitudes: np.ndarray,\n    channel_id: Optional[Union[int, str]] = None,\n    excitation_freq: Optional[float] = None,\n    title: Optional[str] = None,\n    peaks: Optional[List[Dict[str, float]]] = None,\n    db_range: Optional[Tuple[float, float]] = None,\n    ax: Optional[plt.Axes] = None,\n) -&gt; Any:  # \u8fd4\u56de\u7c7b\u578b\u6539\u4e3a Any\n    \"\"\"\u7ed8\u5236\u9891\u8c31\u56fe\n\n    Args:\n        frequencies: \u9891\u7387\u6570\u7ec4 (Hz)\n        magnitudes: \u9891\u8c31\u5e45\u503c\u6570\u7ec4 (\u901a\u5e38\u662f\u5bf9\u6570\u5c3a\u5ea6\uff0c\u5982 dB)\n        channel_id: \u53ef\u9009\uff0c\u901a\u9053\u6807\u8bc6\n        excitation_freq: (\u53ef\u9009) \u6fc0\u52b1\u9891\u7387\uff0c\u7528\u4e8e\u5728\u56fe\u4e0a\u6807\u8bb0 (Hz)\n        title: \u81ea\u5b9a\u4e49\u6807\u9898 (\u82f1\u6587), \u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u6807\u9898\n        peaks: (\u53ef\u9009) \u5cf0\u503c\u5217\u8868\uff0c\u6bcf\u4e2a\u5cf0\u503c\u5305\u542b 'frequency' \u548c 'magnitude'\n        db_range: \u53ef\u9009\uff0cdB\u503c\u663e\u793a\u8303\u56f4 (min_db, max_db)\n        ax: \u53ef\u9009\u7684 Axes \u5bf9\u8c61\n\n    Returns:\n        Figure: matplotlib \u56fe\u5f62\u5bf9\u8c61\n    \"\"\"\n\n    # \u6027\u80fd\u4f18\u5316\uff1a\u5982\u679c\u9891\u7387\u70b9\u6570\u8fc7\u591a\uff0c\u8fdb\u884c\u964d\u91c7\u6837\n    MAX_FREQ_POINTS = 10000\n    if len(frequencies) &gt; MAX_FREQ_POINTS:\n        step = len(frequencies) // MAX_FREQ_POINTS\n        frequencies = frequencies[::step]\n        magnitudes = magnitudes[::step]\n\n    # \u521b\u5efa\u56fe\u5f62\u548c\u5750\u6807\u8f74 - \u4f18\u5316\u521b\u5efa\u8fc7\u7a0b\n    if ax is None:\n        fig, ax = plt.subplots(figsize=self.config.figsize_standard)\n    else:\n        fig = ax.figure  # type: ignore\n\n    # \u6027\u80fd\u4f18\u5316\uff1a\u63d0\u524d\u8ba1\u7b97dB\u503c\uff0c\u907f\u514d\u91cd\u590d\u8ba1\u7b97\n    # \u5e45\u503c\u901a\u5e38\u4ee5 dB \u663e\u793a\n    magnitudes_db = 10 * np.log10(magnitudes + 1e-12)  # \u52a0\u4e00\u4e2a\u5c0f\u503c\u907f\u514d log(0)\n\n    # \u7ed8\u5236\u9891\u8c31 - \u4f7f\u7528\u66f4\u9ad8\u6027\u80fd\u7684\u7ed8\u56fe\u8bbe\u7f6e\n    ax.plot(\n        frequencies,\n        magnitudes_db,\n        linewidth=1.0,  # \u51cf\u5c0f\u7ebf\u5bbd\u4ee5\u52a0\u5feb\u6e32\u67d3\n        color=\"#0072B2\",\n        alpha=1.0,\n        zorder=5,\n        rasterized=True,  # \u5149\u6805\u5316\u4ee5\u63d0\u9ad8\u6027\u80fd\n    )\n\n    # \u6807\u8bb0\u5cf0\u503c\uff08\u5982\u679c\u63d0\u4f9b\uff09- \u53ea\u5728\u786e\u5b9e\u9700\u8981\u65f6\u6267\u884c\n    if peaks and len(peaks) &gt; 0:\n        peak_freqs = [p[\"frequency\"] for p in peaks]\n        peak_mags = [10 * np.log10(p[\"magnitude\"] + 1e-12) for p in peaks]\n        ax.plot(\n            peak_freqs,\n            peak_mags,\n            \"o\",\n            color=\"#D55E00\",\n            markersize=5,\n            markeredgewidth=1.0,\n            markeredgecolor=\"black\",\n            alpha=1.0,\n            zorder=10,\n            label=\"Peak Frequencies\",\n        )\n\n        # \u4e3a\u524d\u4e09\u4e2a\u5cf0\u6dfb\u52a0\u6807\u7b7e - \u4ec5\u5904\u7406\u4e00\u5c0f\u90e8\u5206\u5cf0\u503c\n        for i, (f, m) in enumerate(\n            zip(\n                peak_freqs[: min(3, len(peak_freqs))],\n                peak_mags[: min(3, len(peak_mags))],\n            )\n        ):\n            ax.annotate(\n                f\"{f:.1f} Hz\",\n                xy=(f, m),\n                xytext=(5, 5),\n                textcoords=\"offset points\",\n                fontsize=9,\n                fontweight=\"bold\",\n                bbox=dict(\n                    boxstyle=\"round,pad=0.3\", fc=\"white\", ec=\"black\", alpha=0.9\n                ),\n            )\n\n    # \u6807\u8bb0\u6fc0\u52b1\u9891\u7387 - \u53ea\u5728\u786e\u5b9e\u9700\u8981\u65f6\u6267\u884c\n    if excitation_freq is not None:\n        # \u4ee5\u6fc0\u52b1\u9891\u7387\u4e3a\u4e2d\u5fc3\uff0c\u7a97\u53e3\u5927\u5c0f\u53d6\u51b3\u4e8e\u6570\u636e\u8303\u56f4\n        data_range = np.max(frequencies) - np.min(frequencies)\n        window_size = min(data_range * 0.4, excitation_freq * 0.6)\n\n        # \u6027\u80fd\u4f18\u5316\uff1a\u907f\u514d\u591a\u6b21\u8c03\u7528set_xlim\n        ax.set_xlim(\n            max(0, excitation_freq - window_size), excitation_freq + window_size\n        )\n\n        # \u6dfb\u52a0\u5782\u76f4\u7ebf\u6807\u8bb0\u6fc0\u52b1\u9891\u7387\n        ax.axvline(\n            excitation_freq,\n            color=\"#D55E00\",\n            linestyle=\"--\",\n            linewidth=1.5,\n            alpha=0.7,\n            zorder=6,\n            label=f\"Excitation: {excitation_freq:.1f} Hz\",\n        )\n\n    # \u8bbe\u7f6e\u7f51\u683c - \u7b80\u5316\u7f51\u683c\u8bbe\u7f6e\u4ee5\u63d0\u9ad8\u6027\u80fd\n    ax.grid(True, which=\"major\", linestyle=\"--\", alpha=0.5, zorder=1)\n\n    # \u7981\u7528\u6b21\u523b\u5ea6\u4ee5\u63d0\u9ad8\u6027\u80fd\n    plt.minorticks_off()\n\n    # \u6539\u5584x\u8f74\u523b\u5ea6\u683c\u5f0f - \u7b80\u5316\u523b\u5ea6\u5904\u7406\n    if max(frequencies) &gt; 1000:\n        ax.xaxis.set_major_formatter(\n            ticker.FuncFormatter(\n                lambda x, pos: f\"{x / 1000:.0f}\" if x &gt;= 1000 else f\"{x:.0f}\"\n            )\n        )\n        ax.set_xlabel(\"Frequency (kHz)\")\n    else:\n        ax.set_xlabel(\"Frequency (Hz)\")\n\n    ax.set_ylabel(\"Magnitude (dB)\")\n\n    # \u56fe\u4f8b\u8bbe\u7f6e\uff08\u5982\u679c\u6709\u9700\u8981\u7684\u8bdd\uff09\n    if (excitation_freq is not None or peaks) and ax.get_legend_handles_labels()[0]:\n        leg = ax.legend(\n            loc=\"best\", frameon=True, framealpha=0.9, fontsize=9, edgecolor=\"black\"\n        )\n        # \u7b80\u5316\u56fe\u4f8b\u6837\u5f0f\u8bbe\u7f6e\n        for line in leg.get_lines():\n            line.set_linewidth(2.0)\n\n    # \u4f7f\u7528\u81ea\u5b9a\u4e49\u6807\u9898\u6216\u9ed8\u8ba4\u6807\u9898\n    if title:\n        plot_title = title\n    elif excitation_freq and channel_id is not None:\n        plot_title = (\n            f\"Spectrum for Channel {channel_id} around {excitation_freq:.1f} Hz\"\n        )\n    elif excitation_freq:\n        plot_title = f\"Spectrum around {excitation_freq:.1f} Hz\"\n    elif channel_id is not None:\n        plot_title = f\"Spectrum for Channel {channel_id}\"\n    else:\n        plot_title = \"Spectrum\"\n    ax.set_title(plot_title, fontweight=\"bold\")\n\n    # \u8bbe\u7f6ey\u8f74\u8303\u56f4\n    if db_range is not None:\n        # \u5982\u679c\u63d0\u4f9b\u4e86dB\u8303\u56f4\uff0c\u76f4\u63a5\u4f7f\u7528\n        ax.set_ylim(db_range)\n    else:\n        # \u6027\u80fd\u4f18\u5316\uff1a\u76f4\u63a5\u4f7f\u7528\u6570\u636e\u8303\u56f4\u8bbe\u7f6ey\u8f74\u8303\u56f4\uff0c\u907f\u514d\u989d\u5916\u8ba1\u7b97\n        ymin = np.min(magnitudes_db)\n        ymax = np.max(magnitudes_db)\n        y_range = ymax - ymin\n        ax.set_ylim(ymin - 0.05 * y_range, ymax + 0.05 * y_range)\n\n    # \u81ea\u52a8\u8c03\u6574\u5e03\u5c40\n    fig.tight_layout()\n\n    return fig\n</code></pre>"},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization.WaterfallPlot","title":"WaterfallPlot","text":"<pre><code>WaterfallPlot(config: Optional[VisualizationConfig] = None)\n</code></pre> <p>               Bases: <code>PlotBase</code></p> <p>\u7011\u5e03\u56fe (Waterfall Plot) \u7ed8\u56fe\u7c7b\uff0c\u7528\u4e8e\u53ef\u89c6\u5316\u4e8c\u7ef4\u6570\u636e</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def __init__(self, config: Optional[VisualizationConfig] = None):\n    \"\"\"\u521d\u59cb\u5316\u7ed8\u56fe\u57fa\u7c7b\n\n    Args:\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\uff0c\u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\n    \"\"\"\n    self.config = config or VisualizationConfig()\n    self.logger = logging.getLogger(__name__)\n    self._setup_style()\n</code></pre>"},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization.WaterfallPlot.plot","title":"plot","text":"<pre><code>plot(\n    data: ndarray,\n    fs: float,\n    x_label: str = \"Channels\",\n    y_label: str = \"Time (s)\",\n    title: Optional[str] = None,\n    cmap: str = \"viridis\",\n    colorbar_label: str = \"Amplitude\",\n    aspect: str = \"auto\",\n    origin: str = \"upper\",\n    x_ticks: Optional[ndarray] = None,\n    y_ticks: Optional[ndarray] = None,\n    value_range: Optional[Tuple[float, float]] = None,\n    ax: Optional[Axes] = None,\n) -&gt; Any\n</code></pre> <p>\u7ed8\u5236\u7011\u5e03\u56fe\uff08\u4e8c\u7ef4\u6570\u636e\u53ef\u89c6\u5316\uff09</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u4e8c\u7ef4\u6570\u7ec4\uff0c\u5f62\u72b6\u4e3a (time_samples, channels) \u6216 (channels, time_samples)</p> \u5fc5\u9700 <code>fs</code> <code>float</code> <p>\u91c7\u6837\u9891\u7387 (Hz)</p> \u5fc5\u9700 <code>x_label</code> <code>str</code> <p>X\u8f74\u6807\u7b7e</p> <code>'Channels'</code> <code>y_label</code> <code>str</code> <p>Y\u8f74\u6807\u7b7e</p> <code>'Time (s)'</code> <code>title</code> <code>Optional[str]</code> <p>\u81ea\u5b9a\u4e49\u6807\u9898 (\u82f1\u6587)</p> <code>None</code> <code>cmap</code> <code>str</code> <p>\u8272\u5f69\u6620\u5c04\u540d\u79f0</p> <code>'viridis'</code> <code>colorbar_label</code> <code>str</code> <p>\u989c\u8272\u6761\u6807\u7b7e</p> <code>'Amplitude'</code> <code>aspect</code> <code>str</code> <p>\u56fe\u50cf\u7eb5\u6a2a\u6bd4\uff0c'auto' \u6216 'equal'</p> <code>'auto'</code> <code>origin</code> <code>str</code> <p>\u6570\u636e\u539f\u70b9\u4f4d\u7f6e\uff0c'upper' \u6216 'lower'</p> <code>'upper'</code> <code>x_ticks</code> <code>Optional[ndarray]</code> <p>\u53ef\u9009\uff0cX\u8f74\u523b\u5ea6\u503c</p> <code>None</code> <code>y_ticks</code> <code>Optional[ndarray]</code> <p>\u53ef\u9009\uff0cY\u8f74\u523b\u5ea6\u503c</p> <code>None</code> <code>value_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0c\u6570\u636e\u503c\u663e\u793a\u8303\u56f4 (min_value, max_value)</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Figure</code> <code>Any</code> <p>matplotlib \u56fe\u5f62\u5bf9\u8c61</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def plot(\n    self,\n    data: np.ndarray,\n    fs: float,\n    x_label: str = \"Channels\",\n    y_label: str = \"Time (s)\",\n    title: Optional[str] = None,\n    cmap: str = \"viridis\",\n    colorbar_label: str = \"Amplitude\",\n    aspect: str = \"auto\",\n    origin: str = \"upper\",\n    x_ticks: Optional[np.ndarray] = None,\n    y_ticks: Optional[np.ndarray] = None,\n    value_range: Optional[Tuple[float, float]] = None,\n    ax: Optional[plt.Axes] = None,\n) -&gt; Any:\n    \"\"\"\u7ed8\u5236\u7011\u5e03\u56fe\uff08\u4e8c\u7ef4\u6570\u636e\u53ef\u89c6\u5316\uff09\n\n    Args:\n        data: \u4e8c\u7ef4\u6570\u7ec4\uff0c\u5f62\u72b6\u4e3a (time_samples, channels) \u6216 (channels, time_samples)\n        fs: \u91c7\u6837\u9891\u7387 (Hz)\n        x_label: X\u8f74\u6807\u7b7e\n        y_label: Y\u8f74\u6807\u7b7e\n        title: \u81ea\u5b9a\u4e49\u6807\u9898 (\u82f1\u6587)\n        cmap: \u8272\u5f69\u6620\u5c04\u540d\u79f0\n        colorbar_label: \u989c\u8272\u6761\u6807\u7b7e\n        aspect: \u56fe\u50cf\u7eb5\u6a2a\u6bd4\uff0c'auto' \u6216 'equal'\n        origin: \u6570\u636e\u539f\u70b9\u4f4d\u7f6e\uff0c'upper' \u6216 'lower'\n        x_ticks: \u53ef\u9009\uff0cX\u8f74\u523b\u5ea6\u503c\n        y_ticks: \u53ef\u9009\uff0cY\u8f74\u523b\u5ea6\u503c\n        value_range: \u53ef\u9009\uff0c\u6570\u636e\u503c\u663e\u793a\u8303\u56f4 (min_value, max_value)\n\n    Returns:\n        Figure: matplotlib \u56fe\u5f62\u5bf9\u8c61\n    \"\"\"\n    # \u5ef6\u8fdf\u5bfc\u5165 matplotlib\n    import matplotlib.pyplot as plt\n\n    # \u521b\u5efa\u56fe\u5f62\u548c\u5750\u6807\u8f74\n    if ax is None:\n        fig, ax = plt.subplots(figsize=self.config.figsize_wide)\n    else:\n        fig = ax.figure  # type: ignore\n\n    # \u786e\u5b9a\u6570\u636e\u663e\u793a\u8303\u56f4\n    if value_range is None:\n        # \u81ea\u52a8\u786e\u5b9a\u5408\u9002\u7684\u6570\u636e\u8303\u56f4\n        vmin = np.percentile(data, 5)  # 5%\u5206\u4f4d\u6570\u4f5c\u4e3a\u6700\u5c0f\u503c\n        vmax = np.percentile(data, 95)  # 95%\u5206\u4f4d\u6570\u4f5c\u4e3a\u6700\u5927\u503c\n\n        # \u5bf9\u79f0\u5316\u8303\u56f4\uff0c\u627e\u51fa\u7edd\u5bf9\u503c\u6700\u5927\u7684\u8303\u56f4\n        abs_max = max(abs(vmin), abs(vmax))\n        if np.min(data) &lt; 0:  # \u5982\u679c\u6570\u636e\u6709\u8d1f\u503c\uff0c\u4f7f\u7528\u5bf9\u79f0\u8303\u56f4\n            vmin, vmax = -abs_max, abs_max\n    else:\n        vmin, vmax = value_range\n\n    # \u7ed8\u5236\u7011\u5e03\u56fe\n    im = ax.imshow(\n        data,\n        cmap=cmap,\n        aspect=aspect,  # type: ignore\n        origin=origin,  # type: ignore\n        interpolation=\"none\",  # \u7981\u7528\u63d2\u503c\u4ee5\u4fdd\u6301\u539f\u59cb\u6570\u636e\u7684\u6e05\u6670\u5ea6\n        vmin=vmin,\n        vmax=vmax,\n    )\n\n    # \u6dfb\u52a0\u989c\u8272\u6761\n    cbar = fig.colorbar(im, ax=ax, pad=0.01)\n    cbar.set_label(colorbar_label, fontsize=11)\n\n    # \u8bbe\u7f6e\u81ea\u5b9a\u4e49\u523b\u5ea6\uff08\u5982\u679c\u63d0\u4f9b\uff09\n    if x_ticks is not None:\n        ax.set_xticks(np.arange(0, data.shape[1], max(1, data.shape[1] // 10)))\n\n        # \u5982\u679c\u63d0\u4f9b\u4e86\u5177\u4f53\u7684x\u523b\u5ea6\u503c\uff0c\u4f7f\u7528\u5b83\u4eec\n        if len(x_ticks) &gt;= data.shape[1]:\n            x_tick_labels = x_ticks[: data.shape[1]]\n            # \u51cf\u5c11\u663e\u793a\u7684\u523b\u5ea6\u6570\u91cf\uff0c\u907f\u514d\u62e5\u6324\n            tick_indices = np.linspace(\n                0, len(x_tick_labels) - 1, min(10, len(x_tick_labels)), dtype=int\n            )\n            ax.set_xticks(tick_indices)\n            ax.set_xticklabels([f\"{x_tick_labels[i]:.0f}\" for i in tick_indices])\n\n    if y_ticks is not None:\n        ax.set_yticks(np.arange(0, data.shape[0], max(1, data.shape[0] // 10)))\n\n        # \u5982\u679c\u63d0\u4f9b\u4e86\u5177\u4f53\u7684y\u523b\u5ea6\u503c\uff0c\u4f7f\u7528\u5b83\u4eec\n        if len(y_ticks) &gt;= data.shape[0]:\n            y_tick_labels = y_ticks[: data.shape[0]]\n            # \u51cf\u5c11\u663e\u793a\u7684\u523b\u5ea6\u6570\u91cf\uff0c\u907f\u514d\u62e5\u6324\n            tick_indices = np.linspace(\n                0, len(y_tick_labels) - 1, min(10, len(y_tick_labels)), dtype=int\n            )\n            ax.set_yticks(tick_indices)\n            ax.set_yticklabels([f\"{y_tick_labels[i]:.1f}\" for i in tick_indices])\n    else:\n        # \u6839\u636e\u91c7\u6837\u9891\u7387\u8ba1\u7b97\u65f6\u95f4\u523b\u5ea6\n        if origin == \"upper\" or origin == \"lower\":\n            # \u8ba1\u7b97\u65f6\u95f4\u8f74\u7684\u5b9e\u9645\u503c\uff08\u79d2\uff09\n            time_values = np.arange(data.shape[0]) / fs\n\n            # \u8bbe\u7f6e\u5408\u9002\u7684\u65f6\u95f4\u523b\u5ea6\u6570\u91cf\n            num_ticks = min(10, data.shape[0])\n            tick_indices = np.linspace(0, data.shape[0] - 1, num_ticks, dtype=int)\n\n            ax.set_yticks(tick_indices)\n\n            # \u6839\u636e\u65f6\u95f4\u957f\u5ea6\u683c\u5f0f\u5316\u6807\u7b7e\n            if max(time_values) &gt; 60:\n                # \u5982\u679c\u65f6\u95f4\u8d85\u8fc760\u79d2\uff0c\u4f7f\u7528\u5206:\u79d2\u683c\u5f0f\n                ax.set_yticklabels(\n                    [\n                        f\"{int(time_values[i] / 60)}:{int(time_values[i] % 60):02d}\"\n                        for i in tick_indices\n                    ]\n                )\n                y_label = \"Time (min:sec)\"\n            else:\n                # \u5426\u5219\u4f7f\u7528\u79d2\u683c\u5f0f\n                ax.set_yticklabels([f\"{time_values[i]:.1f}\" for i in tick_indices])\n                y_label = \"Time (s)\"\n\n    # \u8bbe\u7f6e\u6807\u7b7e\n    ax.set_xlabel(x_label, fontsize=12)\n    ax.set_ylabel(y_label, fontsize=12)\n\n    # \u8bbe\u7f6e\u6807\u9898\n    if title:\n        plot_title = title\n    else:\n        plot_title = \"Waterfall Plot\"\n    ax.set_title(plot_title, fontweight=\"bold\", fontsize=14)\n\n    # \u4f18\u5316\u7f51\u683c\u548c\u523b\u5ea6\n    ax.grid(False)  # \u5bf9\u4e8eimshow\u7c7b\u578b\u7684\u56fe\uff0c\u901a\u5e38\u4e0d\u9700\u8981\u7f51\u683c\n\n    # \u81ea\u52a8\u8c03\u6574\u5e03\u5c40\n    fig.tight_layout()\n\n    # \u6dfb\u52a0\u53ef\u9009\u6c34\u5370\n    self._add_watermark(fig, ax)\n\n    return fig\n</code></pre>"},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization.WaveformPlot","title":"WaveformPlot","text":"<pre><code>WaveformPlot(config: Optional[VisualizationConfig] = None)\n</code></pre> <p>               Bases: <code>PlotBase</code></p> <p>\u65f6\u57df\u6ce2\u5f62\u56fe (Time Domain Waveform Plot)</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def __init__(self, config: Optional[VisualizationConfig] = None):\n    \"\"\"\u521d\u59cb\u5316\u7ed8\u56fe\u57fa\u7c7b\n\n    Args:\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\uff0c\u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\n    \"\"\"\n    self.config = config or VisualizationConfig()\n    self.logger = logging.getLogger(__name__)\n    self._setup_style()\n</code></pre>"},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization.WaveformPlot.plot","title":"plot","text":"<pre><code>plot(\n    amplitude_data: ndarray,\n    fs: float,\n    time_range: Optional[Tuple[float, float]] = None,\n    amplitude_range: Optional[Tuple[float, float]] = None,\n    title: Optional[str] = None,\n    highlight_regions: Optional[\n        List[Tuple[float, float]]\n    ] = None,\n    ax: Optional[Axes] = None,\n) -&gt; Any\n</code></pre> <p>\u7ed8\u5236\u65f6\u57df\u6ce2\u5f62\u56fe</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>amplitude_data</code> <code>ndarray</code> <p>\u5e45\u503c\u6570\u7ec4</p> \u5fc5\u9700 <code>fs</code> <code>float</code> <p>\u91c7\u6837\u9891\u7387 (Hz)</p> \u5fc5\u9700 <code>amplitude_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0c\u5e45\u503c\u663e\u793a\u8303\u56f4 (min_amplitude, max_amplitude)</p> <code>None</code> <code>time_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0c\u65f6\u95f4\u663e\u793a\u8303\u56f4 (start_time, end_time)</p> <code>None</code> <code>title</code> <code>Optional[str]</code> <p>\u81ea\u5b9a\u4e49\u6807\u9898 (\u82f1\u6587), \u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u6807\u9898</p> <code>None</code> <code>highlight_regions</code> <code>Optional[List[Tuple[float, float]]]</code> <p>\u53ef\u9009\u7684\u9ad8\u4eae\u533a\u57df\u5217\u8868\uff0c\u6bcf\u4e2a\u5143\u7d20\u4e3a(\u5f00\u59cb\u65f6\u95f4, \u7ed3\u675f\u65f6\u95f4)\u5143\u7ec4</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Figure</code> <code>Any</code> <p>matplotlib \u56fe\u5f62\u5bf9\u8c61</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def plot(\n    self,\n    amplitude_data: np.ndarray,\n    fs: float,\n    time_range: Optional[Tuple[float, float]] = None,\n    amplitude_range: Optional[Tuple[float, float]] = None,\n    title: Optional[str] = None,\n    highlight_regions: Optional[List[Tuple[float, float]]] = None,\n    ax: Optional[plt.Axes] = None,\n) -&gt; Any:  # \u8fd4\u56de\u7c7b\u578b\u6539\u4e3a Any\n    \"\"\"\u7ed8\u5236\u65f6\u57df\u6ce2\u5f62\u56fe\n\n    Args:\n        amplitude_data: \u5e45\u503c\u6570\u7ec4\n        fs: \u91c7\u6837\u9891\u7387 (Hz)\n        amplitude_range: \u53ef\u9009\uff0c\u5e45\u503c\u663e\u793a\u8303\u56f4 (min_amplitude, max_amplitude)\n        time_range: \u53ef\u9009\uff0c\u65f6\u95f4\u663e\u793a\u8303\u56f4 (start_time, end_time)\n        title: \u81ea\u5b9a\u4e49\u6807\u9898 (\u82f1\u6587), \u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u6807\u9898\n        highlight_regions: \u53ef\u9009\u7684\u9ad8\u4eae\u533a\u57df\u5217\u8868\uff0c\u6bcf\u4e2a\u5143\u7d20\u4e3a(\u5f00\u59cb\u65f6\u95f4, \u7ed3\u675f\u65f6\u95f4)\u5143\u7ec4\n\n    Returns:\n        Figure: matplotlib \u56fe\u5f62\u5bf9\u8c61\n    \"\"\"\n    # \u5ef6\u8fdf\u5bfc\u5165 matplotlib\n    import matplotlib.pyplot as plt\n    import matplotlib.ticker as ticker\n\n    # \u6839\u636e\u91c7\u6837\u7387\u81ea\u52a8\u751f\u6210\u65f6\u95f4\u6570\u7ec4\n    num_samples = len(amplitude_data)\n    time_data = np.linspace(0, num_samples / fs, num_samples, endpoint=False)\n\n    # \u6027\u80fd\u4f18\u5316\uff1a\u5bf9\u5927\u6570\u636e\u8fdb\u884c\u964d\u91c7\u6837\uff0c\u53ea\u5728\u65f6\u57df\u7ed8\u56fe\u4e2d\u4f7f\u7528\n    # \u5bf9\u4e8e\u5927\u4e8e10\u4e07\u70b9\u7684\u6570\u636e\u8fdb\u884c\u667a\u80fd\u964d\u91c7\u6837\n    MAX_POINTS_TO_PLOT = 10000  # \u6700\u5927\u7ed8\u5236\u70b9\u6570\u9608\u503c\uff0c\u8d85\u8fc7\u6b64\u503c\u8fdb\u884c\u964d\u91c7\u6837\n\n    # \u5982\u679c\u6307\u5b9a\u4e86\u65f6\u95f4\u8303\u56f4\uff0c\u5148\u8fc7\u6ee4\u6570\u636e\n    if time_range is not None:\n        start_time, end_time = time_range\n        mask = (time_data &gt;= start_time) &amp; (time_data &lt;= end_time)\n        time_data = time_data[mask]\n        amplitude_data = amplitude_data[mask]\n\n    if len(amplitude_data) &gt; MAX_POINTS_TO_PLOT:\n        # \u4f7f\u7528\u5747\u5300\u964d\u91c7\u6837\n        step = len(amplitude_data) // MAX_POINTS_TO_PLOT\n        # \u786e\u4fdd\u6355\u83b7\u6700\u5927\u548c\u6700\u5c0f\u503c\uff0c\u5bf9\u53ef\u89c6\u5316\u975e\u5e38\u91cd\u8981\n        plot_time_data = time_data[::step]\n        plot_amplitude_data = amplitude_data[::step]\n\n        # \u4e3a\u4e86\u786e\u4fdd\u4e0d\u9519\u8fc7\u6781\u503c\u70b9\uff0c\u5728\u6bcf\u4e00\u6bb5\u4e2d\u67e5\u627e\u6700\u5927\u503c\u548c\u6700\u5c0f\u503c\u70b9\n        if step &gt; 2:  # \u53ea\u6709\u5f53\u964d\u91c7\u6837\u6bd4\u4f8b\u8f83\u5927\u65f6\u624d\u8fdb\u884c\u6781\u503c\u4fdd\u7559\n            max_vals = []\n            min_vals = []\n            max_times = []\n            min_times = []\n\n            for i in range(0, len(amplitude_data), step):\n                chunk = amplitude_data[i : i + step]\n                if len(chunk) &gt; 0:\n                    max_idx = np.argmax(chunk) + i\n                    min_idx = np.argmin(chunk) + i\n                    max_vals.append(amplitude_data[max_idx])\n                    min_vals.append(amplitude_data[min_idx])\n                    max_times.append(time_data[max_idx])\n                    min_times.append(time_data[min_idx])\n\n            # \u5408\u5e76\u5747\u5300\u91c7\u6837\u70b9\u548c\u6781\u503c\u70b9\n            plot_time_data = np.concatenate(\n                [\n                    plot_time_data,\n                    np.array(max_times),\n                    np.array(min_times),\n                ]\n            )\n            plot_amplitude_data = np.concatenate(\n                [\n                    plot_amplitude_data,\n                    np.array(max_vals),\n                    np.array(min_vals),\n                ]\n            )\n\n            # \u6309\u65f6\u95f4\u6392\u5e8f\n            sort_idx = np.argsort(plot_time_data)\n            plot_time_data = plot_time_data[sort_idx]\n            plot_amplitude_data = plot_amplitude_data[sort_idx]\n    else:\n        plot_time_data = time_data\n        plot_amplitude_data = amplitude_data\n\n    # \u521b\u5efa\u5177\u6709\u9ec4\u91d1\u6bd4\u4f8b\u7684\u56fe\u5f62 - \u4f18\u5316\u56fe\u5f62\u521b\u5efa\u8fc7\u7a0b\n    if ax is None:\n        fig, ax = plt.subplots(figsize=self.config.figsize_wide)\n    else:\n        fig = ax.figure  # type: ignore\n\n    # \u7ed8\u5236\u6ce2\u5f62 - \u76f4\u63a5\u7ed8\u5236\uff0c\u65e0\u9700\u8ba1\u7b97\u7edf\u8ba1\u4fe1\u606f\n    # \u6027\u80fd\u4f18\u5316\uff1a\u4f7f\u7528\u66f4\u9ad8\u6548\u7684\u7ebf\u6761\u6e32\u67d3\uff0c\u51cf\u5c11\u4e2d\u95f4\u8ba1\u7b97\n    (line,) = ax.plot(\n        plot_time_data,\n        plot_amplitude_data,\n        color=\"#0072B2\",\n        linewidth=1.0,\n        alpha=0.9,\n        zorder=5,\n        rasterized=True,  # \u5149\u6805\u5316\u53ef\u663e\u8457\u63d0\u9ad8\u5927\u91cf\u6570\u636e\u70b9\u7684\u6e32\u67d3\u6027\u80fd\n    )\n\n    # \u6dfb\u52a0\u9ad8\u4eae\u533a\u57df\uff08\u5982\u679c\u6709\uff09- \u53ea\u6709\u5728\u786e\u5b9e\u9700\u8981\u65f6\u624d\u6267\u884c\n    if highlight_regions:\n        for i, (start, end) in enumerate(highlight_regions):\n            ax.axvspan(\n                start,\n                end,\n                alpha=0.2,\n                color=plt.cm.get_cmap(\"tab10\")(i % 10),\n                zorder=2,\n            )\n            # \u6dfb\u52a0\u533a\u57df\u6807\u7b7e\n            mid_point = (start + end) / 2\n            ax.annotate(\n                f\"Region {i + 1}\",\n                xy=(mid_point, ax.get_ylim()[1] * 0.9),\n                ha=\"center\",\n                fontsize=9,\n                fontweight=\"bold\",\n                bbox=dict(\n                    boxstyle=\"round,pad=0.2\", fc=\"white\", ec=\"gray\", alpha=0.8\n                ),\n            )\n\n    # \u8bbe\u7f6e\u7f51\u683c - \u7b80\u5316\u7f51\u683c\u6837\u5f0f\n    ax.grid(True, which=\"major\", linestyle=\"--\", alpha=0.4, zorder=1)\n\n    # \u8ba1\u7b97\u5e76\u6807\u8bb0\u96f6\u7ebf\n    ax.axhline(\n        y=0, color=\"black\", linestyle=\"-\", linewidth=0.8, alpha=0.5, zorder=3\n    )\n\n    # \u8bbe\u7f6ey\u8f74\u8303\u56f4\n    if amplitude_range is not None:\n        # \u5982\u679c\u63d0\u4f9b\u4e86\u5e45\u503c\u8303\u56f4\uff0c\u76f4\u63a5\u4f7f\u7528\n        ax.set_ylim(amplitude_range)\n    else:\n        # \u6027\u80fd\u4f18\u5316\uff1a\u76f4\u63a5\u4f7f\u7528\u6570\u636e\u7684\u6700\u5c0f\u6700\u5927\u503c\u8bbe\u7f6ey\u8f74\u8303\u56f4\uff0c\u907f\u514d\u989d\u5916\u8ba1\u7b97\n        y_min, y_max = np.min(plot_amplitude_data), np.max(plot_amplitude_data)\n        y_range = y_max - y_min\n        ax.set_ylim(y_min - 0.1 * y_range, y_max + 0.1 * y_range)\n\n    # \u8bbe\u7f6ex\u8f74\u8303\u56f4\uff08\u5982\u679c\u63d0\u4f9b\u4e86time_range\u4f46\u6ca1\u6709\u8fc7\u6ee4\u6570\u636e\uff09\n    if time_range is not None and not (\n        time_data[0] &gt;= time_range[0] and time_data[-1] &lt;= time_range[1]\n    ):\n        ax.set_xlim(time_range)\n\n    # \u4f18\u5316\u5750\u6807\u8f74\n    ax.set_xlabel(\"Time (s)\")\n    ax.set_ylabel(\"Amplitude\")\n\n    # \u7b80\u5316\u65f6\u95f4\u523b\u5ea6\u683c\u5f0f\n    if max(plot_time_data) - min(plot_time_data) &gt; 60:\n        # \u8d85\u8fc760\u79d2\uff0c\u4ee5\u5206:\u79d2\u663e\u793a\n        ax.xaxis.set_major_formatter(\n            ticker.FuncFormatter(\n                lambda x, pos: f\"{int(x / 60)}:{int(x % 60):02d}\"\n                if x &gt;= 60\n                else f\"{int(x)}\"\n            )\n        )\n        ax.set_xlabel(\"Time (min:sec)\")\n\n    # \u4f7f\u7528\u81ea\u5b9a\u4e49\u6807\u9898\u6216\u9ed8\u8ba4\u6807\u9898\n    if title:\n        plot_title = title\n    else:\n        plot_title = \"Time Domain Waveform\"\n    ax.set_title(plot_title, fontweight=\"bold\")\n\n    # \u7981\u7528\u4e0d\u5fc5\u8981\u7684\u523b\u5ea6\uff0c\u63d0\u9ad8\u6027\u80fd\n    plt.minorticks_off()\n\n    # \u81ea\u52a8\u8c03\u6574\u5e03\u5c40\n    fig.tight_layout()\n\n    return fig\n</code></pre>"},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization.add_colorbar","title":"add_colorbar","text":"<pre><code>add_colorbar(\n    fig: Figure,\n    mappable: ScalarMappable,\n    ax: Axes,\n    label: Optional[str] = None,\n    config: Optional[VisualizationConfig] = None,\n    **kwargs: Any,\n) -&gt; plt.colorbar.Colorbar\n</code></pre> <p>\u6dfb\u52a0\u4e13\u4e1a\u683c\u5f0f\u7684\u989c\u8272\u6761</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>fig</code> <code>Figure</code> <p>Figure \u5bf9\u8c61</p> \u5fc5\u9700 <code>mappable</code> <code>ScalarMappable</code> <p>\u53ef\u6620\u5c04\u5bf9\u8c61\uff08\u5982 imshow \u8fd4\u56de\u503c\uff09</p> \u5fc5\u9700 <code>ax</code> <code>Axes</code> <p>\u5173\u8054\u7684 Axes</p> \u5fc5\u9700 <code>label</code> <code>Optional[str]</code> <p>\u989c\u8272\u6761\u6807\u7b7e</p> <code>None</code> <code>config</code> <code>Optional[VisualizationConfig]</code> <p>\u53ef\u89c6\u5316\u914d\u7f6e</p> <code>None</code> <code>**kwargs</code> <code>Any</code> <p>\u4f20\u9012\u7ed9 colorbar \u7684\u5176\u4ed6\u53c2\u6570</p> <code>{}</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Colorbar</code> <p>matplotlib.colorbar.Colorbar: Colorbar \u5bf9\u8c61</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/styles.py</code> <pre><code>def add_colorbar(\n    fig: plt.Figure,\n    mappable: plt.cm.ScalarMappable,\n    ax: plt.Axes,\n    label: Optional[str] = None,\n    config: Optional[VisualizationConfig] = None,\n    **kwargs: Any,\n) -&gt; plt.colorbar.Colorbar:\n    \"\"\"\u6dfb\u52a0\u4e13\u4e1a\u683c\u5f0f\u7684\u989c\u8272\u6761\n\n    Args:\n        fig: Figure \u5bf9\u8c61\n        mappable: \u53ef\u6620\u5c04\u5bf9\u8c61\uff08\u5982 imshow \u8fd4\u56de\u503c\uff09\n        ax: \u5173\u8054\u7684 Axes\n        label: \u989c\u8272\u6761\u6807\u7b7e\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\n        **kwargs: \u4f20\u9012\u7ed9 colorbar \u7684\u5176\u4ed6\u53c2\u6570\n\n    Returns:\n        matplotlib.colorbar.Colorbar: Colorbar \u5bf9\u8c61\n    \"\"\"\n    if config is None:\n        config = VisualizationConfig()\n\n    cbar = fig.colorbar(\n        mappable,\n        ax=ax,\n        pad=config.colorbar_pad,\n        fraction=config.colorbar_width * 2,\n        **kwargs,\n    )\n\n    if label:\n        cbar.set_label(label, fontsize=config.typography.label)\n\n    cbar.ax.tick_params(\n        direction=config.tick_direction,\n        width=config.tick_major_width,\n        length=config.tick_major_size,\n    )\n\n    return cbar\n</code></pre>"},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization.add_panel_label","title":"add_panel_label","text":"<pre><code>add_panel_label(\n    ax: Axes,\n    label: str,\n    loc: str = \"upper left\",\n    fontsize: int = 12,\n    fontweight: str = \"bold\",\n) -&gt; None\n</code></pre> <p>\u6dfb\u52a0\u5b50\u56fe\u6807\u7b7e\uff08\u5982 a, b, c\uff09</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>ax</code> <code>Axes</code> <p>Axes \u5bf9\u8c61</p> \u5fc5\u9700 <code>label</code> <code>str</code> <p>\u6807\u7b7e\u6587\u672c\uff08\u5982 \"a\", \"b\"\uff09</p> \u5fc5\u9700 <code>loc</code> <code>str</code> <p>\u4f4d\u7f6e</p> <code>'upper left'</code> <code>fontsize</code> <code>int</code> <p>\u5b57\u53f7</p> <code>12</code> <code>fontweight</code> <code>str</code> <p>\u5b57\u91cd</p> <code>'bold'</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/styles.py</code> <pre><code>def add_panel_label(\n    ax: plt.Axes,\n    label: str,\n    loc: str = \"upper left\",\n    fontsize: int = 12,\n    fontweight: str = \"bold\",\n) -&gt; None:\n    \"\"\"\u6dfb\u52a0\u5b50\u56fe\u6807\u7b7e\uff08\u5982 a, b, c\uff09\n\n    Args:\n        ax: Axes \u5bf9\u8c61\n        label: \u6807\u7b7e\u6587\u672c\uff08\u5982 \"a\", \"b\"\uff09\n        loc: \u4f4d\u7f6e\n        fontsize: \u5b57\u53f7\n        fontweight: \u5b57\u91cd\n    \"\"\"\n    loc_map = {\n        \"upper left\": (-0.1, 1.1),\n        \"upper right\": (1.05, 1.1),\n        \"lower left\": (-0.1, -0.1),\n        \"lower right\": (1.05, -0.1),\n    }\n\n    x, y = loc_map.get(loc, (-0.1, 1.1))\n\n    ax.text(\n        x,\n        y,\n        label,\n        transform=ax.transAxes,\n        fontsize=fontsize,\n        fontweight=fontweight,\n        va=\"top\",\n        ha=\"left\" if \"left\" in loc else \"right\",\n    )\n</code></pre>"},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization.add_scalebar","title":"add_scalebar","text":"<pre><code>add_scalebar(\n    ax: Axes,\n    length: float,\n    label: str,\n    loc: str = \"lower right\",\n    color: str = \"black\",\n    height_fraction: float = 0.02,\n) -&gt; None\n</code></pre> <p>\u6dfb\u52a0\u6bd4\u4f8b\u5c3a</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>ax</code> <code>Axes</code> <p>Axes \u5bf9\u8c61</p> \u5fc5\u9700 <code>length</code> <code>float</code> <p>\u6bd4\u4f8b\u5c3a\u957f\u5ea6\uff08\u6570\u636e\u5750\u6807\uff09</p> \u5fc5\u9700 <code>label</code> <code>str</code> <p>\u6807\u7b7e\u6587\u672c</p> \u5fc5\u9700 <code>loc</code> <code>str</code> <p>\u4f4d\u7f6e</p> <code>'lower right'</code> <code>color</code> <code>str</code> <p>\u989c\u8272</p> <code>'black'</code> <code>height_fraction</code> <code>float</code> <p>\u9ad8\u5ea6\u5360\u56fe\u9ad8\u7684\u6bd4\u4f8b</p> <code>0.02</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/styles.py</code> <pre><code>def add_scalebar(\n    ax: plt.Axes,\n    length: float,\n    label: str,\n    loc: str = \"lower right\",\n    color: str = \"black\",\n    height_fraction: float = 0.02,\n) -&gt; None:\n    \"\"\"\u6dfb\u52a0\u6bd4\u4f8b\u5c3a\n\n    Args:\n        ax: Axes \u5bf9\u8c61\n        length: \u6bd4\u4f8b\u5c3a\u957f\u5ea6\uff08\u6570\u636e\u5750\u6807\uff09\n        label: \u6807\u7b7e\u6587\u672c\n        loc: \u4f4d\u7f6e\n        color: \u989c\u8272\n        height_fraction: \u9ad8\u5ea6\u5360\u56fe\u9ad8\u7684\u6bd4\u4f8b\n    \"\"\"\n    import matplotlib.font_manager as fm\n    from mpl_toolkits.axes_grid1.anchored_artists import AnchoredSizeBar\n\n    fontprops = fm.FontProperties(size=7)\n    scalebar = AnchoredSizeBar(\n        ax.transData,\n        length,\n        label,\n        loc=loc,\n        pad=0.5,\n        color=color,\n        frameon=False,\n        size_vertical=ax.get_ylim()[1] * height_fraction,\n        fontproperties=fontprops,\n    )\n    ax.add_artist(scalebar)\n</code></pre>"},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization.add_significance_bracket","title":"add_significance_bracket","text":"<pre><code>add_significance_bracket(\n    ax: Axes,\n    x1: float,\n    x2: float,\n    y: float,\n    text: str = \"*\",\n    color: str = \"black\",\n    linewidth: float = 1.0,\n) -&gt; None\n</code></pre> <p>\u6dfb\u52a0\u663e\u8457\u6027\u6807\u8bb0\u62ec\u53f7</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>ax</code> <code>Axes</code> <p>Axes \u5bf9\u8c61</p> \u5fc5\u9700 <code>x1</code> <code>float</code> <p>\u62ec\u53f7\u8d77\u59cb X \u5750\u6807</p> \u5fc5\u9700 <code>x2</code> <code>float</code> <p>\u62ec\u53f7\u7ec8\u6b62 X \u5750\u6807</p> \u5fc5\u9700 <code>y</code> <code>float</code> <p>\u62ec\u53f7 Y \u5750\u6807</p> \u5fc5\u9700 <code>text</code> <code>str</code> <p>\u663e\u8457\u6027\u6807\u8bb0\uff08, , **\uff09</p> <code>'*'</code> <code>color</code> <code>str</code> <p>\u989c\u8272</p> <code>'black'</code> <code>linewidth</code> <code>float</code> <p>\u7ebf\u5bbd</p> <code>1.0</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/styles.py</code> <pre><code>def add_significance_bracket(\n    ax: plt.Axes,\n    x1: float,\n    x2: float,\n    y: float,\n    text: str = \"*\",\n    color: str = \"black\",\n    linewidth: float = 1.0,\n) -&gt; None:\n    \"\"\"\u6dfb\u52a0\u663e\u8457\u6027\u6807\u8bb0\u62ec\u53f7\n\n    Args:\n        ax: Axes \u5bf9\u8c61\n        x1: \u62ec\u53f7\u8d77\u59cb X \u5750\u6807\n        x2: \u62ec\u53f7\u7ec8\u6b62 X \u5750\u6807\n        y: \u62ec\u53f7 Y \u5750\u6807\n        text: \u663e\u8457\u6027\u6807\u8bb0\uff08*, **, ***\uff09\n        color: \u989c\u8272\n        linewidth: \u7ebf\u5bbd\n    \"\"\"\n    h = (ax.get_ylim()[1] - ax.get_ylim()[0]) * 0.02\n\n    ax.plot(\n        [x1, x1, x2, x2],\n        [y, y + h, y + h, y],\n        color=color,\n        linewidth=linewidth,\n        clip_on=False,\n    )\n    ax.text(\n        (x1 + x2) / 2, y + h, text, ha=\"center\", va=\"bottom\", fontsize=10, color=color\n    )\n</code></pre>"},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization.apply_nature_style","title":"apply_nature_style","text":"<pre><code>apply_nature_style(\n    config: Optional[VisualizationConfig] = None,\n) -&gt; None\n</code></pre> <p>\u5e94\u7528 Nature/Science \u671f\u520a\u98ce\u683c\u5230\u5168\u5c40 matplotlib \u8bbe\u7f6e</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>config</code> <code>Optional[VisualizationConfig]</code> <p>\u53ef\u89c6\u5316\u914d\u7f6e\uff0c\u9ed8\u8ba4\u4f7f\u7528 Nature \u98ce\u683c</p> <code>None</code> <p>\u793a\u4f8b\uff1a</p> <pre><code>&gt;&gt;&gt; from DASMatrix.visualization.styles import apply_nature_style\n&gt;&gt;&gt; apply_nature_style()\n&gt;&gt;&gt; # \u4e4b\u540e\u6240\u6709\u56fe\u8868\u90fd\u5c06\u4f7f\u7528 Nature \u98ce\u683c\n</code></pre> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/styles.py</code> <pre><code>def apply_nature_style(config: Optional[VisualizationConfig] = None) -&gt; None:\n    \"\"\"\u5e94\u7528 Nature/Science \u671f\u520a\u98ce\u683c\u5230\u5168\u5c40 matplotlib \u8bbe\u7f6e\n\n    Args:\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\uff0c\u9ed8\u8ba4\u4f7f\u7528 Nature \u98ce\u683c\n\n    Examples:\n        &gt;&gt;&gt; from DASMatrix.visualization.styles import apply_nature_style\n        &gt;&gt;&gt; apply_nature_style()\n        &gt;&gt;&gt; # \u4e4b\u540e\u6240\u6709\u56fe\u8868\u90fd\u5c06\u4f7f\u7528 Nature \u98ce\u683c\n    \"\"\"\n    if config is None:\n        config = VisualizationConfig()\n\n    # \u91cd\u7f6e\u4e3a\u9ed8\u8ba4\u6837\u5f0f\n    plt.style.use(\"default\")\n\n    # \u5e94\u7528\u914d\u7f6e\n    rcparams = config.get_rcparams()\n\n    # \u5904\u7406 prop_cycle\uff08\u9700\u8981\u7279\u6b8a\u5904\u7406\uff09\n    rcparams.pop(\"axes.prop_cycle\", None)\n    plt.rcParams.update(rcparams)\n\n    # \u8bbe\u7f6e\u989c\u8272\u5faa\u73af\n    plt.rcParams[\"axes.prop_cycle\"] = plt.cycler(\"color\", config.colors.primary)\n</code></pre>"},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization.create_figure","title":"create_figure","text":"<pre><code>create_figure(\n    size: Union[\n        FigureSize, Tuple[float, float], str\n    ] = FigureSize.SINGLE_COLUMN,\n    nrows: int = 1,\n    ncols: int = 1,\n    config: Optional[VisualizationConfig] = None,\n    **kwargs: Any,\n) -&gt; Tuple[plt.Figure, np.ndarray]\n</code></pre> <p>\u521b\u5efa\u671f\u520a\u7ea7\u522b\u7684\u56fe\u5f62</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>size</code> <code>Union[FigureSize, Tuple[float, float], str]</code> <p>\u56fe\u5f62\u5c3a\u5bf8\uff0c\u53ef\u4ee5\u662f FigureSize \u679a\u4e3e\u3001\u5143\u7ec4\u6216\u5b57\u7b26\u4e32</p> <code>SINGLE_COLUMN</code> <code>nrows</code> <code>int</code> <p>\u5b50\u56fe\u884c\u6570</p> <code>1</code> <code>ncols</code> <code>int</code> <p>\u5b50\u56fe\u5217\u6570</p> <code>1</code> <code>config</code> <code>Optional[VisualizationConfig]</code> <p>\u53ef\u89c6\u5316\u914d\u7f6e</p> <code>None</code> <code>**kwargs</code> <code>Any</code> <p>\u4f20\u9012\u7ed9 plt.subplots \u7684\u5176\u4ed6\u53c2\u6570</p> <code>{}</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>tuple</code> <code>Tuple[Figure, ndarray]</code> <p>(Figure, Axes)</p> <p>\u793a\u4f8b\uff1a</p> <pre><code>&gt;&gt;&gt; fig, ax = create_figure()\n&gt;&gt;&gt; fig, axes = create_figure(size=\"double\", nrows=2, ncols=2)\n</code></pre> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/styles.py</code> <pre><code>def create_figure(\n    size: Union[FigureSize, Tuple[float, float], str] = FigureSize.SINGLE_COLUMN,\n    nrows: int = 1,\n    ncols: int = 1,\n    config: Optional[VisualizationConfig] = None,\n    **kwargs: Any,\n) -&gt; Tuple[plt.Figure, np.ndarray]:\n    \"\"\"\u521b\u5efa\u671f\u520a\u7ea7\u522b\u7684\u56fe\u5f62\n\n    Args:\n        size: \u56fe\u5f62\u5c3a\u5bf8\uff0c\u53ef\u4ee5\u662f FigureSize \u679a\u4e3e\u3001\u5143\u7ec4\u6216\u5b57\u7b26\u4e32\n        nrows: \u5b50\u56fe\u884c\u6570\n        ncols: \u5b50\u56fe\u5217\u6570\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\n        **kwargs: \u4f20\u9012\u7ed9 plt.subplots \u7684\u5176\u4ed6\u53c2\u6570\n\n    Returns:\n        tuple: (Figure, Axes)\n\n    Examples:\n        &gt;&gt;&gt; fig, ax = create_figure()\n        &gt;&gt;&gt; fig, axes = create_figure(size=\"double\", nrows=2, ncols=2)\n    \"\"\"\n    if config is None:\n        config = VisualizationConfig()\n\n    apply_nature_style(config)\n\n    # \u89e3\u6790\u5c3a\u5bf8\n    if isinstance(size, FigureSize):\n        figsize = size.value\n    elif isinstance(size, str):\n        size_map = {\n            \"single\": FigureSize.SINGLE_COLUMN.value,\n            \"1.5\": FigureSize.ONE_HALF_COLUMN.value,\n            \"double\": FigureSize.DOUBLE_COLUMN.value,\n            \"full\": FigureSize.FULL_PAGE.value,\n            \"square\": FigureSize.SQUARE.value,\n            \"wide\": FigureSize.WIDE.value,\n        }\n        figsize = size_map.get(size.lower(), FigureSize.SINGLE_COLUMN.value)\n    else:\n        figsize = size\n\n    # \u8c03\u6574\u591a\u5b50\u56fe\u7684\u9ad8\u5ea6\n    if nrows &gt; 1:\n        figsize = (figsize[0], figsize[1] * nrows * 0.8)\n    if ncols &gt; 1:\n        figsize = (figsize[0] * ncols * 0.6, figsize[1])\n\n    fig, axes = plt.subplots(\n        nrows=nrows, ncols=ncols, figsize=figsize, constrained_layout=True, **kwargs\n    )\n\n    # \u786e\u4fdd axes \u59cb\u7ec8\u662f\u6570\u7ec4\n    if nrows == 1 and ncols == 1:\n        axes = np.array([axes])\n\n    return fig, axes\n</code></pre>"},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization.get_colors","title":"get_colors","text":"<pre><code>get_colors(\n    n: int, palette: Optional[ColorPalette] = None\n) -&gt; list\n</code></pre> <p>\u83b7\u53d6\u6307\u5b9a\u6570\u91cf\u7684\u989c\u8272</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>n</code> <code>int</code> <p>\u9700\u8981\u7684\u989c\u8272\u6570\u91cf</p> \u5fc5\u9700 <code>palette</code> <code>Optional[ColorPalette]</code> <p>\u914d\u8272\u65b9\u6848</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>list</code> <p>\u989c\u8272\u5217\u8868</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/styles.py</code> <pre><code>def get_colors(n: int, palette: Optional[ColorPalette] = None) -&gt; list:\n    \"\"\"\u83b7\u53d6\u6307\u5b9a\u6570\u91cf\u7684\u989c\u8272\n\n    Args:\n        n: \u9700\u8981\u7684\u989c\u8272\u6570\u91cf\n        palette: \u914d\u8272\u65b9\u6848\n\n    Returns:\n        \u989c\u8272\u5217\u8868\n    \"\"\"\n    if palette is None:\n        palette = ColorPalette()\n\n    if n &lt;= len(palette.primary):\n        return palette.primary[:n]\n    else:\n        # \u9700\u8981\u66f4\u591a\u989c\u8272\uff0c\u4f7f\u7528 colormap \u63d2\u503c\n        cmap = plt.cm.get_cmap(\"tab20\")\n        return [cmap(i / n) for i in range(n)]\n</code></pre>"},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization.nature_style","title":"nature_style","text":"<pre><code>nature_style(config: Optional[VisualizationConfig] = None)\n</code></pre> <p>Nature \u98ce\u683c\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>config</code> <code>Optional[VisualizationConfig]</code> <p>\u53ef\u89c6\u5316\u914d\u7f6e</p> <code>None</code> <p>\u793a\u4f8b\uff1a</p> <pre><code>&gt;&gt;&gt; with nature_style():\n...     fig, ax = plt.subplots()\n...     ax.plot(x, y)\n</code></pre> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/styles.py</code> <pre><code>@contextlib.contextmanager\ndef nature_style(config: Optional[VisualizationConfig] = None):\n    \"\"\"Nature \u98ce\u683c\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\n\n    Args:\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\n\n    Examples:\n        &gt;&gt;&gt; with nature_style():\n        ...     fig, ax = plt.subplots()\n        ...     ax.plot(x, y)\n    \"\"\"\n    if config is None:\n        config = VisualizationConfig()\n\n    # \u4fdd\u5b58\u5f53\u524d\u6837\u5f0f\n    old_rcparams = plt.rcParams.copy()\n\n    try:\n        apply_nature_style(config)\n        yield\n    finally:\n        # \u6062\u590d\u539f\u6837\u5f0f\n        plt.rcParams.update(old_rcparams)\n</code></pre>"},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization.save_figure","title":"save_figure","text":"<pre><code>save_figure(\n    fig: Figure,\n    filename: str,\n    formats: Tuple[str, ...] = (\"pdf\", \"png\"),\n    config: Optional[VisualizationConfig] = None,\n    **kwargs: Any,\n) -&gt; None\n</code></pre> <p>\u4fdd\u5b58\u56fe\u5f62\u4e3a\u591a\u79cd\u683c\u5f0f</p> <p>Nature \u8981\u6c42 PDF/EPS \u77e2\u91cf\u683c\u5f0f\uff0c\u540c\u65f6\u751f\u6210 PNG \u7528\u4e8e\u9884\u89c8\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>fig</code> <code>Figure</code> <p>Figure \u5bf9\u8c61</p> \u5fc5\u9700 <code>filename</code> <code>str</code> <p>\u6587\u4ef6\u540d\uff08\u4e0d\u542b\u6269\u5c55\u540d\uff09</p> \u5fc5\u9700 <code>formats</code> <code>Tuple[str, ...]</code> <p>\u8f93\u51fa\u683c\u5f0f\u5217\u8868</p> <code>('pdf', 'png')</code> <code>config</code> <code>Optional[VisualizationConfig]</code> <p>\u53ef\u89c6\u5316\u914d\u7f6e</p> <code>None</code> <code>**kwargs</code> <code>Any</code> <p>\u4f20\u9012\u7ed9 savefig \u7684\u5176\u4ed6\u53c2\u6570</p> <code>{}</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/styles.py</code> <pre><code>def save_figure(\n    fig: plt.Figure,\n    filename: str,\n    formats: Tuple[str, ...] = (\"pdf\", \"png\"),\n    config: Optional[VisualizationConfig] = None,\n    **kwargs: Any,\n) -&gt; None:\n    \"\"\"\u4fdd\u5b58\u56fe\u5f62\u4e3a\u591a\u79cd\u683c\u5f0f\n\n    Nature \u8981\u6c42 PDF/EPS \u77e2\u91cf\u683c\u5f0f\uff0c\u540c\u65f6\u751f\u6210 PNG \u7528\u4e8e\u9884\u89c8\u3002\n\n    Args:\n        fig: Figure \u5bf9\u8c61\n        filename: \u6587\u4ef6\u540d\uff08\u4e0d\u542b\u6269\u5c55\u540d\uff09\n        formats: \u8f93\u51fa\u683c\u5f0f\u5217\u8868\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\n        **kwargs: \u4f20\u9012\u7ed9 savefig \u7684\u5176\u4ed6\u53c2\u6570\n    \"\"\"\n    from pathlib import Path\n\n    if config is None:\n        config = VisualizationConfig()\n\n    filepath = Path(filename)\n    filepath.parent.mkdir(parents=True, exist_ok=True)\n\n    for fmt in formats:\n        dpi = config.dpi if fmt != \"pdf\" else 300  # PDF \u4f7f\u7528\u77e2\u91cf\uff0cDPI \u4e3b\u8981\u5f71\u54cd\u6805\u683c\u5143\u7d20\n        fig.savefig(\n            filepath.with_suffix(f\".{fmt}\"),\n            format=fmt,\n            dpi=dpi,\n            bbox_inches=\"tight\",\n            pad_inches=0.02,\n            facecolor=\"white\",\n            edgecolor=\"none\",\n            **kwargs,\n        )\n</code></pre>"},{"location":"reference/DASMatrix/visualization/#DASMatrix.visualization.setup_axis","title":"setup_axis","text":"<pre><code>setup_axis(\n    ax: Axes,\n    xlabel: Optional[str] = None,\n    ylabel: Optional[str] = None,\n    title: Optional[str] = None,\n    xlim: Optional[Tuple[float, float]] = None,\n    ylim: Optional[Tuple[float, float]] = None,\n    config: Optional[VisualizationConfig] = None,\n) -&gt; plt.Axes\n</code></pre> <p>\u914d\u7f6e\u5750\u6807\u8f74\u4e3a\u671f\u520a\u7ea7\u522b\u6837\u5f0f</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>ax</code> <code>Axes</code> <p>matplotlib Axes \u5bf9\u8c61</p> \u5fc5\u9700 <code>xlabel</code> <code>Optional[str]</code> <p>X\u8f74\u6807\u7b7e</p> <code>None</code> <code>ylabel</code> <code>Optional[str]</code> <p>Y\u8f74\u6807\u7b7e</p> <code>None</code> <code>title</code> <code>Optional[str]</code> <p>\u6807\u9898</p> <code>None</code> <code>xlim</code> <code>Optional[Tuple[float, float]]</code> <p>X\u8f74\u8303\u56f4</p> <code>None</code> <code>ylim</code> <code>Optional[Tuple[float, float]]</code> <p>Y\u8f74\u8303\u56f4</p> <code>None</code> <code>config</code> <code>Optional[VisualizationConfig]</code> <p>\u53ef\u89c6\u5316\u914d\u7f6e</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Axes</code> <p>\u914d\u7f6e\u540e\u7684 Axes \u5bf9\u8c61</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/styles.py</code> <pre><code>def setup_axis(\n    ax: plt.Axes,\n    xlabel: Optional[str] = None,\n    ylabel: Optional[str] = None,\n    title: Optional[str] = None,\n    xlim: Optional[Tuple[float, float]] = None,\n    ylim: Optional[Tuple[float, float]] = None,\n    config: Optional[VisualizationConfig] = None,\n) -&gt; plt.Axes:\n    \"\"\"\u914d\u7f6e\u5750\u6807\u8f74\u4e3a\u671f\u520a\u7ea7\u522b\u6837\u5f0f\n\n    Args:\n        ax: matplotlib Axes \u5bf9\u8c61\n        xlabel: X\u8f74\u6807\u7b7e\n        ylabel: Y\u8f74\u6807\u7b7e\n        title: \u6807\u9898\n        xlim: X\u8f74\u8303\u56f4\n        ylim: Y\u8f74\u8303\u56f4\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\n\n    Returns:\n        \u914d\u7f6e\u540e\u7684 Axes \u5bf9\u8c61\n    \"\"\"\n    if config is None:\n        config = VisualizationConfig()\n\n    # \u786e\u4fdd\u6240\u6709\u8fb9\u6846\u53ef\u89c1\u4e14\u6837\u5f0f\u4e00\u81f4\n    for spine in [\"top\", \"right\", \"bottom\", \"left\"]:\n        ax.spines[spine].set_visible(True)\n        ax.spines[spine].set_linewidth(config.spine_linewidth)\n        ax.spines[spine].set_color(config.colors.spine)\n\n    # \u8bbe\u7f6e\u523b\u5ea6\u65b9\u5411\u548c\u6837\u5f0f\n    ax.tick_params(\n        which=\"both\",\n        direction=config.tick_direction,\n        top=True,\n        right=True,\n        width=config.tick_major_width,\n        length=config.tick_major_size,\n    )\n\n    if config.show_minor_ticks:\n        ax.minorticks_on()\n        ax.tick_params(\n            which=\"minor\",\n            direction=config.tick_direction,\n            top=True,\n            right=True,\n            width=config.tick_minor_width,\n            length=config.tick_minor_size,\n        )\n\n    # \u8bbe\u7f6e\u6807\u7b7e\n    if xlabel:\n        ax.set_xlabel(xlabel, fontsize=config.typography.label)\n    if ylabel:\n        ax.set_ylabel(ylabel, fontsize=config.typography.label)\n    if title:\n        ax.set_title(title, fontsize=config.typography.title, fontweight=\"bold\")\n\n    # \u8bbe\u7f6e\u8303\u56f4\n    if xlim:\n        ax.set_xlim(xlim)\n    if ylim:\n        ax.set_ylim(ylim)\n\n    return ax\n</code></pre>"},{"location":"reference/DASMatrix/visualization/das_visualizer/","title":"das_visualizer","text":""},{"location":"reference/DASMatrix/visualization/das_visualizer/#DASMatrix.visualization.das_visualizer","title":"das_visualizer","text":""},{"location":"reference/DASMatrix/visualization/das_visualizer/#DASMatrix.visualization.das_visualizer.PlotBase","title":"PlotBase","text":"<pre><code>PlotBase(config: Optional[VisualizationConfig] = None)\n</code></pre> <p>               Bases: <code>ABC</code></p> <p>\u7ed8\u56fe\u57fa\u7c7b</p> <p>\u521d\u59cb\u5316\u7ed8\u56fe\u57fa\u7c7b</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>config</code> <code>Optional[VisualizationConfig]</code> <p>\u53ef\u89c6\u5316\u914d\u7f6e\uff0c\u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def __init__(self, config: Optional[VisualizationConfig] = None):\n    \"\"\"\u521d\u59cb\u5316\u7ed8\u56fe\u57fa\u7c7b\n\n    Args:\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\uff0c\u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\n    \"\"\"\n    self.config = config or VisualizationConfig()\n    self.logger = logging.getLogger(__name__)\n    self._setup_style()\n</code></pre>"},{"location":"reference/DASMatrix/visualization/das_visualizer/#DASMatrix.visualization.das_visualizer.PlotBase.save_figure","title":"save_figure","text":"<pre><code>save_figure(\n    file_path: Union[str, Path],\n    close_after_save: bool = True,\n) -&gt; None\n</code></pre> <p>\u4fdd\u5b58\u56fe\u5f62\u5230\u6307\u5b9a\u8def\u5f84</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>file_path</code> <code>Union[str, Path]</code> <p>\u56fe\u5f62\u4fdd\u5b58\u8def\u5f84</p> \u5fc5\u9700 <code>close_after_save</code> <code>bool</code> <p>\u4fdd\u5b58\u540e\u662f\u5426\u5173\u95ed\u56fe\u5f62</p> <code>True</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def save_figure(\n    self, file_path: Union[str, Path], close_after_save: bool = True\n) -&gt; None:\n    \"\"\"\u4fdd\u5b58\u56fe\u5f62\u5230\u6307\u5b9a\u8def\u5f84\n\n    Args:\n        file_path: \u56fe\u5f62\u4fdd\u5b58\u8def\u5f84\n        close_after_save: \u4fdd\u5b58\u540e\u662f\u5426\u5173\u95ed\u56fe\u5f62\n    \"\"\"\n    # \u5ef6\u8fdf\u5bfc\u5165 matplotlib\n    import matplotlib.pyplot as plt\n\n    try:\n        # \u786e\u4fdd\u76ee\u5f55\u5b58\u5728\n        if isinstance(file_path, str):\n            file_path = Path(file_path)\n\n        file_path.parent.mkdir(parents=True, exist_ok=True)\n\n        plt.savefig(\n            file_path,\n            bbox_inches=\"tight\",\n            dpi=self.config.dpi,\n        )\n        self.logger.debug(f\"Figure saved to {file_path}\")\n\n        if close_after_save:\n            plt.close()\n    except Exception as e:\n        self.logger.error(f\"Error saving figure: {e}\")\n        if close_after_save:\n            plt.close()\n</code></pre>"},{"location":"reference/DASMatrix/visualization/das_visualizer/#DASMatrix.visualization.das_visualizer.SpectrumPlot","title":"SpectrumPlot","text":"<pre><code>SpectrumPlot(config: Optional[VisualizationConfig] = None)\n</code></pre> <p>               Bases: <code>PlotBase</code></p> <p>\u9891\u8c31\u56fe (Spectrum Plot)</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def __init__(self, config: Optional[VisualizationConfig] = None):\n    \"\"\"\u521d\u59cb\u5316\u7ed8\u56fe\u57fa\u7c7b\n\n    Args:\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\uff0c\u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\n    \"\"\"\n    self.config = config or VisualizationConfig()\n    self.logger = logging.getLogger(__name__)\n    self._setup_style()\n</code></pre>"},{"location":"reference/DASMatrix/visualization/das_visualizer/#DASMatrix.visualization.das_visualizer.SpectrumPlot.plot","title":"plot","text":"<pre><code>plot(\n    frequencies: ndarray,\n    magnitudes: ndarray,\n    channel_id: Optional[Union[int, str]] = None,\n    excitation_freq: Optional[float] = None,\n    title: Optional[str] = None,\n    peaks: Optional[List[Dict[str, float]]] = None,\n    db_range: Optional[Tuple[float, float]] = None,\n    ax: Optional[Axes] = None,\n) -&gt; Any\n</code></pre> <p>\u7ed8\u5236\u9891\u8c31\u56fe</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>frequencies</code> <code>ndarray</code> <p>\u9891\u7387\u6570\u7ec4 (Hz)</p> \u5fc5\u9700 <code>magnitudes</code> <code>ndarray</code> <p>\u9891\u8c31\u5e45\u503c\u6570\u7ec4 (\u901a\u5e38\u662f\u5bf9\u6570\u5c3a\u5ea6\uff0c\u5982 dB)</p> \u5fc5\u9700 <code>channel_id</code> <code>Optional[Union[int, str]]</code> <p>\u53ef\u9009\uff0c\u901a\u9053\u6807\u8bc6</p> <code>None</code> <code>excitation_freq</code> <code>Optional[float]</code> <p>(\u53ef\u9009) \u6fc0\u52b1\u9891\u7387\uff0c\u7528\u4e8e\u5728\u56fe\u4e0a\u6807\u8bb0 (Hz)</p> <code>None</code> <code>title</code> <code>Optional[str]</code> <p>\u81ea\u5b9a\u4e49\u6807\u9898 (\u82f1\u6587), \u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u6807\u9898</p> <code>None</code> <code>peaks</code> <code>Optional[List[Dict[str, float]]]</code> <p>(\u53ef\u9009) \u5cf0\u503c\u5217\u8868\uff0c\u6bcf\u4e2a\u5cf0\u503c\u5305\u542b 'frequency' \u548c 'magnitude'</p> <code>None</code> <code>db_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0cdB\u503c\u663e\u793a\u8303\u56f4 (min_db, max_db)</p> <code>None</code> <code>ax</code> <code>Optional[Axes]</code> <p>\u53ef\u9009\u7684 Axes \u5bf9\u8c61</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Figure</code> <code>Any</code> <p>matplotlib \u56fe\u5f62\u5bf9\u8c61</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def plot(\n    self,\n    frequencies: np.ndarray,\n    magnitudes: np.ndarray,\n    channel_id: Optional[Union[int, str]] = None,\n    excitation_freq: Optional[float] = None,\n    title: Optional[str] = None,\n    peaks: Optional[List[Dict[str, float]]] = None,\n    db_range: Optional[Tuple[float, float]] = None,\n    ax: Optional[plt.Axes] = None,\n) -&gt; Any:  # \u8fd4\u56de\u7c7b\u578b\u6539\u4e3a Any\n    \"\"\"\u7ed8\u5236\u9891\u8c31\u56fe\n\n    Args:\n        frequencies: \u9891\u7387\u6570\u7ec4 (Hz)\n        magnitudes: \u9891\u8c31\u5e45\u503c\u6570\u7ec4 (\u901a\u5e38\u662f\u5bf9\u6570\u5c3a\u5ea6\uff0c\u5982 dB)\n        channel_id: \u53ef\u9009\uff0c\u901a\u9053\u6807\u8bc6\n        excitation_freq: (\u53ef\u9009) \u6fc0\u52b1\u9891\u7387\uff0c\u7528\u4e8e\u5728\u56fe\u4e0a\u6807\u8bb0 (Hz)\n        title: \u81ea\u5b9a\u4e49\u6807\u9898 (\u82f1\u6587), \u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u6807\u9898\n        peaks: (\u53ef\u9009) \u5cf0\u503c\u5217\u8868\uff0c\u6bcf\u4e2a\u5cf0\u503c\u5305\u542b 'frequency' \u548c 'magnitude'\n        db_range: \u53ef\u9009\uff0cdB\u503c\u663e\u793a\u8303\u56f4 (min_db, max_db)\n        ax: \u53ef\u9009\u7684 Axes \u5bf9\u8c61\n\n    Returns:\n        Figure: matplotlib \u56fe\u5f62\u5bf9\u8c61\n    \"\"\"\n\n    # \u6027\u80fd\u4f18\u5316\uff1a\u5982\u679c\u9891\u7387\u70b9\u6570\u8fc7\u591a\uff0c\u8fdb\u884c\u964d\u91c7\u6837\n    MAX_FREQ_POINTS = 10000\n    if len(frequencies) &gt; MAX_FREQ_POINTS:\n        step = len(frequencies) // MAX_FREQ_POINTS\n        frequencies = frequencies[::step]\n        magnitudes = magnitudes[::step]\n\n    # \u521b\u5efa\u56fe\u5f62\u548c\u5750\u6807\u8f74 - \u4f18\u5316\u521b\u5efa\u8fc7\u7a0b\n    if ax is None:\n        fig, ax = plt.subplots(figsize=self.config.figsize_standard)\n    else:\n        fig = ax.figure  # type: ignore\n\n    # \u6027\u80fd\u4f18\u5316\uff1a\u63d0\u524d\u8ba1\u7b97dB\u503c\uff0c\u907f\u514d\u91cd\u590d\u8ba1\u7b97\n    # \u5e45\u503c\u901a\u5e38\u4ee5 dB \u663e\u793a\n    magnitudes_db = 10 * np.log10(magnitudes + 1e-12)  # \u52a0\u4e00\u4e2a\u5c0f\u503c\u907f\u514d log(0)\n\n    # \u7ed8\u5236\u9891\u8c31 - \u4f7f\u7528\u66f4\u9ad8\u6027\u80fd\u7684\u7ed8\u56fe\u8bbe\u7f6e\n    ax.plot(\n        frequencies,\n        magnitudes_db,\n        linewidth=1.0,  # \u51cf\u5c0f\u7ebf\u5bbd\u4ee5\u52a0\u5feb\u6e32\u67d3\n        color=\"#0072B2\",\n        alpha=1.0,\n        zorder=5,\n        rasterized=True,  # \u5149\u6805\u5316\u4ee5\u63d0\u9ad8\u6027\u80fd\n    )\n\n    # \u6807\u8bb0\u5cf0\u503c\uff08\u5982\u679c\u63d0\u4f9b\uff09- \u53ea\u5728\u786e\u5b9e\u9700\u8981\u65f6\u6267\u884c\n    if peaks and len(peaks) &gt; 0:\n        peak_freqs = [p[\"frequency\"] for p in peaks]\n        peak_mags = [10 * np.log10(p[\"magnitude\"] + 1e-12) for p in peaks]\n        ax.plot(\n            peak_freqs,\n            peak_mags,\n            \"o\",\n            color=\"#D55E00\",\n            markersize=5,\n            markeredgewidth=1.0,\n            markeredgecolor=\"black\",\n            alpha=1.0,\n            zorder=10,\n            label=\"Peak Frequencies\",\n        )\n\n        # \u4e3a\u524d\u4e09\u4e2a\u5cf0\u6dfb\u52a0\u6807\u7b7e - \u4ec5\u5904\u7406\u4e00\u5c0f\u90e8\u5206\u5cf0\u503c\n        for i, (f, m) in enumerate(\n            zip(\n                peak_freqs[: min(3, len(peak_freqs))],\n                peak_mags[: min(3, len(peak_mags))],\n            )\n        ):\n            ax.annotate(\n                f\"{f:.1f} Hz\",\n                xy=(f, m),\n                xytext=(5, 5),\n                textcoords=\"offset points\",\n                fontsize=9,\n                fontweight=\"bold\",\n                bbox=dict(\n                    boxstyle=\"round,pad=0.3\", fc=\"white\", ec=\"black\", alpha=0.9\n                ),\n            )\n\n    # \u6807\u8bb0\u6fc0\u52b1\u9891\u7387 - \u53ea\u5728\u786e\u5b9e\u9700\u8981\u65f6\u6267\u884c\n    if excitation_freq is not None:\n        # \u4ee5\u6fc0\u52b1\u9891\u7387\u4e3a\u4e2d\u5fc3\uff0c\u7a97\u53e3\u5927\u5c0f\u53d6\u51b3\u4e8e\u6570\u636e\u8303\u56f4\n        data_range = np.max(frequencies) - np.min(frequencies)\n        window_size = min(data_range * 0.4, excitation_freq * 0.6)\n\n        # \u6027\u80fd\u4f18\u5316\uff1a\u907f\u514d\u591a\u6b21\u8c03\u7528set_xlim\n        ax.set_xlim(\n            max(0, excitation_freq - window_size), excitation_freq + window_size\n        )\n\n        # \u6dfb\u52a0\u5782\u76f4\u7ebf\u6807\u8bb0\u6fc0\u52b1\u9891\u7387\n        ax.axvline(\n            excitation_freq,\n            color=\"#D55E00\",\n            linestyle=\"--\",\n            linewidth=1.5,\n            alpha=0.7,\n            zorder=6,\n            label=f\"Excitation: {excitation_freq:.1f} Hz\",\n        )\n\n    # \u8bbe\u7f6e\u7f51\u683c - \u7b80\u5316\u7f51\u683c\u8bbe\u7f6e\u4ee5\u63d0\u9ad8\u6027\u80fd\n    ax.grid(True, which=\"major\", linestyle=\"--\", alpha=0.5, zorder=1)\n\n    # \u7981\u7528\u6b21\u523b\u5ea6\u4ee5\u63d0\u9ad8\u6027\u80fd\n    plt.minorticks_off()\n\n    # \u6539\u5584x\u8f74\u523b\u5ea6\u683c\u5f0f - \u7b80\u5316\u523b\u5ea6\u5904\u7406\n    if max(frequencies) &gt; 1000:\n        ax.xaxis.set_major_formatter(\n            ticker.FuncFormatter(\n                lambda x, pos: f\"{x / 1000:.0f}\" if x &gt;= 1000 else f\"{x:.0f}\"\n            )\n        )\n        ax.set_xlabel(\"Frequency (kHz)\")\n    else:\n        ax.set_xlabel(\"Frequency (Hz)\")\n\n    ax.set_ylabel(\"Magnitude (dB)\")\n\n    # \u56fe\u4f8b\u8bbe\u7f6e\uff08\u5982\u679c\u6709\u9700\u8981\u7684\u8bdd\uff09\n    if (excitation_freq is not None or peaks) and ax.get_legend_handles_labels()[0]:\n        leg = ax.legend(\n            loc=\"best\", frameon=True, framealpha=0.9, fontsize=9, edgecolor=\"black\"\n        )\n        # \u7b80\u5316\u56fe\u4f8b\u6837\u5f0f\u8bbe\u7f6e\n        for line in leg.get_lines():\n            line.set_linewidth(2.0)\n\n    # \u4f7f\u7528\u81ea\u5b9a\u4e49\u6807\u9898\u6216\u9ed8\u8ba4\u6807\u9898\n    if title:\n        plot_title = title\n    elif excitation_freq and channel_id is not None:\n        plot_title = (\n            f\"Spectrum for Channel {channel_id} around {excitation_freq:.1f} Hz\"\n        )\n    elif excitation_freq:\n        plot_title = f\"Spectrum around {excitation_freq:.1f} Hz\"\n    elif channel_id is not None:\n        plot_title = f\"Spectrum for Channel {channel_id}\"\n    else:\n        plot_title = \"Spectrum\"\n    ax.set_title(plot_title, fontweight=\"bold\")\n\n    # \u8bbe\u7f6ey\u8f74\u8303\u56f4\n    if db_range is not None:\n        # \u5982\u679c\u63d0\u4f9b\u4e86dB\u8303\u56f4\uff0c\u76f4\u63a5\u4f7f\u7528\n        ax.set_ylim(db_range)\n    else:\n        # \u6027\u80fd\u4f18\u5316\uff1a\u76f4\u63a5\u4f7f\u7528\u6570\u636e\u8303\u56f4\u8bbe\u7f6ey\u8f74\u8303\u56f4\uff0c\u907f\u514d\u989d\u5916\u8ba1\u7b97\n        ymin = np.min(magnitudes_db)\n        ymax = np.max(magnitudes_db)\n        y_range = ymax - ymin\n        ax.set_ylim(ymin - 0.05 * y_range, ymax + 0.05 * y_range)\n\n    # \u81ea\u52a8\u8c03\u6574\u5e03\u5c40\n    fig.tight_layout()\n\n    return fig\n</code></pre>"},{"location":"reference/DASMatrix/visualization/das_visualizer/#DASMatrix.visualization.das_visualizer.WaveformPlot","title":"WaveformPlot","text":"<pre><code>WaveformPlot(config: Optional[VisualizationConfig] = None)\n</code></pre> <p>               Bases: <code>PlotBase</code></p> <p>\u65f6\u57df\u6ce2\u5f62\u56fe (Time Domain Waveform Plot)</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def __init__(self, config: Optional[VisualizationConfig] = None):\n    \"\"\"\u521d\u59cb\u5316\u7ed8\u56fe\u57fa\u7c7b\n\n    Args:\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\uff0c\u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\n    \"\"\"\n    self.config = config or VisualizationConfig()\n    self.logger = logging.getLogger(__name__)\n    self._setup_style()\n</code></pre>"},{"location":"reference/DASMatrix/visualization/das_visualizer/#DASMatrix.visualization.das_visualizer.WaveformPlot.plot","title":"plot","text":"<pre><code>plot(\n    amplitude_data: ndarray,\n    fs: float,\n    time_range: Optional[Tuple[float, float]] = None,\n    amplitude_range: Optional[Tuple[float, float]] = None,\n    title: Optional[str] = None,\n    highlight_regions: Optional[\n        List[Tuple[float, float]]\n    ] = None,\n    ax: Optional[Axes] = None,\n) -&gt; Any\n</code></pre> <p>\u7ed8\u5236\u65f6\u57df\u6ce2\u5f62\u56fe</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>amplitude_data</code> <code>ndarray</code> <p>\u5e45\u503c\u6570\u7ec4</p> \u5fc5\u9700 <code>fs</code> <code>float</code> <p>\u91c7\u6837\u9891\u7387 (Hz)</p> \u5fc5\u9700 <code>amplitude_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0c\u5e45\u503c\u663e\u793a\u8303\u56f4 (min_amplitude, max_amplitude)</p> <code>None</code> <code>time_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0c\u65f6\u95f4\u663e\u793a\u8303\u56f4 (start_time, end_time)</p> <code>None</code> <code>title</code> <code>Optional[str]</code> <p>\u81ea\u5b9a\u4e49\u6807\u9898 (\u82f1\u6587), \u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u6807\u9898</p> <code>None</code> <code>highlight_regions</code> <code>Optional[List[Tuple[float, float]]]</code> <p>\u53ef\u9009\u7684\u9ad8\u4eae\u533a\u57df\u5217\u8868\uff0c\u6bcf\u4e2a\u5143\u7d20\u4e3a(\u5f00\u59cb\u65f6\u95f4, \u7ed3\u675f\u65f6\u95f4)\u5143\u7ec4</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Figure</code> <code>Any</code> <p>matplotlib \u56fe\u5f62\u5bf9\u8c61</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def plot(\n    self,\n    amplitude_data: np.ndarray,\n    fs: float,\n    time_range: Optional[Tuple[float, float]] = None,\n    amplitude_range: Optional[Tuple[float, float]] = None,\n    title: Optional[str] = None,\n    highlight_regions: Optional[List[Tuple[float, float]]] = None,\n    ax: Optional[plt.Axes] = None,\n) -&gt; Any:  # \u8fd4\u56de\u7c7b\u578b\u6539\u4e3a Any\n    \"\"\"\u7ed8\u5236\u65f6\u57df\u6ce2\u5f62\u56fe\n\n    Args:\n        amplitude_data: \u5e45\u503c\u6570\u7ec4\n        fs: \u91c7\u6837\u9891\u7387 (Hz)\n        amplitude_range: \u53ef\u9009\uff0c\u5e45\u503c\u663e\u793a\u8303\u56f4 (min_amplitude, max_amplitude)\n        time_range: \u53ef\u9009\uff0c\u65f6\u95f4\u663e\u793a\u8303\u56f4 (start_time, end_time)\n        title: \u81ea\u5b9a\u4e49\u6807\u9898 (\u82f1\u6587), \u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u6807\u9898\n        highlight_regions: \u53ef\u9009\u7684\u9ad8\u4eae\u533a\u57df\u5217\u8868\uff0c\u6bcf\u4e2a\u5143\u7d20\u4e3a(\u5f00\u59cb\u65f6\u95f4, \u7ed3\u675f\u65f6\u95f4)\u5143\u7ec4\n\n    Returns:\n        Figure: matplotlib \u56fe\u5f62\u5bf9\u8c61\n    \"\"\"\n    # \u5ef6\u8fdf\u5bfc\u5165 matplotlib\n    import matplotlib.pyplot as plt\n    import matplotlib.ticker as ticker\n\n    # \u6839\u636e\u91c7\u6837\u7387\u81ea\u52a8\u751f\u6210\u65f6\u95f4\u6570\u7ec4\n    num_samples = len(amplitude_data)\n    time_data = np.linspace(0, num_samples / fs, num_samples, endpoint=False)\n\n    # \u6027\u80fd\u4f18\u5316\uff1a\u5bf9\u5927\u6570\u636e\u8fdb\u884c\u964d\u91c7\u6837\uff0c\u53ea\u5728\u65f6\u57df\u7ed8\u56fe\u4e2d\u4f7f\u7528\n    # \u5bf9\u4e8e\u5927\u4e8e10\u4e07\u70b9\u7684\u6570\u636e\u8fdb\u884c\u667a\u80fd\u964d\u91c7\u6837\n    MAX_POINTS_TO_PLOT = 10000  # \u6700\u5927\u7ed8\u5236\u70b9\u6570\u9608\u503c\uff0c\u8d85\u8fc7\u6b64\u503c\u8fdb\u884c\u964d\u91c7\u6837\n\n    # \u5982\u679c\u6307\u5b9a\u4e86\u65f6\u95f4\u8303\u56f4\uff0c\u5148\u8fc7\u6ee4\u6570\u636e\n    if time_range is not None:\n        start_time, end_time = time_range\n        mask = (time_data &gt;= start_time) &amp; (time_data &lt;= end_time)\n        time_data = time_data[mask]\n        amplitude_data = amplitude_data[mask]\n\n    if len(amplitude_data) &gt; MAX_POINTS_TO_PLOT:\n        # \u4f7f\u7528\u5747\u5300\u964d\u91c7\u6837\n        step = len(amplitude_data) // MAX_POINTS_TO_PLOT\n        # \u786e\u4fdd\u6355\u83b7\u6700\u5927\u548c\u6700\u5c0f\u503c\uff0c\u5bf9\u53ef\u89c6\u5316\u975e\u5e38\u91cd\u8981\n        plot_time_data = time_data[::step]\n        plot_amplitude_data = amplitude_data[::step]\n\n        # \u4e3a\u4e86\u786e\u4fdd\u4e0d\u9519\u8fc7\u6781\u503c\u70b9\uff0c\u5728\u6bcf\u4e00\u6bb5\u4e2d\u67e5\u627e\u6700\u5927\u503c\u548c\u6700\u5c0f\u503c\u70b9\n        if step &gt; 2:  # \u53ea\u6709\u5f53\u964d\u91c7\u6837\u6bd4\u4f8b\u8f83\u5927\u65f6\u624d\u8fdb\u884c\u6781\u503c\u4fdd\u7559\n            max_vals = []\n            min_vals = []\n            max_times = []\n            min_times = []\n\n            for i in range(0, len(amplitude_data), step):\n                chunk = amplitude_data[i : i + step]\n                if len(chunk) &gt; 0:\n                    max_idx = np.argmax(chunk) + i\n                    min_idx = np.argmin(chunk) + i\n                    max_vals.append(amplitude_data[max_idx])\n                    min_vals.append(amplitude_data[min_idx])\n                    max_times.append(time_data[max_idx])\n                    min_times.append(time_data[min_idx])\n\n            # \u5408\u5e76\u5747\u5300\u91c7\u6837\u70b9\u548c\u6781\u503c\u70b9\n            plot_time_data = np.concatenate(\n                [\n                    plot_time_data,\n                    np.array(max_times),\n                    np.array(min_times),\n                ]\n            )\n            plot_amplitude_data = np.concatenate(\n                [\n                    plot_amplitude_data,\n                    np.array(max_vals),\n                    np.array(min_vals),\n                ]\n            )\n\n            # \u6309\u65f6\u95f4\u6392\u5e8f\n            sort_idx = np.argsort(plot_time_data)\n            plot_time_data = plot_time_data[sort_idx]\n            plot_amplitude_data = plot_amplitude_data[sort_idx]\n    else:\n        plot_time_data = time_data\n        plot_amplitude_data = amplitude_data\n\n    # \u521b\u5efa\u5177\u6709\u9ec4\u91d1\u6bd4\u4f8b\u7684\u56fe\u5f62 - \u4f18\u5316\u56fe\u5f62\u521b\u5efa\u8fc7\u7a0b\n    if ax is None:\n        fig, ax = plt.subplots(figsize=self.config.figsize_wide)\n    else:\n        fig = ax.figure  # type: ignore\n\n    # \u7ed8\u5236\u6ce2\u5f62 - \u76f4\u63a5\u7ed8\u5236\uff0c\u65e0\u9700\u8ba1\u7b97\u7edf\u8ba1\u4fe1\u606f\n    # \u6027\u80fd\u4f18\u5316\uff1a\u4f7f\u7528\u66f4\u9ad8\u6548\u7684\u7ebf\u6761\u6e32\u67d3\uff0c\u51cf\u5c11\u4e2d\u95f4\u8ba1\u7b97\n    (line,) = ax.plot(\n        plot_time_data,\n        plot_amplitude_data,\n        color=\"#0072B2\",\n        linewidth=1.0,\n        alpha=0.9,\n        zorder=5,\n        rasterized=True,  # \u5149\u6805\u5316\u53ef\u663e\u8457\u63d0\u9ad8\u5927\u91cf\u6570\u636e\u70b9\u7684\u6e32\u67d3\u6027\u80fd\n    )\n\n    # \u6dfb\u52a0\u9ad8\u4eae\u533a\u57df\uff08\u5982\u679c\u6709\uff09- \u53ea\u6709\u5728\u786e\u5b9e\u9700\u8981\u65f6\u624d\u6267\u884c\n    if highlight_regions:\n        for i, (start, end) in enumerate(highlight_regions):\n            ax.axvspan(\n                start,\n                end,\n                alpha=0.2,\n                color=plt.cm.get_cmap(\"tab10\")(i % 10),\n                zorder=2,\n            )\n            # \u6dfb\u52a0\u533a\u57df\u6807\u7b7e\n            mid_point = (start + end) / 2\n            ax.annotate(\n                f\"Region {i + 1}\",\n                xy=(mid_point, ax.get_ylim()[1] * 0.9),\n                ha=\"center\",\n                fontsize=9,\n                fontweight=\"bold\",\n                bbox=dict(\n                    boxstyle=\"round,pad=0.2\", fc=\"white\", ec=\"gray\", alpha=0.8\n                ),\n            )\n\n    # \u8bbe\u7f6e\u7f51\u683c - \u7b80\u5316\u7f51\u683c\u6837\u5f0f\n    ax.grid(True, which=\"major\", linestyle=\"--\", alpha=0.4, zorder=1)\n\n    # \u8ba1\u7b97\u5e76\u6807\u8bb0\u96f6\u7ebf\n    ax.axhline(\n        y=0, color=\"black\", linestyle=\"-\", linewidth=0.8, alpha=0.5, zorder=3\n    )\n\n    # \u8bbe\u7f6ey\u8f74\u8303\u56f4\n    if amplitude_range is not None:\n        # \u5982\u679c\u63d0\u4f9b\u4e86\u5e45\u503c\u8303\u56f4\uff0c\u76f4\u63a5\u4f7f\u7528\n        ax.set_ylim(amplitude_range)\n    else:\n        # \u6027\u80fd\u4f18\u5316\uff1a\u76f4\u63a5\u4f7f\u7528\u6570\u636e\u7684\u6700\u5c0f\u6700\u5927\u503c\u8bbe\u7f6ey\u8f74\u8303\u56f4\uff0c\u907f\u514d\u989d\u5916\u8ba1\u7b97\n        y_min, y_max = np.min(plot_amplitude_data), np.max(plot_amplitude_data)\n        y_range = y_max - y_min\n        ax.set_ylim(y_min - 0.1 * y_range, y_max + 0.1 * y_range)\n\n    # \u8bbe\u7f6ex\u8f74\u8303\u56f4\uff08\u5982\u679c\u63d0\u4f9b\u4e86time_range\u4f46\u6ca1\u6709\u8fc7\u6ee4\u6570\u636e\uff09\n    if time_range is not None and not (\n        time_data[0] &gt;= time_range[0] and time_data[-1] &lt;= time_range[1]\n    ):\n        ax.set_xlim(time_range)\n\n    # \u4f18\u5316\u5750\u6807\u8f74\n    ax.set_xlabel(\"Time (s)\")\n    ax.set_ylabel(\"Amplitude\")\n\n    # \u7b80\u5316\u65f6\u95f4\u523b\u5ea6\u683c\u5f0f\n    if max(plot_time_data) - min(plot_time_data) &gt; 60:\n        # \u8d85\u8fc760\u79d2\uff0c\u4ee5\u5206:\u79d2\u663e\u793a\n        ax.xaxis.set_major_formatter(\n            ticker.FuncFormatter(\n                lambda x, pos: f\"{int(x / 60)}:{int(x % 60):02d}\"\n                if x &gt;= 60\n                else f\"{int(x)}\"\n            )\n        )\n        ax.set_xlabel(\"Time (min:sec)\")\n\n    # \u4f7f\u7528\u81ea\u5b9a\u4e49\u6807\u9898\u6216\u9ed8\u8ba4\u6807\u9898\n    if title:\n        plot_title = title\n    else:\n        plot_title = \"Time Domain Waveform\"\n    ax.set_title(plot_title, fontweight=\"bold\")\n\n    # \u7981\u7528\u4e0d\u5fc5\u8981\u7684\u523b\u5ea6\uff0c\u63d0\u9ad8\u6027\u80fd\n    plt.minorticks_off()\n\n    # \u81ea\u52a8\u8c03\u6574\u5e03\u5c40\n    fig.tight_layout()\n\n    return fig\n</code></pre>"},{"location":"reference/DASMatrix/visualization/das_visualizer/#DASMatrix.visualization.das_visualizer.SpectrogramPlot","title":"SpectrogramPlot","text":"<pre><code>SpectrogramPlot(\n    config: Optional[VisualizationConfig] = None,\n)\n</code></pre> <p>               Bases: <code>PlotBase</code></p> <p>\u65f6\u9891\u56fe/\u9891\u8c31\u56fe (STFT) \u7ed8\u56fe\u7c7b</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def __init__(self, config: Optional[VisualizationConfig] = None):\n    \"\"\"\u521d\u59cb\u5316\u7ed8\u56fe\u57fa\u7c7b\n\n    Args:\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\uff0c\u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\n    \"\"\"\n    self.config = config or VisualizationConfig()\n    self.logger = logging.getLogger(__name__)\n    self._setup_style()\n</code></pre>"},{"location":"reference/DASMatrix/visualization/das_visualizer/#DASMatrix.visualization.das_visualizer.SpectrogramPlot.plot","title":"plot","text":"<pre><code>plot(\n    data: ndarray,\n    fs: float,\n    window_size: int = 1024,\n    overlap: float = 0.75,\n    title: Optional[str] = None,\n    freq_range: Optional[Tuple[float, float]] = None,\n    time_range: Optional[Tuple[float, float]] = None,\n    cmap: str = \"inferno\",\n    ax: Optional[Axes] = None,\n) -&gt; Any\n</code></pre> <p>\u7ed8\u5236\u65f6\u9891\u8c31\u56fe\uff08\u77ed\u65f6\u5085\u91cc\u53f6\u53d8\u6362\uff09</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u65f6\u57df\u4fe1\u53f7\u6570\u636e</p> \u5fc5\u9700 <code>fs</code> <code>float</code> <p>\u91c7\u6837\u9891\u7387 (Hz)</p> \u5fc5\u9700 <code>window_size</code> <code>int</code> <p>STFT\u7a97\u53e3\u5927\u5c0f</p> <code>1024</code> <code>overlap</code> <code>float</code> <p>\u7a97\u53e3\u91cd\u53e0\u6bd4\u4f8b</p> <code>0.75</code> <code>title</code> <code>Optional[str]</code> <p>\u81ea\u5b9a\u4e49\u6807\u9898</p> <code>None</code> <code>freq_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0c\u9891\u7387\u8303\u56f4 (min_freq, max_freq)</p> <code>None</code> <code>time_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0c\u65f6\u95f4\u8303\u56f4 (start_time, end_time)</p> <code>None</code> <code>cmap</code> <code>str</code> <p>\u8272\u5f69\u6620\u5c04\u540d\u79f0</p> <code>'inferno'</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Figure</code> <code>Any</code> <p>matplotlib \u56fe\u5f62\u5bf9\u8c61</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def plot(\n    self,\n    data: np.ndarray,\n    fs: float,\n    window_size: int = 1024,\n    overlap: float = 0.75,\n    title: Optional[str] = None,\n    freq_range: Optional[Tuple[float, float]] = None,\n    time_range: Optional[Tuple[float, float]] = None,\n    cmap: str = \"inferno\",\n    ax: Optional[plt.Axes] = None,\n) -&gt; Any:\n    \"\"\"\u7ed8\u5236\u65f6\u9891\u8c31\u56fe\uff08\u77ed\u65f6\u5085\u91cc\u53f6\u53d8\u6362\uff09\n\n    Args:\n        data: \u65f6\u57df\u4fe1\u53f7\u6570\u636e\n        fs: \u91c7\u6837\u9891\u7387 (Hz)\n        window_size: STFT\u7a97\u53e3\u5927\u5c0f\n        overlap: \u7a97\u53e3\u91cd\u53e0\u6bd4\u4f8b\n        title: \u81ea\u5b9a\u4e49\u6807\u9898\n        freq_range: \u53ef\u9009\uff0c\u9891\u7387\u8303\u56f4 (min_freq, max_freq)\n        time_range: \u53ef\u9009\uff0c\u65f6\u95f4\u8303\u56f4 (start_time, end_time)\n        cmap: \u8272\u5f69\u6620\u5c04\u540d\u79f0\n\n    Returns:\n        Figure: matplotlib \u56fe\u5f62\u5bf9\u8c61\n    \"\"\"\n    # \u5ef6\u8fdf\u5bfc\u5165\u5fc5\u8981\u7684\u5e93\n    import matplotlib.pyplot as plt\n    import matplotlib.ticker as ticker\n    from scipy import signal\n\n    # \u6027\u80fd\u4f18\u5316\uff1a\u5bf9\u5927\u6570\u636e\u5904\u7406\u524d\u8fdb\u884c\u964d\u91c7\u6837\uff0c\u964d\u4f4eSTFT\u8ba1\u7b97\u91cf\n    # \u5bf9\u4e8e\u7279\u522b\u5927\u7684\u6570\u636e\uff0c\u4f7f\u7528\u66f4\u5927\u7684\u7a97\u53e3\u5927\u5c0f\u548c\u66f4\u5c11\u7684\u91cd\u53e0\u6765\u51cf\u5c11\u8ba1\u7b97\u91cf\n    MAX_DATA_POINTS = 100000  # \u6700\u5927\u5904\u7406\u70b9\u6570\u9608\u503c\n\n    # \u9488\u5bf9\u957f\u4fe1\u53f7\u8fdb\u884c\u5904\u7406\u4f18\u5316\n    if len(data) &gt; MAX_DATA_POINTS:\n        # \u5982\u679c\u4fe1\u53f7\u957f\u5ea6\u8d85\u8fc7\u9608\u503c\uff0c\u589e\u52a0\u7a97\u53e3\u5927\u5c0f\u5e76\u51cf\u5c11\u91cd\u53e0\n        if window_size &lt; 2048:\n            window_size = 2048  # \u4f7f\u7528\u66f4\u5927\u7684\u7a97\u53e3\n        if overlap &gt; 0.5:\n            overlap = 0.5  # \u51cf\u5c11\u91cd\u53e0\uff0c\u51cf\u5c11\u603b\u7a97\u53e3\u6570\u91cf\n\n    # \u5bf9\u4e8e\u8d85\u5927\u6570\u636e\uff0c\u53ef\u4ee5\u5148\u964d\u91c7\u6837\u518d\u8ba1\u7b97\n    if len(data) &gt; 1000000:  # \u767e\u4e07\u7ea7\u4ee5\u4e0a\u6570\u636e\u70b9\n        # \u964d\u91c7\u6837\u56e0\u5b50\n        downsample_factor = 4\n        data = data[::downsample_factor]\n        fs = fs / downsample_factor\n\n    # \u521b\u5efa\u56fe\u5f62\u548c\u5750\u6807\u8f74 - \u4f18\u5316\u521b\u5efa\u8fc7\u7a0b\n    if ax is None:\n        fig, ax = plt.subplots(figsize=self.config.figsize_standard)\n    else:\n        fig = ax.figure  # type: ignore\n\n    # \u8ba1\u7b97\u7a97\u53e3\u91cd\u53e0\u70b9\u6570\n    noverlap = int(window_size * overlap)\n\n    # \u6027\u80fd\u4f18\u5316\uff1a\u4f7f\u7528\u66f4\u9ad8\u6548\u7684STFT\u8ba1\u7b97\u53c2\u6570\n    # \u8ba1\u7b97STFT - \u4f18\u5316STFT\u8ba1\u7b97\u53c2\u6570\n    f, t, Sxx = signal.spectrogram(\n        data,\n        fs=fs,\n        window=\"hann\",\n        nperseg=window_size,\n        noverlap=noverlap,\n        detrend=\"constant\",\n        scaling=\"density\",\n        mode=\"magnitude\",  # \u76f4\u63a5\u4f7f\u7528\u5e45\u5ea6\u800c\u4e0d\u662f\u529f\u7387\u8c31\uff0c\u51cf\u5c11\u4e00\u6b65\u8ba1\u7b97\n    )\n\n    # \u8f6c\u6362\u4e3a\u5bf9\u6570\u5c3a\u5ea6\u4ee5\u589e\u5f3a\u53ef\u89c6\u5316\u6548\u679c (dB)\n    Sxx_db = 10 * np.log10(Sxx + 1e-12)\n\n    # \u6027\u80fd\u4f18\u5316\uff1a\u4f7f\u7528\u56fa\u5b9a\u7684\u8272\u6807\u8303\u56f4\n    # \u786e\u5b9a\u8272\u6807\u8303\u56f4\uff0c\u589e\u5f3a\u5bf9\u6bd4\u5ea6 - \u4f7f\u7528\u56fa\u5b9a\u8303\u56f4\u800c\u4e0d\u662f\u5206\u4f4d\u6570\u8ba1\u7b97\n    # \u4f7f\u7528\u7b80\u5355\u7684min-max\u52a0\u504f\u7f6e\uff0c\u800c\u4e0d\u662f\u8ba1\u7b97\u5206\u4f4d\u6570\n    vmin = np.mean(Sxx_db) - 2 * np.std(Sxx_db)  # \u5747\u503c\u51cf\u4e24\u4e2a\u6807\u51c6\u5dee\n    vmax = np.mean(Sxx_db) + 2 * np.std(Sxx_db)  # \u5747\u503c\u52a0\u4e24\u4e2a\u6807\u51c6\u5dee\n\n    # \u7ed8\u5236\u65f6\u9891\u8c31 - \u4f7f\u7528\u66f4\u9ad8\u6548\u7684\u6e32\u67d3\u8bbe\u7f6e\n    im = ax.pcolormesh(\n        t,\n        f,\n        Sxx_db,\n        shading=\"auto\",  # \u4f7f\u7528auto\u800c\u4e0d\u662fgouraud\uff0c\u66f4\u9ad8\u6548\n        cmap=cmap,\n        vmin=vmin,\n        vmax=vmax,\n        rasterized=True,  # \u5149\u6805\u5316\u4ee5\u63d0\u9ad8\u6027\u80fd\n    )\n\n    # \u6dfb\u52a0\u989c\u8272\u6761 - \u7b80\u5316\u989c\u8272\u6761\u8bbe\u7f6e\n    cbar = fig.colorbar(im, ax=ax)\n    cbar.set_label(\"Power/Frequency (dB/Hz)\")\n\n    # \u6027\u80fd\u4f18\u5316\uff1a\u79fb\u9664\u590d\u6742\u7684\u6807\u8bb0\n    # \u79fb\u9664\u6700\u5927\u70b9\u6807\u8bb0\uff0c\u63d0\u9ad8\u6027\u80fd\uff0c\u53ea\u6709\u5728\u7279\u522b\u9700\u8981\u65f6\u624d\u8ba1\u7b97\n\n    # \u8bbe\u7f6e\u5750\u6807\u8f74\u8303\u56f4\uff08\u5982\u679c\u6307\u5b9a\uff09\n    if freq_range:\n        ax.set_ylim(freq_range)\n    else:\n        # \u9ed8\u8ba4\u663e\u793a\u4f4e\u9891\u533a\u57df\uff08\u901a\u5e38\u66f4\u6709\u610f\u4e49\uff09\n        max_display_freq = min(fs / 2, 5000) if fs &gt; 10000 else fs / 2\n        ax.set_ylim(0, max_display_freq)\n\n    if time_range:\n        ax.set_xlim(time_range)\n\n    # \u7f8e\u5316\u9891\u7387\u8f74\u683c\u5f0f - \u7b80\u5316\u683c\u5f0f\u8bbe\u7f6e\n    if max(f) &gt; 1000:\n        ax.yaxis.set_major_formatter(\n            ticker.FuncFormatter(\n                lambda y, pos: f\"{y / 1000:.1f}\" if y &gt;= 1000 else f\"{y:.0f}\"\n            )\n        )\n        ax.set_ylabel(\"Frequency (kHz)\")\n    else:\n        ax.set_ylabel(\"Frequency (Hz)\")\n\n    # \u8bbe\u7f6e\u65f6\u95f4\u523b\u5ea6\u683c\u5f0f - \u7b80\u5316\u683c\u5f0f\u8bbe\u7f6e\n    if max(t) &gt; 60:\n        ax.xaxis.set_major_formatter(\n            ticker.FuncFormatter(\n                lambda x, pos: f\"{int(x / 60)}:{int(x % 60):02d}\"\n                if x &gt;= 60\n                else f\"{int(x)}\"\n            )\n        )\n        ax.set_xlabel(\"Time (min:sec)\")\n    else:\n        ax.set_xlabel(\"Time (s)\")\n\n    # \u8bbe\u7f6e\u6807\u9898\n    if title:\n        plot_title = title\n    else:\n        plot_title = \"Spectrogram\"\n    ax.set_title(plot_title, fontweight=\"bold\")\n\n    # \u6dfb\u52a0\u7f51\u683c\u4ee5\u589e\u5f3a\u53ef\u8bfb\u6027 - \u7981\u7528\u7f51\u683c\u63d0\u9ad8\u6027\u80fd\n    ax.grid(False)\n\n    # \u81ea\u52a8\u8c03\u6574\u5e03\u5c40\n    fig.tight_layout()\n\n    return fig\n</code></pre>"},{"location":"reference/DASMatrix/visualization/das_visualizer/#DASMatrix.visualization.das_visualizer.WaterfallPlot","title":"WaterfallPlot","text":"<pre><code>WaterfallPlot(config: Optional[VisualizationConfig] = None)\n</code></pre> <p>               Bases: <code>PlotBase</code></p> <p>\u7011\u5e03\u56fe (Waterfall Plot) \u7ed8\u56fe\u7c7b\uff0c\u7528\u4e8e\u53ef\u89c6\u5316\u4e8c\u7ef4\u6570\u636e</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def __init__(self, config: Optional[VisualizationConfig] = None):\n    \"\"\"\u521d\u59cb\u5316\u7ed8\u56fe\u57fa\u7c7b\n\n    Args:\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\uff0c\u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\n    \"\"\"\n    self.config = config or VisualizationConfig()\n    self.logger = logging.getLogger(__name__)\n    self._setup_style()\n</code></pre>"},{"location":"reference/DASMatrix/visualization/das_visualizer/#DASMatrix.visualization.das_visualizer.WaterfallPlot.plot","title":"plot","text":"<pre><code>plot(\n    data: ndarray,\n    fs: float,\n    x_label: str = \"Channels\",\n    y_label: str = \"Time (s)\",\n    title: Optional[str] = None,\n    cmap: str = \"viridis\",\n    colorbar_label: str = \"Amplitude\",\n    aspect: str = \"auto\",\n    origin: str = \"upper\",\n    x_ticks: Optional[ndarray] = None,\n    y_ticks: Optional[ndarray] = None,\n    value_range: Optional[Tuple[float, float]] = None,\n    ax: Optional[Axes] = None,\n) -&gt; Any\n</code></pre> <p>\u7ed8\u5236\u7011\u5e03\u56fe\uff08\u4e8c\u7ef4\u6570\u636e\u53ef\u89c6\u5316\uff09</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u4e8c\u7ef4\u6570\u7ec4\uff0c\u5f62\u72b6\u4e3a (time_samples, channels) \u6216 (channels, time_samples)</p> \u5fc5\u9700 <code>fs</code> <code>float</code> <p>\u91c7\u6837\u9891\u7387 (Hz)</p> \u5fc5\u9700 <code>x_label</code> <code>str</code> <p>X\u8f74\u6807\u7b7e</p> <code>'Channels'</code> <code>y_label</code> <code>str</code> <p>Y\u8f74\u6807\u7b7e</p> <code>'Time (s)'</code> <code>title</code> <code>Optional[str]</code> <p>\u81ea\u5b9a\u4e49\u6807\u9898 (\u82f1\u6587)</p> <code>None</code> <code>cmap</code> <code>str</code> <p>\u8272\u5f69\u6620\u5c04\u540d\u79f0</p> <code>'viridis'</code> <code>colorbar_label</code> <code>str</code> <p>\u989c\u8272\u6761\u6807\u7b7e</p> <code>'Amplitude'</code> <code>aspect</code> <code>str</code> <p>\u56fe\u50cf\u7eb5\u6a2a\u6bd4\uff0c'auto' \u6216 'equal'</p> <code>'auto'</code> <code>origin</code> <code>str</code> <p>\u6570\u636e\u539f\u70b9\u4f4d\u7f6e\uff0c'upper' \u6216 'lower'</p> <code>'upper'</code> <code>x_ticks</code> <code>Optional[ndarray]</code> <p>\u53ef\u9009\uff0cX\u8f74\u523b\u5ea6\u503c</p> <code>None</code> <code>y_ticks</code> <code>Optional[ndarray]</code> <p>\u53ef\u9009\uff0cY\u8f74\u523b\u5ea6\u503c</p> <code>None</code> <code>value_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0c\u6570\u636e\u503c\u663e\u793a\u8303\u56f4 (min_value, max_value)</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Figure</code> <code>Any</code> <p>matplotlib \u56fe\u5f62\u5bf9\u8c61</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def plot(\n    self,\n    data: np.ndarray,\n    fs: float,\n    x_label: str = \"Channels\",\n    y_label: str = \"Time (s)\",\n    title: Optional[str] = None,\n    cmap: str = \"viridis\",\n    colorbar_label: str = \"Amplitude\",\n    aspect: str = \"auto\",\n    origin: str = \"upper\",\n    x_ticks: Optional[np.ndarray] = None,\n    y_ticks: Optional[np.ndarray] = None,\n    value_range: Optional[Tuple[float, float]] = None,\n    ax: Optional[plt.Axes] = None,\n) -&gt; Any:\n    \"\"\"\u7ed8\u5236\u7011\u5e03\u56fe\uff08\u4e8c\u7ef4\u6570\u636e\u53ef\u89c6\u5316\uff09\n\n    Args:\n        data: \u4e8c\u7ef4\u6570\u7ec4\uff0c\u5f62\u72b6\u4e3a (time_samples, channels) \u6216 (channels, time_samples)\n        fs: \u91c7\u6837\u9891\u7387 (Hz)\n        x_label: X\u8f74\u6807\u7b7e\n        y_label: Y\u8f74\u6807\u7b7e\n        title: \u81ea\u5b9a\u4e49\u6807\u9898 (\u82f1\u6587)\n        cmap: \u8272\u5f69\u6620\u5c04\u540d\u79f0\n        colorbar_label: \u989c\u8272\u6761\u6807\u7b7e\n        aspect: \u56fe\u50cf\u7eb5\u6a2a\u6bd4\uff0c'auto' \u6216 'equal'\n        origin: \u6570\u636e\u539f\u70b9\u4f4d\u7f6e\uff0c'upper' \u6216 'lower'\n        x_ticks: \u53ef\u9009\uff0cX\u8f74\u523b\u5ea6\u503c\n        y_ticks: \u53ef\u9009\uff0cY\u8f74\u523b\u5ea6\u503c\n        value_range: \u53ef\u9009\uff0c\u6570\u636e\u503c\u663e\u793a\u8303\u56f4 (min_value, max_value)\n\n    Returns:\n        Figure: matplotlib \u56fe\u5f62\u5bf9\u8c61\n    \"\"\"\n    # \u5ef6\u8fdf\u5bfc\u5165 matplotlib\n    import matplotlib.pyplot as plt\n\n    # \u521b\u5efa\u56fe\u5f62\u548c\u5750\u6807\u8f74\n    if ax is None:\n        fig, ax = plt.subplots(figsize=self.config.figsize_wide)\n    else:\n        fig = ax.figure  # type: ignore\n\n    # \u786e\u5b9a\u6570\u636e\u663e\u793a\u8303\u56f4\n    if value_range is None:\n        # \u81ea\u52a8\u786e\u5b9a\u5408\u9002\u7684\u6570\u636e\u8303\u56f4\n        vmin = np.percentile(data, 5)  # 5%\u5206\u4f4d\u6570\u4f5c\u4e3a\u6700\u5c0f\u503c\n        vmax = np.percentile(data, 95)  # 95%\u5206\u4f4d\u6570\u4f5c\u4e3a\u6700\u5927\u503c\n\n        # \u5bf9\u79f0\u5316\u8303\u56f4\uff0c\u627e\u51fa\u7edd\u5bf9\u503c\u6700\u5927\u7684\u8303\u56f4\n        abs_max = max(abs(vmin), abs(vmax))\n        if np.min(data) &lt; 0:  # \u5982\u679c\u6570\u636e\u6709\u8d1f\u503c\uff0c\u4f7f\u7528\u5bf9\u79f0\u8303\u56f4\n            vmin, vmax = -abs_max, abs_max\n    else:\n        vmin, vmax = value_range\n\n    # \u7ed8\u5236\u7011\u5e03\u56fe\n    im = ax.imshow(\n        data,\n        cmap=cmap,\n        aspect=aspect,  # type: ignore\n        origin=origin,  # type: ignore\n        interpolation=\"none\",  # \u7981\u7528\u63d2\u503c\u4ee5\u4fdd\u6301\u539f\u59cb\u6570\u636e\u7684\u6e05\u6670\u5ea6\n        vmin=vmin,\n        vmax=vmax,\n    )\n\n    # \u6dfb\u52a0\u989c\u8272\u6761\n    cbar = fig.colorbar(im, ax=ax, pad=0.01)\n    cbar.set_label(colorbar_label, fontsize=11)\n\n    # \u8bbe\u7f6e\u81ea\u5b9a\u4e49\u523b\u5ea6\uff08\u5982\u679c\u63d0\u4f9b\uff09\n    if x_ticks is not None:\n        ax.set_xticks(np.arange(0, data.shape[1], max(1, data.shape[1] // 10)))\n\n        # \u5982\u679c\u63d0\u4f9b\u4e86\u5177\u4f53\u7684x\u523b\u5ea6\u503c\uff0c\u4f7f\u7528\u5b83\u4eec\n        if len(x_ticks) &gt;= data.shape[1]:\n            x_tick_labels = x_ticks[: data.shape[1]]\n            # \u51cf\u5c11\u663e\u793a\u7684\u523b\u5ea6\u6570\u91cf\uff0c\u907f\u514d\u62e5\u6324\n            tick_indices = np.linspace(\n                0, len(x_tick_labels) - 1, min(10, len(x_tick_labels)), dtype=int\n            )\n            ax.set_xticks(tick_indices)\n            ax.set_xticklabels([f\"{x_tick_labels[i]:.0f}\" for i in tick_indices])\n\n    if y_ticks is not None:\n        ax.set_yticks(np.arange(0, data.shape[0], max(1, data.shape[0] // 10)))\n\n        # \u5982\u679c\u63d0\u4f9b\u4e86\u5177\u4f53\u7684y\u523b\u5ea6\u503c\uff0c\u4f7f\u7528\u5b83\u4eec\n        if len(y_ticks) &gt;= data.shape[0]:\n            y_tick_labels = y_ticks[: data.shape[0]]\n            # \u51cf\u5c11\u663e\u793a\u7684\u523b\u5ea6\u6570\u91cf\uff0c\u907f\u514d\u62e5\u6324\n            tick_indices = np.linspace(\n                0, len(y_tick_labels) - 1, min(10, len(y_tick_labels)), dtype=int\n            )\n            ax.set_yticks(tick_indices)\n            ax.set_yticklabels([f\"{y_tick_labels[i]:.1f}\" for i in tick_indices])\n    else:\n        # \u6839\u636e\u91c7\u6837\u9891\u7387\u8ba1\u7b97\u65f6\u95f4\u523b\u5ea6\n        if origin == \"upper\" or origin == \"lower\":\n            # \u8ba1\u7b97\u65f6\u95f4\u8f74\u7684\u5b9e\u9645\u503c\uff08\u79d2\uff09\n            time_values = np.arange(data.shape[0]) / fs\n\n            # \u8bbe\u7f6e\u5408\u9002\u7684\u65f6\u95f4\u523b\u5ea6\u6570\u91cf\n            num_ticks = min(10, data.shape[0])\n            tick_indices = np.linspace(0, data.shape[0] - 1, num_ticks, dtype=int)\n\n            ax.set_yticks(tick_indices)\n\n            # \u6839\u636e\u65f6\u95f4\u957f\u5ea6\u683c\u5f0f\u5316\u6807\u7b7e\n            if max(time_values) &gt; 60:\n                # \u5982\u679c\u65f6\u95f4\u8d85\u8fc760\u79d2\uff0c\u4f7f\u7528\u5206:\u79d2\u683c\u5f0f\n                ax.set_yticklabels(\n                    [\n                        f\"{int(time_values[i] / 60)}:{int(time_values[i] % 60):02d}\"\n                        for i in tick_indices\n                    ]\n                )\n                y_label = \"Time (min:sec)\"\n            else:\n                # \u5426\u5219\u4f7f\u7528\u79d2\u683c\u5f0f\n                ax.set_yticklabels([f\"{time_values[i]:.1f}\" for i in tick_indices])\n                y_label = \"Time (s)\"\n\n    # \u8bbe\u7f6e\u6807\u7b7e\n    ax.set_xlabel(x_label, fontsize=12)\n    ax.set_ylabel(y_label, fontsize=12)\n\n    # \u8bbe\u7f6e\u6807\u9898\n    if title:\n        plot_title = title\n    else:\n        plot_title = \"Waterfall Plot\"\n    ax.set_title(plot_title, fontweight=\"bold\", fontsize=14)\n\n    # \u4f18\u5316\u7f51\u683c\u548c\u523b\u5ea6\n    ax.grid(False)  # \u5bf9\u4e8eimshow\u7c7b\u578b\u7684\u56fe\uff0c\u901a\u5e38\u4e0d\u9700\u8981\u7f51\u683c\n\n    # \u81ea\u52a8\u8c03\u6574\u5e03\u5c40\n    fig.tight_layout()\n\n    # \u6dfb\u52a0\u53ef\u9009\u6c34\u5370\n    self._add_watermark(fig, ax)\n\n    return fig\n</code></pre>"},{"location":"reference/DASMatrix/visualization/das_visualizer/#DASMatrix.visualization.das_visualizer.DASVisualizer","title":"DASVisualizer","text":"<pre><code>DASVisualizer(\n    output_path: Union[str, Path],\n    sampling_frequency: float,\n    config: Optional[VisualizationConfig] = None,\n)\n</code></pre> <p>DAS \u6570\u636e\u53ef\u89c6\u5316\u5668 (DAS Data Visualizer)</p> <p>\u521d\u59cb\u5316 DAS \u6570\u636e\u53ef\u89c6\u5316\u5668</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>output_path</code> <code>Union[str, Path]</code> <p>\u56fe\u50cf\u8f93\u51fa\u76ee\u5f55</p> \u5fc5\u9700 <code>sampling_frequency</code> <code>float</code> <p>\u91c7\u6837\u9891\u7387 (Hz)</p> \u5fc5\u9700 <code>config</code> <code>Optional[VisualizationConfig]</code> <p>\u53ef\u89c6\u5316\u914d\u7f6e\uff0c\u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e</p> <code>None</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def __init__(\n    self,\n    output_path: Union[str, Path],\n    sampling_frequency: float,\n    config: Optional[VisualizationConfig] = None,\n):\n    \"\"\"\u521d\u59cb\u5316 DAS \u6570\u636e\u53ef\u89c6\u5316\u5668\n\n    Args:\n        output_path: \u56fe\u50cf\u8f93\u51fa\u76ee\u5f55\n        sampling_frequency: \u91c7\u6837\u9891\u7387 (Hz)\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\uff0c\u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\n    \"\"\"\n    self.output_path = (\n        Path(output_path) if isinstance(output_path, str) else output_path\n    )\n    self.output_path.mkdir(parents=True, exist_ok=True)\n    self.fs = sampling_frequency\n    self.config = config or VisualizationConfig()\n    self.logger = logging.getLogger(__name__)\n\n    # \u521d\u59cb\u5316\u7ed8\u56fe\u5668\u5b9e\u4f8b\n    self.waveform_plotter = WaveformPlot(self.config)\n    self.spectrum_plotter = SpectrumPlot(self.config)\n    self.spectrogram_plotter = SpectrogramPlot(self.config)\n    self.waterfall_plotter = WaterfallPlot(self.config)\n\n    # \u68c0\u6d4b\u662f\u5426\u5728 Jupyter \u73af\u5883\u4e2d\n    self._in_jupyter = self._check_jupyter()\n\n    # \u6027\u80fd\u4f18\u5316\uff1a\u9884\u5148\u5bfc\u5165\u5e38\u7528\u5e93\uff0c\u907f\u514d\u6bcf\u6b21\u7ed8\u56fe\u90fd\u91cd\u65b0\u5bfc\u5165\n    try:\n        import matplotlib.pyplot as plt\n\n        self._plt = plt\n        from scipy import signal\n\n        self._signal = signal\n    except ImportError:\n        self.logger.warning(\"Could not preload matplotlib or scipy.signal\")\n</code></pre>"},{"location":"reference/DASMatrix/visualization/das_visualizer/#DASMatrix.visualization.das_visualizer.DASVisualizer.WaveformPlot","title":"WaveformPlot","text":"<pre><code>WaveformPlot(\n    amplitude_data: ndarray,\n    time_range: Optional[Tuple[float, float]] = None,\n    amplitude_range: Optional[Tuple[float, float]] = None,\n    file_name: Optional[str] = None,\n    title: Optional[str] = None,\n    highlight_regions: Optional[\n        List[Tuple[float, float]]\n    ] = None,\n    ax: Optional[Axes] = None,\n) -&gt; Any\n</code></pre> <p>\u7ed8\u5236\u65f6\u57df\u6ce2\u5f62\u56fe</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>amplitude_data</code> <code>ndarray</code> <p>\u4e00\u7ef4\u6570\u7ec4\uff0c\u5305\u542b\u5355\u4e2a\u901a\u9053\u7684\u65f6\u57df\u6570\u636e</p> \u5fc5\u9700 <code>time_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0c\u65f6\u95f4\u663e\u793a\u8303\u56f4 (start_time, end_time)</p> <code>None</code> <code>amplitude_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0c\u5e45\u503c\u663e\u793a\u8303\u56f4 (min_amplitude, max_amplitude)</p> <code>None</code> <code>file_name</code> <code>Optional[str]</code> <p>\u4fdd\u5b58\u7684\u6587\u4ef6\u540d (\u4e0d\u542b\u6269\u5c55\u540d)\uff0c\u82e5\u63d0\u4f9b\u5219\u4fdd\u5b58\u56fe\u7247</p> <code>None</code> <code>title</code> <code>Optional[str]</code> <p>\u56fe\u8868\u6807\u9898 (\u82f1\u6587)</p> <code>None</code> <code>highlight_regions</code> <code>Optional[List[Tuple[float, float]]]</code> <p>\u53ef\u9009\u7684\u9ad8\u4eae\u533a\u57df\u5217\u8868\uff0c\u6bcf\u4e2a\u5143\u7d20\u4e3a(\u5f00\u59cb\u65f6\u95f4, \u7ed3\u675f\u65f6\u95f4)\u5143\u7ec4</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Figure</code> <code>Any</code> <p>matplotlib \u56fe\u5f62\u5bf9\u8c61\uff0c\u53ef\u5728 Jupyter notebook \u4e2d\u663e\u793a</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def WaveformPlot(\n    self,\n    amplitude_data: np.ndarray,\n    time_range: Optional[Tuple[float, float]] = None,\n    amplitude_range: Optional[Tuple[float, float]] = None,\n    file_name: Optional[str] = None,\n    title: Optional[str] = None,\n    highlight_regions: Optional[List[Tuple[float, float]]] = None,\n    ax: Optional[plt.Axes] = None,\n) -&gt; Any:\n    \"\"\"\u7ed8\u5236\u65f6\u57df\u6ce2\u5f62\u56fe\n\n    Args:\n        amplitude_data: \u4e00\u7ef4\u6570\u7ec4\uff0c\u5305\u542b\u5355\u4e2a\u901a\u9053\u7684\u65f6\u57df\u6570\u636e\n        time_range: \u53ef\u9009\uff0c\u65f6\u95f4\u663e\u793a\u8303\u56f4 (start_time, end_time)\n        amplitude_range: \u53ef\u9009\uff0c\u5e45\u503c\u663e\u793a\u8303\u56f4 (min_amplitude, max_amplitude)\n        file_name: \u4fdd\u5b58\u7684\u6587\u4ef6\u540d (\u4e0d\u542b\u6269\u5c55\u540d)\uff0c\u82e5\u63d0\u4f9b\u5219\u4fdd\u5b58\u56fe\u7247\n        title: \u56fe\u8868\u6807\u9898 (\u82f1\u6587)\n        highlight_regions: \u53ef\u9009\u7684\u9ad8\u4eae\u533a\u57df\u5217\u8868\uff0c\u6bcf\u4e2a\u5143\u7d20\u4e3a(\u5f00\u59cb\u65f6\u95f4, \u7ed3\u675f\u65f6\u95f4)\u5143\u7ec4\n\n    Returns:\n        Figure: matplotlib \u56fe\u5f62\u5bf9\u8c61\uff0c\u53ef\u5728 Jupyter notebook \u4e2d\u663e\u793a\n    \"\"\"\n    # \u6027\u80fd\u4f18\u5316\uff1a\u52a0\u5165\u6570\u636e\u9a8c\u8bc1\u524d\u7684\u5feb\u901f\u8def\u5f84\u68c0\u67e5\n    if amplitude_data is None or len(amplitude_data) == 0:\n        self.logger.error(\"\u8f93\u5165\u6570\u636e\u4e3a\u7a7a\")\n        return None\n\n    if not isinstance(amplitude_data, np.ndarray) or amplitude_data.ndim != 1:\n        self.logger.error(\n            f\"\u6570\u636e\u5fc5\u987b\u662f\u4e00\u7ef4numpy\u6570\u7ec4\uff0c\u5f53\u524d\u7ef4\u5ea6: {amplitude_data.ndim}\"\n        )\n        return None\n\n    # \u7ed8\u56fe\u524d\u542f\u7528agg\u540e\u7aef\u53ef\u4ee5\u63d0\u9ad8\u975e\u4ea4\u4e92\u5f0f\u7ed8\u56fe\u6027\u80fd\n    import matplotlib\n\n    prev_backend = matplotlib.get_backend()\n    if not self._in_jupyter:\n        matplotlib.use(\"agg\")  # \u975e\u4ea4\u4e92\u5f0f\u540e\u7aef\uff0c\u66f4\u5feb\n\n    # \u7ed8\u5236\u6ce2\u5f62\u56fe\n    fig = self.waveform_plotter.plot(\n        amplitude_data=amplitude_data,\n        fs=self.fs,  # \u4f20\u9012\u91c7\u6837\u9891\u7387\n        time_range=time_range,\n        amplitude_range=amplitude_range,\n        title=title,\n        highlight_regions=highlight_regions,\n        ax=ax,\n    )\n\n    # \u5982\u679c\u63d0\u4f9b\u4e86\u6587\u4ef6\u540d\uff0c\u5219\u4fdd\u5b58\u56fe\u7247\n    if file_name is not None:\n        save_path = self.output_path / f\"{file_name}.png\"\n        self.waveform_plotter.save_figure(save_path, close_after_save=False)\n\n    # \u8fd8\u539f\u540e\u7aef\n    if not self._in_jupyter:\n        matplotlib.use(prev_backend)\n\n    # \u5904\u7406\u56fe\u5f62\u663e\u793a\uff0c\u907f\u514d\u53cc\u91cd\u663e\u793a\n    return self._handle_figure_display(fig)\n</code></pre>"},{"location":"reference/DASMatrix/visualization/das_visualizer/#DASMatrix.visualization.das_visualizer.DASVisualizer.SpectrumPlot","title":"SpectrumPlot","text":"<pre><code>SpectrumPlot(\n    data: ndarray,\n    excitation_freq: Optional[float] = None,\n    file_name: Optional[str] = None,\n    title: Optional[str] = None,\n    peaks: Optional[List[Dict[str, float]]] = None,\n    freq_range: Optional[Tuple[float, float]] = None,\n    db_range: Optional[Tuple[float, float]] = None,\n    ax: Optional[Axes] = None,\n) -&gt; Any\n</code></pre> <p>\u7ed8\u5236\u5e76\u4fdd\u5b58\u9891\u8c31\u56fe</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u4e00\u7ef4\u6570\u7ec4\uff0c\u5305\u542b\u5355\u4e2a\u901a\u9053\u7684\u65f6\u57df\u4fe1\u53f7\u6570\u636e</p> \u5fc5\u9700 <code>excitation_freq</code> <code>Optional[float]</code> <p>(\u53ef\u9009) \u6fc0\u52b1\u9891\u7387 (Hz)</p> <code>None</code> <code>file_name</code> <code>Optional[str]</code> <p>\u4fdd\u5b58\u7684\u6587\u4ef6\u540d (\u4e0d\u542b\u6269\u5c55\u540d)\uff0c\u82e5\u63d0\u4f9b\u5219\u4fdd\u5b58\u56fe\u7247</p> <code>None</code> <code>title</code> <code>Optional[str]</code> <p>\u56fe\u8868\u6807\u9898 (\u82f1\u6587)</p> <code>None</code> <code>peaks</code> <code>Optional[List[Dict[str, float]]]</code> <p>(\u53ef\u9009) \u5cf0\u503c\u5217\u8868\uff0c\u6bcf\u4e2a\u5cf0\u503c\u5305\u542b 'frequency' \u548c 'magnitude'</p> <code>None</code> <code>freq_range</code> <code>Optional[Tuple[float, float]]</code> <p>(\u53ef\u9009) \u9891\u7387\u8303\u56f4 (min_freq, max_freq)\uff0c\u7528\u4e8e\u9650\u5236\u663e\u793a\u7684\u9891\u7387\u8303\u56f4</p> <code>None</code> <code>db_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0cdB\u503c\u663e\u793a\u8303\u56f4 (min_db, max_db)</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Figure</code> <code>Any</code> <p>matplotlib \u56fe\u5f62\u5bf9\u8c61\uff0c\u53ef\u5728 Jupyter notebook \u4e2d\u663e\u793a</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def SpectrumPlot(\n    self,\n    data: np.ndarray,\n    excitation_freq: Optional[float] = None,\n    file_name: Optional[str] = None,\n    title: Optional[str] = None,\n    peaks: Optional[List[Dict[str, float]]] = None,\n    freq_range: Optional[Tuple[float, float]] = None,\n    db_range: Optional[Tuple[float, float]] = None,\n    ax: Optional[plt.Axes] = None,\n) -&gt; Any:\n    \"\"\"\u7ed8\u5236\u5e76\u4fdd\u5b58\u9891\u8c31\u56fe\n\n    Args:\n        data: \u4e00\u7ef4\u6570\u7ec4\uff0c\u5305\u542b\u5355\u4e2a\u901a\u9053\u7684\u65f6\u57df\u4fe1\u53f7\u6570\u636e\n        excitation_freq: (\u53ef\u9009) \u6fc0\u52b1\u9891\u7387 (Hz)\n        file_name: \u4fdd\u5b58\u7684\u6587\u4ef6\u540d (\u4e0d\u542b\u6269\u5c55\u540d)\uff0c\u82e5\u63d0\u4f9b\u5219\u4fdd\u5b58\u56fe\u7247\n        title: \u56fe\u8868\u6807\u9898 (\u82f1\u6587)\n        peaks: (\u53ef\u9009) \u5cf0\u503c\u5217\u8868\uff0c\u6bcf\u4e2a\u5cf0\u503c\u5305\u542b 'frequency' \u548c 'magnitude'\n        freq_range: (\u53ef\u9009) \u9891\u7387\u8303\u56f4 (min_freq, max_freq)\uff0c\u7528\u4e8e\u9650\u5236\u663e\u793a\u7684\u9891\u7387\u8303\u56f4\n        db_range: \u53ef\u9009\uff0cdB\u503c\u663e\u793a\u8303\u56f4 (min_db, max_db)\n\n    Returns:\n        Figure: matplotlib \u56fe\u5f62\u5bf9\u8c61\uff0c\u53ef\u5728 Jupyter notebook \u4e2d\u663e\u793a\n    \"\"\"\n    # \u6027\u80fd\u4f18\u5316\uff1a\u52a0\u5165\u6570\u636e\u9a8c\u8bc1\u524d\u7684\u5feb\u901f\u8def\u5f84\u68c0\u67e5\n    if data is None or len(data) == 0:\n        self.logger.error(\"\u8f93\u5165\u6570\u636e\u4e3a\u7a7a\")\n        return None\n\n    if not isinstance(data, np.ndarray) or data.ndim != 1:\n        self.logger.error(f\"\u6570\u636e\u5fc5\u987b\u662f\u4e00\u7ef4numpy\u6570\u7ec4\uff0c\u5f53\u524d\u7ef4\u5ea6: {data.ndim}\")\n        return None\n\n    # \u6027\u80fd\u4f18\u5316\uff1a\u4f7f\u7528 Welch \u65b9\u6cd5\u8ba1\u7b97\u9891\u8c31\uff0c\u6bd4\u76f4\u63a5 FFT \u66f4\u7a33\u5b9a\u4e14\u53ef\u80fd\u66f4\u5feb\n    from scipy import signal\n\n    # \u6839\u636e\u6570\u636e\u957f\u5ea6\u81ea\u52a8\u786e\u5b9a\u5408\u9002\u7684\u7a97\u53e3\u5927\u5c0f\u548c\u91cd\u53e0\u53c2\u6570\n    n = len(data)\n    if n &gt; 500000:  # \u5927\u4e8e50\u4e07\u70b9\u7684\u6570\u636e\n        nperseg = 8192  # \u4f7f\u7528\u8f83\u5927\u7684\u7a97\u53e3\u589e\u52a0\u9891\u7387\u5206\u8fa8\u7387\n        noverlap = nperseg // 2  # 50% \u91cd\u53e0\n    elif n &gt; 100000:  # 10\u4e07-50\u4e07\u70b9\u7684\u6570\u636e\n        nperseg = 4096\n        noverlap = nperseg // 2\n    else:  # \u8f83\u5c0f\u89c4\u6a21\u7684\u6570\u636e\n        nperseg = min(2048, n // 4)  # \u786e\u4fdd\u7a97\u53e3\u4e0d\u8d85\u8fc7\u6570\u636e\u957f\u5ea6\u76841/4\n        noverlap = nperseg // 2\n\n    # \u4f7f\u7528 Welch \u65b9\u6cd5\u8ba1\u7b97\u529f\u7387\u8c31\u5bc6\u5ea6 (PSD)\n    frequencies, psd = signal.welch(\n        data,\n        fs=self.fs,\n        window=\"hann\",\n        nperseg=nperseg,\n        noverlap=noverlap,\n        detrend=\"constant\",\n        scaling=\"spectrum\",  # \u4f7f\u7528 'spectrum' \u800c\u4e0d\u662f 'density' \u4ee5\u83b7\u5f97\u5e45\u5ea6\u8c31\n        average=\"mean\",  # \u5e73\u5747\u591a\u4e2a\u5206\u6bb5\u7684\u7ed3\u679c\n    )\n\n    # Welch \u8fd4\u56de\u529f\u7387\u8c31\u5bc6\u5ea6\uff0c\u6211\u4eec\u8ba1\u7b97\u5e45\u5ea6\u8c31\n    magnitudes = np.sqrt(psd)\n\n    # \u5982\u679c\u6307\u5b9a\u4e86\u9891\u7387\u8303\u56f4\uff0c\u5219\u8fc7\u6ee4\u6570\u636e\n    if freq_range is not None:\n        min_freq, max_freq = freq_range\n        mask = (frequencies &gt;= min_freq) &amp; (frequencies &lt;= max_freq)\n        frequencies = frequencies[mask]\n        magnitudes = magnitudes[mask]\n\n    # \u7ed8\u56fe\u524d\u542f\u7528agg\u540e\u7aef\u53ef\u4ee5\u63d0\u9ad8\u975e\u4ea4\u4e92\u5f0f\u7ed8\u56fe\u6027\u80fd\n    import matplotlib\n\n    prev_backend = matplotlib.get_backend()\n    if not self._in_jupyter:\n        matplotlib.use(\"agg\")  # \u975e\u4ea4\u4e92\u5f0f\u540e\u7aef\uff0c\u66f4\u5feb\n\n    # \u7ed8\u5236\u9891\u8c31\u56fe\n    fig = self.spectrum_plotter.plot(\n        frequencies,\n        magnitudes,\n        excitation_freq=excitation_freq,\n        title=title,\n        peaks=peaks,\n        db_range=db_range,\n        ax=ax,\n    )\n\n    # \u5982\u679c\u63d0\u4f9b\u4e86\u6587\u4ef6\u540d\uff0c\u5219\u4fdd\u5b58\u56fe\u7247\n    if file_name is not None:\n        freq_suffix = f\"_{excitation_freq:.0f}Hz\" if excitation_freq else \"\"\n        save_path = self.output_path / f\"{file_name}{freq_suffix}.png\"\n        self.spectrum_plotter.save_figure(save_path, close_after_save=False)\n\n    # \u8fd8\u539f\u540e\u7aef\n    if not self._in_jupyter:\n        matplotlib.use(prev_backend)\n\n    # \u5904\u7406\u56fe\u5f62\u663e\u793a\uff0c\u907f\u514d\u53cc\u91cd\u663e\u793a\n    return self._handle_figure_display(fig)\n</code></pre>"},{"location":"reference/DASMatrix/visualization/das_visualizer/#DASMatrix.visualization.das_visualizer.DASVisualizer.SpectrogramPlot","title":"SpectrogramPlot","text":"<pre><code>SpectrogramPlot(\n    data: ndarray,\n    window_size: int = 1024,\n    overlap: float = 0.75,\n    file_name: Optional[str] = None,\n    title: Optional[str] = None,\n    freq_range: Optional[Tuple[float, float]] = None,\n    time_range: Optional[Tuple[float, float]] = None,\n    cmap: str = \"viridis\",\n    ax: Optional[Axes] = None,\n) -&gt; Any\n</code></pre> <p>\u7ed8\u5236\u65f6\u9891\u56fe\uff08\u77ed\u65f6\u5085\u91cc\u53f6\u53d8\u6362\uff09</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u4e00\u7ef4\u6570\u7ec4\uff0c\u5305\u542b\u5355\u4e2a\u901a\u9053\u7684\u65f6\u57df\u6570\u636e</p> \u5fc5\u9700 <code>window_size</code> <code>int</code> <p>STFT\u7a97\u53e3\u5927\u5c0f</p> <code>1024</code> <code>overlap</code> <code>float</code> <p>\u7a97\u53e3\u91cd\u53e0\u6bd4\u4f8b</p> <code>0.75</code> <code>file_name</code> <code>Optional[str]</code> <p>\u4fdd\u5b58\u7684\u6587\u4ef6\u540d (\u4e0d\u542b\u6269\u5c55\u540d)\uff0c\u82e5\u63d0\u4f9b\u5219\u4fdd\u5b58\u56fe\u7247</p> <code>None</code> <code>title</code> <code>Optional[str]</code> <p>\u56fe\u8868\u6807\u9898 (\u82f1\u6587)</p> <code>None</code> <code>freq_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0c\u9891\u7387\u8303\u56f4 (min_freq, max_freq)</p> <code>None</code> <code>time_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0c\u65f6\u95f4\u8303\u56f4 (start_time, end_time)</p> <code>None</code> <code>cmap</code> <code>str</code> <p>\u8272\u5f69\u6620\u5c04\u540d\u79f0</p> <code>'viridis'</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Figure</code> <code>Any</code> <p>matplotlib \u56fe\u5f62\u5bf9\u8c61\uff0c\u53ef\u5728 Jupyter notebook \u4e2d\u663e\u793a</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def SpectrogramPlot(\n    self,\n    data: np.ndarray,\n    window_size: int = 1024,\n    overlap: float = 0.75,\n    file_name: Optional[str] = None,\n    title: Optional[str] = None,\n    freq_range: Optional[Tuple[float, float]] = None,\n    time_range: Optional[Tuple[float, float]] = None,\n    cmap: str = \"viridis\",\n    ax: Optional[plt.Axes] = None,\n) -&gt; Any:\n    \"\"\"\u7ed8\u5236\u65f6\u9891\u56fe\uff08\u77ed\u65f6\u5085\u91cc\u53f6\u53d8\u6362\uff09\n\n    Args:\n        data: \u4e00\u7ef4\u6570\u7ec4\uff0c\u5305\u542b\u5355\u4e2a\u901a\u9053\u7684\u65f6\u57df\u6570\u636e\n        window_size: STFT\u7a97\u53e3\u5927\u5c0f\n        overlap: \u7a97\u53e3\u91cd\u53e0\u6bd4\u4f8b\n        file_name: \u4fdd\u5b58\u7684\u6587\u4ef6\u540d (\u4e0d\u542b\u6269\u5c55\u540d)\uff0c\u82e5\u63d0\u4f9b\u5219\u4fdd\u5b58\u56fe\u7247\n        title: \u56fe\u8868\u6807\u9898 (\u82f1\u6587)\n        freq_range: \u53ef\u9009\uff0c\u9891\u7387\u8303\u56f4 (min_freq, max_freq)\n        time_range: \u53ef\u9009\uff0c\u65f6\u95f4\u8303\u56f4 (start_time, end_time)\n        cmap: \u8272\u5f69\u6620\u5c04\u540d\u79f0\n\n    Returns:\n        Figure: matplotlib \u56fe\u5f62\u5bf9\u8c61\uff0c\u53ef\u5728 Jupyter notebook \u4e2d\u663e\u793a\n    \"\"\"\n    # \u6027\u80fd\u4f18\u5316\uff1a\u52a0\u5165\u6570\u636e\u9a8c\u8bc1\u524d\u7684\u5feb\u901f\u8def\u5f84\u68c0\u67e5\n    if data is None or len(data) == 0:\n        self.logger.error(\"\u8f93\u5165\u6570\u636e\u4e3a\u7a7a\")\n        return None\n\n    if not isinstance(data, np.ndarray) or data.ndim != 1:\n        self.logger.error(f\"\u6570\u636e\u5fc5\u987b\u662f\u4e00\u7ef4numpy\u6570\u7ec4\uff0c\u5f53\u524d\u7ef4\u5ea6: {data.ndim}\")\n        return None\n\n    # \u6027\u80fd\u4f18\u5316\uff1a\u81ea\u52a8\u8c03\u6574\u5927\u6570\u636e\u7684\u7a97\u53e3\u5927\u5c0f\u548c\u91cd\u53e0\u6bd4\u4f8b\n    data_length = len(data)\n    # \u5bf9\u4e8e\u8d85\u957f\u6570\u636e\uff0c\u81ea\u52a8\u8c03\u6574\u4e3a\u66f4\u5408\u7406\u7684\u53c2\u6570\n    if data_length &gt; 500000:  # 50\u4e07\u4ee5\u4e0a\u6570\u636e\u70b9\n        if window_size &lt; 2048:\n            window_size = 2048  # \u589e\u52a0\u7a97\u53e3\u5927\u5c0f\n        if overlap &gt; 0.5:\n            overlap = 0.5  # \u51cf\u5c11\u91cd\u53e0\n\n    # \u7ed8\u56fe\u524d\u542f\u7528agg\u540e\u7aef\u53ef\u4ee5\u63d0\u9ad8\u975e\u4ea4\u4e92\u5f0f\u7ed8\u56fe\u6027\u80fd\n    import matplotlib\n\n    prev_backend = matplotlib.get_backend()\n    if not self._in_jupyter:\n        matplotlib.use(\"agg\")  # \u975e\u4ea4\u4e92\u5f0f\u540e\u7aef\uff0c\u66f4\u5feb\n\n    # \u7ed8\u5236\u65f6\u9891\u56fe\n    fig = self.spectrogram_plotter.plot(\n        data,\n        self.fs,\n        window_size=window_size,\n        overlap=overlap,\n        title=title,\n        freq_range=freq_range,\n        time_range=time_range,\n        cmap=cmap,\n        ax=ax,\n    )\n\n    # \u5982\u679c\u63d0\u4f9b\u4e86\u6587\u4ef6\u540d\uff0c\u5219\u4fdd\u5b58\u56fe\u7247\n    if file_name is not None:\n        save_path = self.output_path / f\"{file_name}.png\"\n        self.spectrogram_plotter.save_figure(save_path, close_after_save=False)\n\n    # \u8fd8\u539f\u540e\u7aef\n    if not self._in_jupyter:\n        matplotlib.use(prev_backend)\n\n    # \u5904\u7406\u56fe\u5f62\u663e\u793a\uff0c\u907f\u514d\u53cc\u91cd\u663e\u793a\n    return self._handle_figure_display(fig)\n</code></pre>"},{"location":"reference/DASMatrix/visualization/das_visualizer/#DASMatrix.visualization.das_visualizer.DASVisualizer.WaterfallPlot","title":"WaterfallPlot","text":"<pre><code>WaterfallPlot(\n    data: ndarray,\n    x_label: str = \"Channels\",\n    y_label: str = \"Time (s)\",\n    file_name: Optional[str] = None,\n    title: Optional[str] = None,\n    cmap: str = \"viridis\",\n    colorbar_label: str = \"Amplitude\",\n    aspect: str = \"auto\",\n    origin: str = \"upper\",\n    x_ticks: Optional[ndarray] = None,\n    y_ticks: Optional[ndarray] = None,\n    value_range: Optional[Tuple[float, float]] = None,\n    ax: Optional[Axes] = None,\n) -&gt; Any\n</code></pre> <p>\u7ed8\u5236\u7011\u5e03\u56fe\uff08\u4e8c\u7ef4\u6570\u636e\u53ef\u89c6\u5316\uff09</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>data</code> <code>ndarray</code> <p>\u4e8c\u7ef4\u6570\u7ec4\uff0c\u5f62\u72b6\u4e3a (time_samples, channels) \u6216 (channels, time_samples)</p> \u5fc5\u9700 <code>x_label</code> <code>str</code> <p>X\u8f74\u6807\u7b7e</p> <code>'Channels'</code> <code>y_label</code> <code>str</code> <p>Y\u8f74\u6807\u7b7e</p> <code>'Time (s)'</code> <code>file_name</code> <code>Optional[str]</code> <p>\u4fdd\u5b58\u7684\u6587\u4ef6\u540d (\u4e0d\u542b\u6269\u5c55\u540d)\uff0c\u82e5\u63d0\u4f9b\u5219\u4fdd\u5b58\u56fe\u7247</p> <code>None</code> <code>title</code> <code>Optional[str]</code> <p>\u81ea\u5b9a\u4e49\u6807\u9898 (\u82f1\u6587)</p> <code>None</code> <code>cmap</code> <code>str</code> <p>\u8272\u5f69\u6620\u5c04\u540d\u79f0</p> <code>'viridis'</code> <code>colorbar_label</code> <code>str</code> <p>\u989c\u8272\u6761\u6807\u7b7e</p> <code>'Amplitude'</code> <code>aspect</code> <code>str</code> <p>\u56fe\u50cf\u7eb5\u6a2a\u6bd4\uff0c'auto' \u6216 'equal'</p> <code>'auto'</code> <code>origin</code> <code>str</code> <p>\u6570\u636e\u539f\u70b9\u4f4d\u7f6e\uff0c'upper' \u6216 'lower'</p> <code>'upper'</code> <code>x_ticks</code> <code>Optional[ndarray]</code> <p>\u53ef\u9009\uff0cX\u8f74\u523b\u5ea6\u503c</p> <code>None</code> <code>y_ticks</code> <code>Optional[ndarray]</code> <p>\u53ef\u9009\uff0cY\u8f74\u523b\u5ea6\u503c</p> <code>None</code> <code>value_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u53ef\u9009\uff0c\u6570\u636e\u503c\u663e\u793a\u8303\u56f4 (min_value, max_value)</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Figure</code> <code>Any</code> <p>matplotlib \u56fe\u5f62\u5bf9\u8c61\uff0c\u53ef\u5728 Jupyter notebook \u4e2d\u663e\u793a</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def WaterfallPlot(\n    self,\n    data: np.ndarray,\n    x_label: str = \"Channels\",\n    y_label: str = \"Time (s)\",\n    file_name: Optional[str] = None,\n    title: Optional[str] = None,\n    cmap: str = \"viridis\",\n    colorbar_label: str = \"Amplitude\",\n    aspect: str = \"auto\",\n    origin: str = \"upper\",\n    x_ticks: Optional[np.ndarray] = None,\n    y_ticks: Optional[np.ndarray] = None,\n    value_range: Optional[Tuple[float, float]] = None,\n    ax: Optional[plt.Axes] = None,\n) -&gt; Any:\n    \"\"\"\u7ed8\u5236\u7011\u5e03\u56fe\uff08\u4e8c\u7ef4\u6570\u636e\u53ef\u89c6\u5316\uff09\n\n    Args:\n        data: \u4e8c\u7ef4\u6570\u7ec4\uff0c\u5f62\u72b6\u4e3a (time_samples, channels) \u6216 (channels, time_samples)\n        x_label: X\u8f74\u6807\u7b7e\n        y_label: Y\u8f74\u6807\u7b7e\n        file_name: \u4fdd\u5b58\u7684\u6587\u4ef6\u540d (\u4e0d\u542b\u6269\u5c55\u540d)\uff0c\u82e5\u63d0\u4f9b\u5219\u4fdd\u5b58\u56fe\u7247\n        title: \u81ea\u5b9a\u4e49\u6807\u9898 (\u82f1\u6587)\n        cmap: \u8272\u5f69\u6620\u5c04\u540d\u79f0\n        colorbar_label: \u989c\u8272\u6761\u6807\u7b7e\n        aspect: \u56fe\u50cf\u7eb5\u6a2a\u6bd4\uff0c'auto' \u6216 'equal'\n        origin: \u6570\u636e\u539f\u70b9\u4f4d\u7f6e\uff0c'upper' \u6216 'lower'\n        x_ticks: \u53ef\u9009\uff0cX\u8f74\u523b\u5ea6\u503c\n        y_ticks: \u53ef\u9009\uff0cY\u8f74\u523b\u5ea6\u503c\n        value_range: \u53ef\u9009\uff0c\u6570\u636e\u503c\u663e\u793a\u8303\u56f4 (min_value, max_value)\n\n    Returns:\n        Figure: matplotlib \u56fe\u5f62\u5bf9\u8c61\uff0c\u53ef\u5728 Jupyter notebook \u4e2d\u663e\u793a\n    \"\"\"\n    # \u6570\u636e\u9a8c\u8bc1\n    if data is None or data.size == 0:\n        self.logger.error(\"\u8f93\u5165\u6570\u636e\u4e3a\u7a7a\")\n        return None\n\n    if not isinstance(data, np.ndarray) or data.ndim != 2:\n        self.logger.error(f\"\u6570\u636e\u5fc5\u987b\u662f\u4e8c\u7ef4numpy\u6570\u7ec4\uff0c\u5f53\u524d\u7ef4\u5ea6: {data.ndim}\")\n        return None\n\n    # \u7ed8\u56fe\u524d\u542f\u7528agg\u540e\u7aef\u53ef\u4ee5\u63d0\u9ad8\u975e\u4ea4\u4e92\u5f0f\u7ed8\u56fe\u6027\u80fd\n    import matplotlib\n\n    prev_backend = matplotlib.get_backend()\n    if not self._in_jupyter:\n        matplotlib.use(\"agg\")  # \u975e\u4ea4\u4e92\u5f0f\u540e\u7aef\uff0c\u66f4\u5feb\n\n    # \u7ed8\u5236\u7011\u5e03\u56fe\n    fig = self.waterfall_plotter.plot(\n        data=data,\n        fs=self.fs,\n        x_label=x_label,\n        y_label=y_label,\n        title=title,\n        cmap=cmap,\n        colorbar_label=colorbar_label,\n        aspect=aspect,\n        origin=origin,\n        x_ticks=x_ticks,\n        y_ticks=y_ticks,\n        value_range=value_range,\n        ax=ax,\n    )\n\n    # \u5982\u679c\u63d0\u4f9b\u4e86\u6587\u4ef6\u540d\uff0c\u5219\u4fdd\u5b58\u56fe\u7247\n    if file_name is not None:\n        save_path = self.output_path / f\"{file_name}.png\"\n        self.waterfall_plotter.save_figure(save_path, close_after_save=False)\n\n    # \u8fd8\u539f\u540e\u7aef\n    if not self._in_jupyter:\n        matplotlib.use(prev_backend)\n\n    # \u5904\u7406\u56fe\u5f62\u663e\u793a\uff0c\u907f\u514d\u53cc\u91cd\u663e\u793a\n    return self._handle_figure_display(fig)\n</code></pre>"},{"location":"reference/DASMatrix/visualization/das_visualizer/#DASMatrix.visualization.das_visualizer.FKPlot","title":"FKPlot","text":"<pre><code>FKPlot(config: Optional[VisualizationConfig] = None)\n</code></pre> <p>               Bases: <code>PlotBase</code></p> <p>F-K \u8c31\u56fe (F-K Spectrum Plot) \u7ed8\u56fe\u7c7b</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def __init__(self, config: Optional[VisualizationConfig] = None):\n    \"\"\"\u521d\u59cb\u5316\u7ed8\u56fe\u57fa\u7c7b\n\n    Args:\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\uff0c\u82e5\u672a\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\n    \"\"\"\n    self.config = config or VisualizationConfig()\n    self.logger = logging.getLogger(__name__)\n    self._setup_style()\n</code></pre>"},{"location":"reference/DASMatrix/visualization/das_visualizer/#DASMatrix.visualization.das_visualizer.FKPlot.plot","title":"plot","text":"<pre><code>plot(\n    fk_spectrum: ndarray,\n    freqs: ndarray,\n    wavenumbers: ndarray,\n    title: Optional[str] = None,\n    cmap: str = \"turbo\",\n    db_range: Optional[Tuple[float, float]] = None,\n    v_lines: Optional[List[float]] = None,\n    ax: Optional[Axes] = None,\n) -&gt; Any\n</code></pre> <p>\u7ed8\u5236 F-K \u8c31\u56fe</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>fk_spectrum</code> <code>ndarray</code> <p>FK \u8c31 (complex)</p> \u5fc5\u9700 <code>freqs</code> <code>ndarray</code> <p>\u9891\u7387\u8f74</p> \u5fc5\u9700 <code>wavenumbers</code> <code>ndarray</code> <p>\u6ce2\u6570\u8f74</p> \u5fc5\u9700 <code>title</code> <code>Optional[str]</code> <p>\u6807\u9898</p> <code>None</code> <code>cmap</code> <code>str</code> <p>\u8272\u5f69\u6620\u5c04</p> <code>'turbo'</code> <code>db_range</code> <code>Optional[Tuple[float, float]]</code> <p>\u663e\u793a\u8303\u56f4 (min_db, max_db)</p> <code>None</code> <code>v_lines</code> <code>Optional[List[float]]</code> <p>\u5f85\u6807\u8bb0\u7684\u901f\u5ea6\u7ebf (m/s)</p> <code>None</code> <code>ax</code> <code>Optional[Axes]</code> <p>\u53ef\u9009\u7684 Axes \u5bf9\u8c61</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>Figure</code> <code>Any</code> <p>matplotlib \u56fe\u5f62\u5bf9\u8c61</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/das_visualizer.py</code> <pre><code>def plot(\n    self,\n    fk_spectrum: np.ndarray,\n    freqs: np.ndarray,\n    wavenumbers: np.ndarray,\n    title: Optional[str] = None,\n    cmap: str = \"turbo\",\n    db_range: Optional[Tuple[float, float]] = None,\n    v_lines: Optional[List[float]] = None,\n    ax: Optional[plt.Axes] = None,\n) -&gt; Any:\n    \"\"\"\u7ed8\u5236 F-K \u8c31\u56fe\n\n    Args:\n        fk_spectrum: FK \u8c31 (complex)\n        freqs: \u9891\u7387\u8f74\n        wavenumbers: \u6ce2\u6570\u8f74\n        title: \u6807\u9898\n        cmap: \u8272\u5f69\u6620\u5c04\n        db_range: \u663e\u793a\u8303\u56f4 (min_db, max_db)\n        v_lines: \u5f85\u6807\u8bb0\u7684\u901f\u5ea6\u7ebf (m/s)\n        ax: \u53ef\u9009\u7684 Axes \u5bf9\u8c61\n\n    Returns:\n        Figure: matplotlib \u56fe\u5f62\u5bf9\u8c61\n    \"\"\"\n    if ax is None:\n        fig, ax = plt.subplots(figsize=self.config.figsize_standard)\n    else:\n        fig = ax.figure  # type: ignore\n\n    # \u8ba1\u7b97\u5e45\u5ea6\u8c31 (dB)\n    mag = np.abs(fk_spectrum)\n    mag_db = 20 * np.log10(mag + 1e-12)\n\n    # \u5f52\u4e00\u5316 dB\n    mag_db = mag_db - np.max(mag_db)\n\n    # \u786e\u5b9a\u663e\u793a\u8303\u56f4\n    if db_range:\n        vmin, vmax = db_range\n    else:\n        vmax = 0\n        vmin = -60  # \u9ed8\u8ba4\u663e\u793a\u524d 60dB\n\n    # \u7ed8\u5236\n    # \u4f7f\u7528 pcolormesh \u6216 imshow\n    # \u6ce8\u610f\uff1aimshow \u9700\u8981 origin='lower' \u4e14 extent \u6b63\u786e\n    extent = (\n        float(wavenumbers[0]),\n        float(wavenumbers[-1]),\n        float(freqs[0]),\n        float(freqs[-1]),\n    )\n\n    im = ax.imshow(\n        mag_db,\n        extent=extent,\n        origin=\"lower\",\n        aspect=\"auto\",\n        cmap=cmap,\n        vmin=vmin,\n        vmax=vmax,\n        interpolation=\"nearest\",\n    )\n\n    cbar = fig.colorbar(im, ax=ax)\n    cbar.set_label(\"Amplitude (dB)\")\n\n    ax.set_xlabel(\"Wavenumber (1/m)\")\n    ax.set_ylabel(\"Frequency (Hz)\")\n\n    if title:\n        ax.set_title(title, fontweight=\"bold\")\n    else:\n        ax.set_title(\"F-K Spectrum\", fontweight=\"bold\")\n\n    # \u7ed8\u5236\u901f\u5ea6\u7ebf f = v * k\n    if v_lines:\n        k_min, k_max = wavenumbers[0], wavenumbers[-1]\n        f_min, f_max = freqs[0], freqs[-1]\n\n        k_line = np.linspace(k_min, k_max, 100)\n\n        for v in v_lines:\n            f_line = v * k_line\n\n            # \u53ea\u7ed8\u5236\u5728\u9891\u7387\u8303\u56f4\u5185\u7684\u90e8\u5206\n            mask = (f_line &gt;= f_min) &amp; (f_line &lt;= f_max)\n            if np.any(mask):\n                ax.plot(k_line[mask], f_line[mask], \"w--\", alpha=0.7, linewidth=1)\n                # \u6807\u6ce8\u901f\u5ea6\n                # \u627e\u4e00\u4e2a\u5408\u9002\u7684\u4f4d\u7f6e\u6807\u6ce8\n                idx = len(k_line) // 2\n                if mask[idx]:\n                    ax.text(\n                        k_line[idx],\n                        f_line[idx],\n                        f\"{v} m/s\",\n                        color=\"white\",\n                        fontsize=8,\n                    )\n\n    fig.tight_layout()\n    return fig\n</code></pre>"},{"location":"reference/DASMatrix/visualization/styles/","title":"styles","text":""},{"location":"reference/DASMatrix/visualization/styles/#DASMatrix.visualization.styles","title":"styles","text":"<p>Nature/Science \u671f\u520a\u7ea7\u522b\u6837\u5f0f\u8bbe\u7f6e</p> <p>\u63d0\u4f9b\u4e13\u4e1a\u7684 matplotlib \u6837\u5f0f\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u548c\u5de5\u5177\u51fd\u6570\u3002</p>"},{"location":"reference/DASMatrix/visualization/styles/#DASMatrix.visualization.styles.apply_nature_style","title":"apply_nature_style","text":"<pre><code>apply_nature_style(\n    config: Optional[VisualizationConfig] = None,\n) -&gt; None\n</code></pre> <p>\u5e94\u7528 Nature/Science \u671f\u520a\u98ce\u683c\u5230\u5168\u5c40 matplotlib \u8bbe\u7f6e</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>config</code> <code>Optional[VisualizationConfig]</code> <p>\u53ef\u89c6\u5316\u914d\u7f6e\uff0c\u9ed8\u8ba4\u4f7f\u7528 Nature \u98ce\u683c</p> <code>None</code> <p>\u793a\u4f8b\uff1a</p> <pre><code>&gt;&gt;&gt; from DASMatrix.visualization.styles import apply_nature_style\n&gt;&gt;&gt; apply_nature_style()\n&gt;&gt;&gt; # \u4e4b\u540e\u6240\u6709\u56fe\u8868\u90fd\u5c06\u4f7f\u7528 Nature \u98ce\u683c\n</code></pre> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/styles.py</code> <pre><code>def apply_nature_style(config: Optional[VisualizationConfig] = None) -&gt; None:\n    \"\"\"\u5e94\u7528 Nature/Science \u671f\u520a\u98ce\u683c\u5230\u5168\u5c40 matplotlib \u8bbe\u7f6e\n\n    Args:\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\uff0c\u9ed8\u8ba4\u4f7f\u7528 Nature \u98ce\u683c\n\n    Examples:\n        &gt;&gt;&gt; from DASMatrix.visualization.styles import apply_nature_style\n        &gt;&gt;&gt; apply_nature_style()\n        &gt;&gt;&gt; # \u4e4b\u540e\u6240\u6709\u56fe\u8868\u90fd\u5c06\u4f7f\u7528 Nature \u98ce\u683c\n    \"\"\"\n    if config is None:\n        config = VisualizationConfig()\n\n    # \u91cd\u7f6e\u4e3a\u9ed8\u8ba4\u6837\u5f0f\n    plt.style.use(\"default\")\n\n    # \u5e94\u7528\u914d\u7f6e\n    rcparams = config.get_rcparams()\n\n    # \u5904\u7406 prop_cycle\uff08\u9700\u8981\u7279\u6b8a\u5904\u7406\uff09\n    rcparams.pop(\"axes.prop_cycle\", None)\n    plt.rcParams.update(rcparams)\n\n    # \u8bbe\u7f6e\u989c\u8272\u5faa\u73af\n    plt.rcParams[\"axes.prop_cycle\"] = plt.cycler(\"color\", config.colors.primary)\n</code></pre>"},{"location":"reference/DASMatrix/visualization/styles/#DASMatrix.visualization.styles.nature_style","title":"nature_style","text":"<pre><code>nature_style(config: Optional[VisualizationConfig] = None)\n</code></pre> <p>Nature \u98ce\u683c\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>config</code> <code>Optional[VisualizationConfig]</code> <p>\u53ef\u89c6\u5316\u914d\u7f6e</p> <code>None</code> <p>\u793a\u4f8b\uff1a</p> <pre><code>&gt;&gt;&gt; with nature_style():\n...     fig, ax = plt.subplots()\n...     ax.plot(x, y)\n</code></pre> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/styles.py</code> <pre><code>@contextlib.contextmanager\ndef nature_style(config: Optional[VisualizationConfig] = None):\n    \"\"\"Nature \u98ce\u683c\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\n\n    Args:\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\n\n    Examples:\n        &gt;&gt;&gt; with nature_style():\n        ...     fig, ax = plt.subplots()\n        ...     ax.plot(x, y)\n    \"\"\"\n    if config is None:\n        config = VisualizationConfig()\n\n    # \u4fdd\u5b58\u5f53\u524d\u6837\u5f0f\n    old_rcparams = plt.rcParams.copy()\n\n    try:\n        apply_nature_style(config)\n        yield\n    finally:\n        # \u6062\u590d\u539f\u6837\u5f0f\n        plt.rcParams.update(old_rcparams)\n</code></pre>"},{"location":"reference/DASMatrix/visualization/styles/#DASMatrix.visualization.styles.create_figure","title":"create_figure","text":"<pre><code>create_figure(\n    size: Union[\n        FigureSize, Tuple[float, float], str\n    ] = FigureSize.SINGLE_COLUMN,\n    nrows: int = 1,\n    ncols: int = 1,\n    config: Optional[VisualizationConfig] = None,\n    **kwargs: Any,\n) -&gt; Tuple[plt.Figure, np.ndarray]\n</code></pre> <p>\u521b\u5efa\u671f\u520a\u7ea7\u522b\u7684\u56fe\u5f62</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>size</code> <code>Union[FigureSize, Tuple[float, float], str]</code> <p>\u56fe\u5f62\u5c3a\u5bf8\uff0c\u53ef\u4ee5\u662f FigureSize \u679a\u4e3e\u3001\u5143\u7ec4\u6216\u5b57\u7b26\u4e32</p> <code>SINGLE_COLUMN</code> <code>nrows</code> <code>int</code> <p>\u5b50\u56fe\u884c\u6570</p> <code>1</code> <code>ncols</code> <code>int</code> <p>\u5b50\u56fe\u5217\u6570</p> <code>1</code> <code>config</code> <code>Optional[VisualizationConfig]</code> <p>\u53ef\u89c6\u5316\u914d\u7f6e</p> <code>None</code> <code>**kwargs</code> <code>Any</code> <p>\u4f20\u9012\u7ed9 plt.subplots \u7684\u5176\u4ed6\u53c2\u6570</p> <code>{}</code> <p>\u8fd4\u56de\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 <code>tuple</code> <code>Tuple[Figure, ndarray]</code> <p>(Figure, Axes)</p> <p>\u793a\u4f8b\uff1a</p> <pre><code>&gt;&gt;&gt; fig, ax = create_figure()\n&gt;&gt;&gt; fig, axes = create_figure(size=\"double\", nrows=2, ncols=2)\n</code></pre> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/styles.py</code> <pre><code>def create_figure(\n    size: Union[FigureSize, Tuple[float, float], str] = FigureSize.SINGLE_COLUMN,\n    nrows: int = 1,\n    ncols: int = 1,\n    config: Optional[VisualizationConfig] = None,\n    **kwargs: Any,\n) -&gt; Tuple[plt.Figure, np.ndarray]:\n    \"\"\"\u521b\u5efa\u671f\u520a\u7ea7\u522b\u7684\u56fe\u5f62\n\n    Args:\n        size: \u56fe\u5f62\u5c3a\u5bf8\uff0c\u53ef\u4ee5\u662f FigureSize \u679a\u4e3e\u3001\u5143\u7ec4\u6216\u5b57\u7b26\u4e32\n        nrows: \u5b50\u56fe\u884c\u6570\n        ncols: \u5b50\u56fe\u5217\u6570\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\n        **kwargs: \u4f20\u9012\u7ed9 plt.subplots \u7684\u5176\u4ed6\u53c2\u6570\n\n    Returns:\n        tuple: (Figure, Axes)\n\n    Examples:\n        &gt;&gt;&gt; fig, ax = create_figure()\n        &gt;&gt;&gt; fig, axes = create_figure(size=\"double\", nrows=2, ncols=2)\n    \"\"\"\n    if config is None:\n        config = VisualizationConfig()\n\n    apply_nature_style(config)\n\n    # \u89e3\u6790\u5c3a\u5bf8\n    if isinstance(size, FigureSize):\n        figsize = size.value\n    elif isinstance(size, str):\n        size_map = {\n            \"single\": FigureSize.SINGLE_COLUMN.value,\n            \"1.5\": FigureSize.ONE_HALF_COLUMN.value,\n            \"double\": FigureSize.DOUBLE_COLUMN.value,\n            \"full\": FigureSize.FULL_PAGE.value,\n            \"square\": FigureSize.SQUARE.value,\n            \"wide\": FigureSize.WIDE.value,\n        }\n        figsize = size_map.get(size.lower(), FigureSize.SINGLE_COLUMN.value)\n    else:\n        figsize = size\n\n    # \u8c03\u6574\u591a\u5b50\u56fe\u7684\u9ad8\u5ea6\n    if nrows &gt; 1:\n        figsize = (figsize[0], figsize[1] * nrows * 0.8)\n    if ncols &gt; 1:\n        figsize = (figsize[0] * ncols * 0.6, figsize[1])\n\n    fig, axes = plt.subplots(\n        nrows=nrows, ncols=ncols, figsize=figsize, constrained_layout=True, **kwargs\n    )\n\n    # \u786e\u4fdd axes \u59cb\u7ec8\u662f\u6570\u7ec4\n    if nrows == 1 and ncols == 1:\n        axes = np.array([axes])\n\n    return fig, axes\n</code></pre>"},{"location":"reference/DASMatrix/visualization/styles/#DASMatrix.visualization.styles.setup_axis","title":"setup_axis","text":"<pre><code>setup_axis(\n    ax: Axes,\n    xlabel: Optional[str] = None,\n    ylabel: Optional[str] = None,\n    title: Optional[str] = None,\n    xlim: Optional[Tuple[float, float]] = None,\n    ylim: Optional[Tuple[float, float]] = None,\n    config: Optional[VisualizationConfig] = None,\n) -&gt; plt.Axes\n</code></pre> <p>\u914d\u7f6e\u5750\u6807\u8f74\u4e3a\u671f\u520a\u7ea7\u522b\u6837\u5f0f</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>ax</code> <code>Axes</code> <p>matplotlib Axes \u5bf9\u8c61</p> \u5fc5\u9700 <code>xlabel</code> <code>Optional[str]</code> <p>X\u8f74\u6807\u7b7e</p> <code>None</code> <code>ylabel</code> <code>Optional[str]</code> <p>Y\u8f74\u6807\u7b7e</p> <code>None</code> <code>title</code> <code>Optional[str]</code> <p>\u6807\u9898</p> <code>None</code> <code>xlim</code> <code>Optional[Tuple[float, float]]</code> <p>X\u8f74\u8303\u56f4</p> <code>None</code> <code>ylim</code> <code>Optional[Tuple[float, float]]</code> <p>Y\u8f74\u8303\u56f4</p> <code>None</code> <code>config</code> <code>Optional[VisualizationConfig]</code> <p>\u53ef\u89c6\u5316\u914d\u7f6e</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Axes</code> <p>\u914d\u7f6e\u540e\u7684 Axes \u5bf9\u8c61</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/styles.py</code> <pre><code>def setup_axis(\n    ax: plt.Axes,\n    xlabel: Optional[str] = None,\n    ylabel: Optional[str] = None,\n    title: Optional[str] = None,\n    xlim: Optional[Tuple[float, float]] = None,\n    ylim: Optional[Tuple[float, float]] = None,\n    config: Optional[VisualizationConfig] = None,\n) -&gt; plt.Axes:\n    \"\"\"\u914d\u7f6e\u5750\u6807\u8f74\u4e3a\u671f\u520a\u7ea7\u522b\u6837\u5f0f\n\n    Args:\n        ax: matplotlib Axes \u5bf9\u8c61\n        xlabel: X\u8f74\u6807\u7b7e\n        ylabel: Y\u8f74\u6807\u7b7e\n        title: \u6807\u9898\n        xlim: X\u8f74\u8303\u56f4\n        ylim: Y\u8f74\u8303\u56f4\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\n\n    Returns:\n        \u914d\u7f6e\u540e\u7684 Axes \u5bf9\u8c61\n    \"\"\"\n    if config is None:\n        config = VisualizationConfig()\n\n    # \u786e\u4fdd\u6240\u6709\u8fb9\u6846\u53ef\u89c1\u4e14\u6837\u5f0f\u4e00\u81f4\n    for spine in [\"top\", \"right\", \"bottom\", \"left\"]:\n        ax.spines[spine].set_visible(True)\n        ax.spines[spine].set_linewidth(config.spine_linewidth)\n        ax.spines[spine].set_color(config.colors.spine)\n\n    # \u8bbe\u7f6e\u523b\u5ea6\u65b9\u5411\u548c\u6837\u5f0f\n    ax.tick_params(\n        which=\"both\",\n        direction=config.tick_direction,\n        top=True,\n        right=True,\n        width=config.tick_major_width,\n        length=config.tick_major_size,\n    )\n\n    if config.show_minor_ticks:\n        ax.minorticks_on()\n        ax.tick_params(\n            which=\"minor\",\n            direction=config.tick_direction,\n            top=True,\n            right=True,\n            width=config.tick_minor_width,\n            length=config.tick_minor_size,\n        )\n\n    # \u8bbe\u7f6e\u6807\u7b7e\n    if xlabel:\n        ax.set_xlabel(xlabel, fontsize=config.typography.label)\n    if ylabel:\n        ax.set_ylabel(ylabel, fontsize=config.typography.label)\n    if title:\n        ax.set_title(title, fontsize=config.typography.title, fontweight=\"bold\")\n\n    # \u8bbe\u7f6e\u8303\u56f4\n    if xlim:\n        ax.set_xlim(xlim)\n    if ylim:\n        ax.set_ylim(ylim)\n\n    return ax\n</code></pre>"},{"location":"reference/DASMatrix/visualization/styles/#DASMatrix.visualization.styles.add_colorbar","title":"add_colorbar","text":"<pre><code>add_colorbar(\n    fig: Figure,\n    mappable: ScalarMappable,\n    ax: Axes,\n    label: Optional[str] = None,\n    config: Optional[VisualizationConfig] = None,\n    **kwargs: Any,\n) -&gt; plt.colorbar.Colorbar\n</code></pre> <p>\u6dfb\u52a0\u4e13\u4e1a\u683c\u5f0f\u7684\u989c\u8272\u6761</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>fig</code> <code>Figure</code> <p>Figure \u5bf9\u8c61</p> \u5fc5\u9700 <code>mappable</code> <code>ScalarMappable</code> <p>\u53ef\u6620\u5c04\u5bf9\u8c61\uff08\u5982 imshow \u8fd4\u56de\u503c\uff09</p> \u5fc5\u9700 <code>ax</code> <code>Axes</code> <p>\u5173\u8054\u7684 Axes</p> \u5fc5\u9700 <code>label</code> <code>Optional[str]</code> <p>\u989c\u8272\u6761\u6807\u7b7e</p> <code>None</code> <code>config</code> <code>Optional[VisualizationConfig]</code> <p>\u53ef\u89c6\u5316\u914d\u7f6e</p> <code>None</code> <code>**kwargs</code> <code>Any</code> <p>\u4f20\u9012\u7ed9 colorbar \u7684\u5176\u4ed6\u53c2\u6570</p> <code>{}</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>Colorbar</code> <p>matplotlib.colorbar.Colorbar: Colorbar \u5bf9\u8c61</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/styles.py</code> <pre><code>def add_colorbar(\n    fig: plt.Figure,\n    mappable: plt.cm.ScalarMappable,\n    ax: plt.Axes,\n    label: Optional[str] = None,\n    config: Optional[VisualizationConfig] = None,\n    **kwargs: Any,\n) -&gt; plt.colorbar.Colorbar:\n    \"\"\"\u6dfb\u52a0\u4e13\u4e1a\u683c\u5f0f\u7684\u989c\u8272\u6761\n\n    Args:\n        fig: Figure \u5bf9\u8c61\n        mappable: \u53ef\u6620\u5c04\u5bf9\u8c61\uff08\u5982 imshow \u8fd4\u56de\u503c\uff09\n        ax: \u5173\u8054\u7684 Axes\n        label: \u989c\u8272\u6761\u6807\u7b7e\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\n        **kwargs: \u4f20\u9012\u7ed9 colorbar \u7684\u5176\u4ed6\u53c2\u6570\n\n    Returns:\n        matplotlib.colorbar.Colorbar: Colorbar \u5bf9\u8c61\n    \"\"\"\n    if config is None:\n        config = VisualizationConfig()\n\n    cbar = fig.colorbar(\n        mappable,\n        ax=ax,\n        pad=config.colorbar_pad,\n        fraction=config.colorbar_width * 2,\n        **kwargs,\n    )\n\n    if label:\n        cbar.set_label(label, fontsize=config.typography.label)\n\n    cbar.ax.tick_params(\n        direction=config.tick_direction,\n        width=config.tick_major_width,\n        length=config.tick_major_size,\n    )\n\n    return cbar\n</code></pre>"},{"location":"reference/DASMatrix/visualization/styles/#DASMatrix.visualization.styles.save_figure","title":"save_figure","text":"<pre><code>save_figure(\n    fig: Figure,\n    filename: str,\n    formats: Tuple[str, ...] = (\"pdf\", \"png\"),\n    config: Optional[VisualizationConfig] = None,\n    **kwargs: Any,\n) -&gt; None\n</code></pre> <p>\u4fdd\u5b58\u56fe\u5f62\u4e3a\u591a\u79cd\u683c\u5f0f</p> <p>Nature \u8981\u6c42 PDF/EPS \u77e2\u91cf\u683c\u5f0f\uff0c\u540c\u65f6\u751f\u6210 PNG \u7528\u4e8e\u9884\u89c8\u3002</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>fig</code> <code>Figure</code> <p>Figure \u5bf9\u8c61</p> \u5fc5\u9700 <code>filename</code> <code>str</code> <p>\u6587\u4ef6\u540d\uff08\u4e0d\u542b\u6269\u5c55\u540d\uff09</p> \u5fc5\u9700 <code>formats</code> <code>Tuple[str, ...]</code> <p>\u8f93\u51fa\u683c\u5f0f\u5217\u8868</p> <code>('pdf', 'png')</code> <code>config</code> <code>Optional[VisualizationConfig]</code> <p>\u53ef\u89c6\u5316\u914d\u7f6e</p> <code>None</code> <code>**kwargs</code> <code>Any</code> <p>\u4f20\u9012\u7ed9 savefig \u7684\u5176\u4ed6\u53c2\u6570</p> <code>{}</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/styles.py</code> <pre><code>def save_figure(\n    fig: plt.Figure,\n    filename: str,\n    formats: Tuple[str, ...] = (\"pdf\", \"png\"),\n    config: Optional[VisualizationConfig] = None,\n    **kwargs: Any,\n) -&gt; None:\n    \"\"\"\u4fdd\u5b58\u56fe\u5f62\u4e3a\u591a\u79cd\u683c\u5f0f\n\n    Nature \u8981\u6c42 PDF/EPS \u77e2\u91cf\u683c\u5f0f\uff0c\u540c\u65f6\u751f\u6210 PNG \u7528\u4e8e\u9884\u89c8\u3002\n\n    Args:\n        fig: Figure \u5bf9\u8c61\n        filename: \u6587\u4ef6\u540d\uff08\u4e0d\u542b\u6269\u5c55\u540d\uff09\n        formats: \u8f93\u51fa\u683c\u5f0f\u5217\u8868\n        config: \u53ef\u89c6\u5316\u914d\u7f6e\n        **kwargs: \u4f20\u9012\u7ed9 savefig \u7684\u5176\u4ed6\u53c2\u6570\n    \"\"\"\n    from pathlib import Path\n\n    if config is None:\n        config = VisualizationConfig()\n\n    filepath = Path(filename)\n    filepath.parent.mkdir(parents=True, exist_ok=True)\n\n    for fmt in formats:\n        dpi = config.dpi if fmt != \"pdf\" else 300  # PDF \u4f7f\u7528\u77e2\u91cf\uff0cDPI \u4e3b\u8981\u5f71\u54cd\u6805\u683c\u5143\u7d20\n        fig.savefig(\n            filepath.with_suffix(f\".{fmt}\"),\n            format=fmt,\n            dpi=dpi,\n            bbox_inches=\"tight\",\n            pad_inches=0.02,\n            facecolor=\"white\",\n            edgecolor=\"none\",\n            **kwargs,\n        )\n</code></pre>"},{"location":"reference/DASMatrix/visualization/styles/#DASMatrix.visualization.styles.get_colors","title":"get_colors","text":"<pre><code>get_colors(\n    n: int, palette: Optional[ColorPalette] = None\n) -&gt; list\n</code></pre> <p>\u83b7\u53d6\u6307\u5b9a\u6570\u91cf\u7684\u989c\u8272</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>n</code> <code>int</code> <p>\u9700\u8981\u7684\u989c\u8272\u6570\u91cf</p> \u5fc5\u9700 <code>palette</code> <code>Optional[ColorPalette]</code> <p>\u914d\u8272\u65b9\u6848</p> <code>None</code> <p>\u8fd4\u56de\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 <code>list</code> <p>\u989c\u8272\u5217\u8868</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/styles.py</code> <pre><code>def get_colors(n: int, palette: Optional[ColorPalette] = None) -&gt; list:\n    \"\"\"\u83b7\u53d6\u6307\u5b9a\u6570\u91cf\u7684\u989c\u8272\n\n    Args:\n        n: \u9700\u8981\u7684\u989c\u8272\u6570\u91cf\n        palette: \u914d\u8272\u65b9\u6848\n\n    Returns:\n        \u989c\u8272\u5217\u8868\n    \"\"\"\n    if palette is None:\n        palette = ColorPalette()\n\n    if n &lt;= len(palette.primary):\n        return palette.primary[:n]\n    else:\n        # \u9700\u8981\u66f4\u591a\u989c\u8272\uff0c\u4f7f\u7528 colormap \u63d2\u503c\n        cmap = plt.cm.get_cmap(\"tab20\")\n        return [cmap(i / n) for i in range(n)]\n</code></pre>"},{"location":"reference/DASMatrix/visualization/styles/#DASMatrix.visualization.styles.create_sequential_cmap","title":"create_sequential_cmap","text":"<pre><code>create_sequential_cmap(\n    name: str = \"viridis\",\n) -&gt; colors.Colormap\n</code></pre> <p>\u521b\u5efa\u987a\u5e8f\u8272\u56fe</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/styles.py</code> <pre><code>def create_sequential_cmap(name: str = \"viridis\") -&gt; colors.Colormap:\n    \"\"\"\u521b\u5efa\u987a\u5e8f\u8272\u56fe\"\"\"\n    return plt.cm.get_cmap(name)\n</code></pre>"},{"location":"reference/DASMatrix/visualization/styles/#DASMatrix.visualization.styles.create_diverging_cmap","title":"create_diverging_cmap","text":"<pre><code>create_diverging_cmap(\n    name: str = \"RdBu_r\", center: float = 0\n) -&gt; colors.Colormap\n</code></pre> <p>\u521b\u5efa\u53d1\u6563\u8272\u56fe</p> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/styles.py</code> <pre><code>def create_diverging_cmap(name: str = \"RdBu_r\", center: float = 0) -&gt; colors.Colormap:\n    \"\"\"\u521b\u5efa\u53d1\u6563\u8272\u56fe\"\"\"\n    return plt.cm.get_cmap(name)\n</code></pre>"},{"location":"reference/DASMatrix/visualization/styles/#DASMatrix.visualization.styles.add_panel_label","title":"add_panel_label","text":"<pre><code>add_panel_label(\n    ax: Axes,\n    label: str,\n    loc: str = \"upper left\",\n    fontsize: int = 12,\n    fontweight: str = \"bold\",\n) -&gt; None\n</code></pre> <p>\u6dfb\u52a0\u5b50\u56fe\u6807\u7b7e\uff08\u5982 a, b, c\uff09</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>ax</code> <code>Axes</code> <p>Axes \u5bf9\u8c61</p> \u5fc5\u9700 <code>label</code> <code>str</code> <p>\u6807\u7b7e\u6587\u672c\uff08\u5982 \"a\", \"b\"\uff09</p> \u5fc5\u9700 <code>loc</code> <code>str</code> <p>\u4f4d\u7f6e</p> <code>'upper left'</code> <code>fontsize</code> <code>int</code> <p>\u5b57\u53f7</p> <code>12</code> <code>fontweight</code> <code>str</code> <p>\u5b57\u91cd</p> <code>'bold'</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/styles.py</code> <pre><code>def add_panel_label(\n    ax: plt.Axes,\n    label: str,\n    loc: str = \"upper left\",\n    fontsize: int = 12,\n    fontweight: str = \"bold\",\n) -&gt; None:\n    \"\"\"\u6dfb\u52a0\u5b50\u56fe\u6807\u7b7e\uff08\u5982 a, b, c\uff09\n\n    Args:\n        ax: Axes \u5bf9\u8c61\n        label: \u6807\u7b7e\u6587\u672c\uff08\u5982 \"a\", \"b\"\uff09\n        loc: \u4f4d\u7f6e\n        fontsize: \u5b57\u53f7\n        fontweight: \u5b57\u91cd\n    \"\"\"\n    loc_map = {\n        \"upper left\": (-0.1, 1.1),\n        \"upper right\": (1.05, 1.1),\n        \"lower left\": (-0.1, -0.1),\n        \"lower right\": (1.05, -0.1),\n    }\n\n    x, y = loc_map.get(loc, (-0.1, 1.1))\n\n    ax.text(\n        x,\n        y,\n        label,\n        transform=ax.transAxes,\n        fontsize=fontsize,\n        fontweight=fontweight,\n        va=\"top\",\n        ha=\"left\" if \"left\" in loc else \"right\",\n    )\n</code></pre>"},{"location":"reference/DASMatrix/visualization/styles/#DASMatrix.visualization.styles.add_scalebar","title":"add_scalebar","text":"<pre><code>add_scalebar(\n    ax: Axes,\n    length: float,\n    label: str,\n    loc: str = \"lower right\",\n    color: str = \"black\",\n    height_fraction: float = 0.02,\n) -&gt; None\n</code></pre> <p>\u6dfb\u52a0\u6bd4\u4f8b\u5c3a</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>ax</code> <code>Axes</code> <p>Axes \u5bf9\u8c61</p> \u5fc5\u9700 <code>length</code> <code>float</code> <p>\u6bd4\u4f8b\u5c3a\u957f\u5ea6\uff08\u6570\u636e\u5750\u6807\uff09</p> \u5fc5\u9700 <code>label</code> <code>str</code> <p>\u6807\u7b7e\u6587\u672c</p> \u5fc5\u9700 <code>loc</code> <code>str</code> <p>\u4f4d\u7f6e</p> <code>'lower right'</code> <code>color</code> <code>str</code> <p>\u989c\u8272</p> <code>'black'</code> <code>height_fraction</code> <code>float</code> <p>\u9ad8\u5ea6\u5360\u56fe\u9ad8\u7684\u6bd4\u4f8b</p> <code>0.02</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/styles.py</code> <pre><code>def add_scalebar(\n    ax: plt.Axes,\n    length: float,\n    label: str,\n    loc: str = \"lower right\",\n    color: str = \"black\",\n    height_fraction: float = 0.02,\n) -&gt; None:\n    \"\"\"\u6dfb\u52a0\u6bd4\u4f8b\u5c3a\n\n    Args:\n        ax: Axes \u5bf9\u8c61\n        length: \u6bd4\u4f8b\u5c3a\u957f\u5ea6\uff08\u6570\u636e\u5750\u6807\uff09\n        label: \u6807\u7b7e\u6587\u672c\n        loc: \u4f4d\u7f6e\n        color: \u989c\u8272\n        height_fraction: \u9ad8\u5ea6\u5360\u56fe\u9ad8\u7684\u6bd4\u4f8b\n    \"\"\"\n    import matplotlib.font_manager as fm\n    from mpl_toolkits.axes_grid1.anchored_artists import AnchoredSizeBar\n\n    fontprops = fm.FontProperties(size=7)\n    scalebar = AnchoredSizeBar(\n        ax.transData,\n        length,\n        label,\n        loc=loc,\n        pad=0.5,\n        color=color,\n        frameon=False,\n        size_vertical=ax.get_ylim()[1] * height_fraction,\n        fontproperties=fontprops,\n    )\n    ax.add_artist(scalebar)\n</code></pre>"},{"location":"reference/DASMatrix/visualization/styles/#DASMatrix.visualization.styles.add_significance_bracket","title":"add_significance_bracket","text":"<pre><code>add_significance_bracket(\n    ax: Axes,\n    x1: float,\n    x2: float,\n    y: float,\n    text: str = \"*\",\n    color: str = \"black\",\n    linewidth: float = 1.0,\n) -&gt; None\n</code></pre> <p>\u6dfb\u52a0\u663e\u8457\u6027\u6807\u8bb0\u62ec\u53f7</p> <p>\u53c2\u6570\uff1a</p> \u540d\u79f0 \u7c7b\u578b \u63cf\u8ff0 \u9ed8\u8ba4 <code>ax</code> <code>Axes</code> <p>Axes \u5bf9\u8c61</p> \u5fc5\u9700 <code>x1</code> <code>float</code> <p>\u62ec\u53f7\u8d77\u59cb X \u5750\u6807</p> \u5fc5\u9700 <code>x2</code> <code>float</code> <p>\u62ec\u53f7\u7ec8\u6b62 X \u5750\u6807</p> \u5fc5\u9700 <code>y</code> <code>float</code> <p>\u62ec\u53f7 Y \u5750\u6807</p> \u5fc5\u9700 <code>text</code> <code>str</code> <p>\u663e\u8457\u6027\u6807\u8bb0\uff08, , **\uff09</p> <code>'*'</code> <code>color</code> <code>str</code> <p>\u989c\u8272</p> <code>'black'</code> <code>linewidth</code> <code>float</code> <p>\u7ebf\u5bbd</p> <code>1.0</code> \u6e90\u4ee3\u7801\u4f4d\u4e8e\uff1a <code>DASMatrix/visualization/styles.py</code> <pre><code>def add_significance_bracket(\n    ax: plt.Axes,\n    x1: float,\n    x2: float,\n    y: float,\n    text: str = \"*\",\n    color: str = \"black\",\n    linewidth: float = 1.0,\n) -&gt; None:\n    \"\"\"\u6dfb\u52a0\u663e\u8457\u6027\u6807\u8bb0\u62ec\u53f7\n\n    Args:\n        ax: Axes \u5bf9\u8c61\n        x1: \u62ec\u53f7\u8d77\u59cb X \u5750\u6807\n        x2: \u62ec\u53f7\u7ec8\u6b62 X \u5750\u6807\n        y: \u62ec\u53f7 Y \u5750\u6807\n        text: \u663e\u8457\u6027\u6807\u8bb0\uff08*, **, ***\uff09\n        color: \u989c\u8272\n        linewidth: \u7ebf\u5bbd\n    \"\"\"\n    h = (ax.get_ylim()[1] - ax.get_ylim()[0]) * 0.02\n\n    ax.plot(\n        [x1, x1, x2, x2],\n        [y, y + h, y + h, y],\n        color=color,\n        linewidth=linewidth,\n        clip_on=False,\n    )\n    ax.text(\n        (x1 + x2) / 2, y + h, text, ha=\"center\", va=\"bottom\", fontsize=10, color=color\n    )\n</code></pre>"}]}